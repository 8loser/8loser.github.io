{
    "version": "https://jsonfeed.org/version/1",
    "title": "åˆ¥åœ¨åœåŸæ™‚èµ°æ•£",
    "subtitle": "",
    "icon": "https://8loser.github.io/assets/favicon.ico",
    "description": "æˆ‘åœ¨å…«æ¨“é–’æ™ƒ",
    "home_page_url": "https://8loser.github.io",
    "items": [
        {
            "id": "https://8loser.github.io/2026/02/10/linux-hid-permission/",
            "url": "https://8loser.github.io/2026/02/10/linux-hid-permission/",
            "title": "Linux HID è£ç½®æ¬Šé™å•é¡Œ",
            "date_published": "2026-02-09T17:21:00.000Z",
            "content_html": "<h1 id=\"å•é¡Œæè¿°\"><a class=\"anchor\" href=\"#å•é¡Œæè¿°\">#</a> å•é¡Œæè¿°</h1>\n<p>ErgoKB åœ¨ Chrome é€²è¡Œ Remap æ™‚ï¼Œé¸æ“‡ HID è£ç½®å¾Œå‡ºç¾  <code>Could not open</code>  éŒ¯èª¤è¨Šæ¯ã€‚</p>\n<h1 id=\"ç’°å¢ƒ\"><a class=\"anchor\" href=\"#ç’°å¢ƒ\">#</a> ç’°å¢ƒ</h1>\n<ul>\n<li>OS: EndeavourOS</li>\n<li>éµç›¤: ErgoKB Phoenix v2 åˆ†é›¢å¼äººé«”å·¥å­¸æ©Ÿæ¢°éµç›¤</li>\n</ul>\n<h1 id=\"diagnosis\"><a class=\"anchor\" href=\"#diagnosis\">#</a> Diagnosis</h1>\n<p>æŸ¥çœ‹ HID è£ç½®æ¬Šé™ï¼Œå…¨éƒ¨éƒ½åªæœ‰ root æ‰æœ‰è®€å¯«æ¬Šé™ï¼Œæ‡‰è©²æ˜¯æ¬Šé™å•é¡Œï¼ˆé€™é‚Šçœ‹ä¸å‡ºæ¯å€‹ HID æ˜¯ä»€éº¼è£ç½®ï¼‰</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">ls</span> <span class=\"token parameter variable\">-l</span> /dev/hidraw*</pre></td></tr><tr><td data-num=\"2\"></td><td data-command=\"\"></td><td><pre>crw------- <span class=\"token number\">1</span> root root <span class=\"token number\">243</span>, <span class=\"token number\">0</span>  <span class=\"token number\">2</span>æœˆ  <span class=\"token number\">9</span> <span class=\"token number\">12</span>:50 /dev/hidraw0</pre></td></tr><tr><td data-num=\"3\"></td><td data-command=\"\"></td><td><pre>crw------- <span class=\"token number\">1</span> root root <span class=\"token number\">243</span>, <span class=\"token number\">1</span>  <span class=\"token number\">2</span>æœˆ  <span class=\"token number\">9</span> <span class=\"token number\">12</span>:50 /dev/hidraw1</pre></td></tr><tr><td data-num=\"4\"></td><td data-command=\"\"></td><td><pre>crw------- <span class=\"token number\">1</span> root root <span class=\"token number\">243</span>, <span class=\"token number\">2</span>  <span class=\"token number\">2</span>æœˆ  <span class=\"token number\">9</span> <span class=\"token number\">12</span>:50 /dev/hidraw2</pre></td></tr><tr><td data-num=\"5\"></td><td data-command=\"\"></td><td><pre>crw------- <span class=\"token number\">1</span> root root <span class=\"token number\">243</span>, <span class=\"token number\">3</span>  <span class=\"token number\">2</span>æœˆ  <span class=\"token number\">9</span> <span class=\"token number\">12</span>:50 /dev/hidraw3</pre></td></tr></table></figure><h1 id=\"solution\"><a class=\"anchor\" href=\"#solution\">#</a> Solution</h1>\n<p>æŸ¥çœ‹è£ç½® VID, PID, å¾—çŸ¥ VID/PID ç‚º  <code>1209:2304</code></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[root@localhost] $\"></td><td><pre>lsusb</pre></td></tr><tr><td data-num=\"2\"></td><td data-command=\"\"></td><td><pre>Bus 001 Device 001: ID 1d6b:0002 Linux Foundation <span class=\"token number\">2.0</span> root hub</pre></td></tr><tr><td data-num=\"3\"></td><td data-command=\"\"></td><td><pre>Bus 001 Device 003: ID 046d:c52b Logitech, Inc. Unifying Receiver</pre></td></tr><tr><td data-num=\"4\"></td><td data-command=\"\"></td><td><pre>Bus 001 Device 004: ID <span class=\"token number\">8087</span>:0029 Intel Corp. AX200 Bluetooth</pre></td></tr><tr class=\"marked\"><td data-num=\"5\"></td><td data-command=\"\"></td><td><pre>Bus 001 Device 007: ID <span class=\"token number\">1209</span>:2304 Generic Phoenix-v2</pre></td></tr><tr><td data-num=\"6\"></td><td data-command=\"\"></td><td><pre>Bus 002 Device 001: ID 1d6b:0003 Linux Foundation <span class=\"token number\">3.0</span> root hub</pre></td></tr><tr><td data-num=\"7\"></td><td data-command=\"\"></td><td><pre>Bus 003 Device 001: ID 1d6b:0002 Linux Foundation <span class=\"token number\">2.0</span> root hub</pre></td></tr><tr><td data-num=\"8\"></td><td data-command=\"\"></td><td><pre>Bus 004 Device 001: ID 1d6b:0003 Linux Foundation <span class=\"token number\">3.0</span> root hub</pre></td></tr></table></figure><p>å»ºç«‹è£ç½®å°ˆç”¨ rule æª”æ¡ˆ  <code>/etc/udev/rules.d/99-ergokb.rules</code></p>\n<p>å¯«å…¥è¨­å®š</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token assign-left variable\">KERNEL</span><span class=\"token operator\">==</span><span class=\"token string\">\"hidraw*\"</span>, <span class=\"token assign-left variable\">SUBSYSTEM</span><span class=\"token operator\">==</span><span class=\"token string\">\"hidraw\"</span>, <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  ATTRS<span class=\"token punctuation\">&#123;</span>idVendor<span class=\"token punctuation\">&#125;</span><span class=\"token operator\">==</span><span class=\"token string\">\"1209\"</span>, ATTRS<span class=\"token punctuation\">&#123;</span>idProduct<span class=\"token punctuation\">&#125;</span><span class=\"token operator\">==</span><span class=\"token string\">\"2304\"</span>, <span class=\"token assign-left variable\">MODE</span><span class=\"token operator\">=</span><span class=\"token string\">\"0666\"</span></pre></td></tr></table></figure><p><strong>èªªæ˜ï¼š</strong></p>\n<ul>\n<li>VID/PID ç‚ºå‰›å‰›æŸ¥è©¢åˆ°çš„  <code>1209:2304</code></li>\n<li><code>MODE=&quot;0666&quot;</code>  è¨­å®šè£ç½®æ¬Šé™ç‚º  <code>rw-rw-rw-</code> ï¼Œå…è¨±æ‰€æœ‰ä½¿ç”¨è€…è®€å¯«</li>\n<li>åŸæœ¬è£ç½®æ¬Šé™æ˜¯  <code>crw------- (600)</code> ï¼Œåªæœ‰ root å¯ä»¥å­˜å–</li>\n<li>æ”¹ç‚º  <code>0666</code>  å¾Œï¼Œä¸€èˆ¬ä½¿ç”¨è€…ï¼ˆåŒ…å« Chromeï¼‰ä¹Ÿèƒ½å­˜å– HID è£ç½®</li>\n</ul>\n<p>é‡æ–°è¼‰å…¥è¨­å®š</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> udevadm control --reload-rules  <span class=\"token comment\"># é‡æ–°è¼‰å…¥ udev è¦å‰‡æª”æ¡ˆ</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">sudo</span> udevadm trigger                  <span class=\"token comment\"># è§¸ç™¼äº‹ä»¶ï¼Œå°‡æ–°è¦å‰‡æ‡‰ç”¨åˆ°ç¾æœ‰è¨­å‚™</span></pre></td></tr></table></figure><ul>\n<li><code>udevadm control --reload-rules</code> ï¼šé‡æ–°è®€å–  <code>/etc/udev/rules.d/</code>  ç›®éŒ„ä¸‹çš„æ‰€æœ‰è¦å‰‡æª”æ¡ˆ</li>\n<li><code>udevadm trigger</code> ï¼šè§¸ç™¼ udev äº‹ä»¶ï¼Œè®“ç³»çµ±é‡æ–°æƒææ‰€æœ‰è¨­å‚™ä¸¦å¥—ç”¨æ–°è¦å‰‡</li>\n</ul>\n<p>åŸ·è¡Œå®Œå¾Œ <span class=\"spoiler\" title=\"ä½ çŸ¥é“å¾—å¤ªå¤šäº†\">å¦‚æœé‚„æ˜¯ä¸è¡Œæˆ‘å‹¸ä½ éµç›¤æ‹”æ‰é‡æ’å•¦</span>ï¼Œé‡æ–°é–‹å•Ÿ remap é é¢å³å¯æ­£å¸¸ä½¿ç”¨ã€‚ ğŸ‰</p>\n<p>å°äº†ï¼Œå¦‚æœåœ¨ Linux OS, é€™ç¯‡å°±æœ‰å¯èƒ½é‡åˆ°é€™å€‹å•é¡Œï¼›<a href=\"/2025/06/23/node-usb-relay/\">Node.JS æ§åˆ¶ USB ç¹¼é›»å™¨</a></p>\n",
            "tags": [
                "Trouble",
                "Linux",
                "HID",
                "udev"
            ]
        },
        {
            "id": "https://8loser.github.io/2026/02/07/rag-tutorial/",
            "url": "https://8loser.github.io/2026/02/07/rag-tutorial/",
            "title": "RAG æ•™å­¸",
            "date_published": "2026-02-07T02:00:00.000Z",
            "content_html": "<h1 id=\"æ¶æ§‹\"><a class=\"anchor\" href=\"#æ¶æ§‹\">#</a> æ¶æ§‹</h1>\n<p>RAGï¼ˆRetrieval-Augmented Generation; æª¢ç´¢å¢å¼·ç”Ÿæˆï¼‰</p>\n<ul>\n<li>\n<p>R - Retrieval (æª¢ç´¢)<br />\n è³‡æ–™ç«¯ï¼š åŸå§‹æ–‡ä»¶ç¶“é Embedding Model è½‰ç‚ºå‘é‡ï¼Œå­˜å…¥ Vector DBã€‚<br />\næŸ¥è©¢ç«¯ï¼š ä½¿ç”¨è€…å•é¡ŒåŒæ¨£è½‰ç‚ºå‘é‡ï¼Œå»è³‡æ–™åº«é€²è¡Œç›¸ä¼¼åº¦æª¢ç´¢ï¼ˆSimilarity Searchï¼‰ã€‚</p>\n</li>\n<li>\n<p>A - Augmentation (å¢å¼·)<br />\n çµ„åˆï¼š å°‡æª¢ç´¢å‡ºä¾†çš„ã€Œå¤–éƒ¨çŸ¥è­˜ï¼ˆContextï¼‰ã€èˆ‡ã€ŒåŸå§‹å•é¡Œï¼ˆQueryï¼‰ã€æ”¾å…¥ä¸€å€‹ Prompt Template ä¸­ã€‚<br />\nä»»å‹™ï¼š é€™å€‹å‹•ä½œæ˜¯ç‚ºäº†è®“ LLM æ“æœ‰å®ƒåŸæœ¬è¨“ç·´æ•¸æ“šä¸­æ²’æœ‰çš„ç‰¹å®šè³‡è¨Šã€‚</p>\n</li>\n<li>\n<p>G - Generation (ç”Ÿæˆ)<br />\n è¼¸å‡ºï¼š å°‡åŠ å¼·éçš„ Prompt ä¸Ÿçµ¦ LLMã€‚<br />\nå›è¦†ï¼š LLM æ ¹æ“šçµ¦å®šçš„åƒè€ƒè³‡æ–™ç”¢å‡ºç²¾æº–çš„ç­”æ¡ˆã€‚</p>\n</li>\n</ul>\n<p>æˆ‘ç†è§£çš„æ¶æ§‹åœ–<img loading=\"lazy\" src=\"rag-diagram.png\" alt=\"RAG diagram\" /></p>\n<details class=\"danger\"><summary>Gemini ç•«çš„å•¥ç©æ„å…’</summary><div>\n<p><img loading=\"lazy\" src=\"rag-diagram-gemini.png\" alt=\"RAG diagram - Gemini\" /></p>\n</div></details>\n<h1 id=\"éœ€æ±‚\"><a class=\"anchor\" href=\"#éœ€æ±‚\">#</a> éœ€æ±‚</h1>\n<ul>\n<li>embed modelï¼šå°‡è²éŸ³ã€åœ–ç‰‡ã€å½±ç‰‡ã€æ–‡å­—ç­‰è½‰æˆå‘é‡æ•¸å€¼ä½¿ç”¨</li>\n<li>vector dbï¼šå„²å­˜å‘é‡æ•¸æ“šåŠå°æ‡‰å…§å®¹</li>\n<li>LLMï¼šç”Ÿæˆå¼ AI</li>\n</ul>\n<h1 id=\"embedding\"><a class=\"anchor\" href=\"#embedding\">#</a> Embedding</h1>\n<p>ä½¿ç”¨ Sentence-Transformers è¼‰å…¥ embed modelï¼Œå°‡æ–‡å­—è½‰æˆé«˜ç¶­åº¦å‘é‡ç‰¹å¾µã€‚</p>\n<details class=\"info\"><summary>å®‰è£ä¾è³´å¥—ä»¶</summary><div>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>pip <span class=\"token function\">install</span> sentence-transformers</pre></td></tr></table></figure></div></details>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>Embedding</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># åŠ ä¸Š huggingface çš„é¡åƒç«™é»ç’°å¢ƒè®Šæ•¸ï¼Œé¿å…ä¸‹è¼‰æ¨¡å‹å¤ªæ…¢</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> os</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>os<span class=\"token punctuation\">.</span>environ<span class=\"token punctuation\">[</span><span class=\"token string\">\"HF_ENDPOINT\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"https://hf-mirror.com\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">from</span> sentence_transformers <span class=\"token keyword\">import</span> SentenceTransformer</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># è¼‰å…¥æ¨¡å‹</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>model <span class=\"token operator\">=</span> SentenceTransformer<span class=\"token punctuation\">(</span><span class=\"token string\">'all-MiniLM-L6-v2'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\"># æº–å‚™æ–‡å­—</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>sentences <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"é€™æ˜¯ä¸€æ®µæ¸¬è©¦æ–‡å­—\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"EndeavourOS é–‹ç™¼ç’°å¢ƒ\"</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\"># å–å¾— Feature Vector</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>embeddings <span class=\"token operator\">=</span> model<span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span>sentences<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\"># æŸ¥çœ‹ Shape [å¥å­æ•¸é‡ï¼Œæ¯å€‹å¥å­çš„ç¶­åº¦]</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\"># è¼¸å‡ºæœƒæ˜¯ (2, 384)ï¼Œä»£è¡¨ 2 å€‹å¥å­ï¼Œæ¯å€‹å¥å­ 384 ç¶­ï¼Œæ˜¯ all-MiniLM-L6-v2 æ¨¡å‹çš„ç‰¹å¾µç¶­åº¦ã€‚</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"å‘é‡å½¢ç‹€ (embeddings.shape): </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>embeddings<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\"># æŸ¥çœ‹å…·é«”æ•¸å€¼ (åªå°å‡ºç¬¬ä¸€å¥çš„å‰ 5 å€‹ç‰¹å¾µå€¼ä½œç‚ºç¯„ä¾‹)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"ç¬¬ä¸€å¥çš„å‰ 5 å€‹ç‰¹å¾µå€¼: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>embeddings<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token format-spec\">5]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token comment\"># åŸ·è¡Œçµæœ</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token comment\"># å‘é‡å½¢ç‹€ (embeddings.shape): (2, 384)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token comment\"># ç¬¬ä¸€å¥çš„å‰ 5 å€‹ç‰¹å¾µå€¼: [0.03097137 0.09432378 0.04806018 0.02745436 0.02937624]</span></pre></td></tr></table></figure><div class=\"note info\">\n<ul>\n<li>é™¤äº† Sentence-Transformers ä¹Ÿå¯ä»¥ç”¨ Ollama è¼‰å…¥ embed modelï¼Œå‘¼å« Ollama API å–å¾—å‘é‡å€¼</li>\n<li>é¸å°æ¨¡å‹å¾ˆé‡è¦ï¼Œæ”¹æˆ  <code>paraphrase-multilingual-MiniLM-L12-v2</code>  æ¨¡å‹ï¼Œå°ä¸­æ–‡ç†è§£ç¨‹åº¦æ¯”è¼ƒé«˜</li>\n<li>è²éŸ³ã€åœ–ç‰‡ã€å½±ç‰‡ã€æ–‡å­—è½‰ç‚ºé«˜ç¶­åº¦å‘é‡ç‰¹å¾µï¼Œé€™å€‹éç¨‹å«  <code>embedding</code></li>\n</ul>\n</div>\n<h1 id=\"vector-db\"><a class=\"anchor\" href=\"#vector-db\">#</a> Vector DB</h1>\n<p>å°‡å‘é‡èˆ‡å…§å®¹å­˜å…¥ vector dbï¼Œå¾ŒçºŒå¯ä»¥æœå°‹è·Ÿå•é¡Œç›¸ä¼¼åº¦é«˜çš„å…§å®¹ï¼Œé€™è£¡é¸ç”¨ Qdrant</p>\n<details class=\"info\"><summary>å®‰è£ä¾è³´å¥—ä»¶</summary><div>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>pip <span class=\"token function\">install</span> sentence-transformers qdrant-client</pre></td></tr></table></figure></div></details>\n<details class=\"info\"><summary>å¯ä»¥ç”¨ docker æˆ– podman å•Ÿå‹• Qdrant</summary><div>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>å•Ÿå‹• Qdrant container</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">podman</span> run <span class=\"token parameter variable\">-p</span> <span class=\"token number\">6333</span>:6333 <span class=\"token parameter variable\">-p</span> <span class=\"token number\">6334</span>:6334 <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token parameter variable\">-v</span> <span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token builtin class-name\">pwd</span><span class=\"token variable\">)</span></span>/qdrant_storage:/qdrant/storage:z <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    docker.io/qdrant/qdrant</pre></td></tr></table></figure></div></details>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>Vector DB</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> os</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>os<span class=\"token punctuation\">.</span>environ<span class=\"token punctuation\">[</span><span class=\"token string\">\"HF_ENDPOINT\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"https://hf-mirror.com\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">from</span> sentence_transformers <span class=\"token keyword\">import</span> SentenceTransformer</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">from</span> qdrant_client <span class=\"token keyword\">import</span> QdrantClient</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">from</span> qdrant_client<span class=\"token punctuation\">.</span>models <span class=\"token keyword\">import</span> Distance<span class=\"token punctuation\">,</span> VectorParams<span class=\"token punctuation\">,</span> PointStruct</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># è¼‰å…¥ Embed Model, æ”¹ç”¨ paraphrase-multilingual-MiniLM-L12-v2 å°ä¸­æ–‡ç†è§£ç¨‹åº¦æ¯”è¼ƒå¥½</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>model <span class=\"token operator\">=</span> SentenceTransformer<span class=\"token punctuation\">(</span><span class=\"token string\">'paraphrase-multilingual-MiniLM-L12-v2'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\"># å»ºç«‹ Qdrant å®¢æˆ¶ç«¯</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>client <span class=\"token operator\">=</span> QdrantClient<span class=\"token punctuation\">(</span><span class=\"token string\">\"127.0.0.1\"</span><span class=\"token punctuation\">,</span> port<span class=\"token operator\">=</span><span class=\"token number\">6333</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\"># collection ä¸å­˜åœ¨å‰‡å»ºç«‹</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\"># size ç‚º 384, å¿…é ˆè·Ÿ embed model ç¶­åº¦æ­é…</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>collection_name <span class=\"token operator\">=</span> <span class=\"token string\">\"multilingual_notes\"</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> client<span class=\"token punctuation\">.</span>collection_exists<span class=\"token punctuation\">(</span>collection_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    client<span class=\"token punctuation\">.</span>create_collection<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        collection_name<span class=\"token operator\">=</span>collection_name<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        vectors_config<span class=\"token operator\">=</span>VectorParams<span class=\"token punctuation\">(</span>size<span class=\"token operator\">=</span><span class=\"token number\">384</span><span class=\"token punctuation\">,</span> distance<span class=\"token operator\">=</span>Distance<span class=\"token punctuation\">.</span>COSINE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token comment\"># æº–å‚™å¯«å…¥çš„è³‡æ–™</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>documents <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"EndeavourOS ä½¿ç”¨ pacman ä½œç‚ºå¥—ä»¶ç®¡ç†å™¨ã€‚\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Python çš„è™›æ“¬ç’°å¢ƒå¯ä»¥é€é venv æ¨¡çµ„å»ºç«‹ã€‚\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Vector Database è² è²¬å„²å­˜é«˜ç¶­åº¦çš„å‘é‡æ•¸æ“šã€‚\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"ç­‰æ˜¥ç¯€ç‰¹è³£å«éš”å£ç‹å”å”è²·çµ¦ä½ \"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"ç‰›ä»”è¤²ç‰¹è³£æœƒåœ¨ä¸‹é€±æœ«èˆ‰è¡Œï¼Œåˆ¥å¿˜äº†å»çœ‹çœ‹ï¼\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token comment\"># æ‰¹æ¬¡ç”¢ç”Ÿæ¯å€‹å…§å®¹çš„å‘é‡ï¼Œåˆ©ç”¨ GPU åŠ é€Ÿæ‰¹æ¬¡è™•ç†çœæ•ˆèƒ½</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>texts <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>doc<span class=\"token punctuation\">[</span><span class=\"token string\">\"text\"</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> doc <span class=\"token keyword\">in</span> documents<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>vectors <span class=\"token operator\">=</span> model<span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span>texts<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token comment\"># å»ºç«‹å‘é‡èˆ‡å…§å®¹è³‡æ–™é»</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>points <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token keyword\">for</span> i<span class=\"token punctuation\">,</span> doc <span class=\"token keyword\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token punctuation\">(</span>documents<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    points<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>PointStruct<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token builtin\">id</span><span class=\"token operator\">=</span>doc<span class=\"token punctuation\">[</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        vector<span class=\"token operator\">=</span>vectors<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>tolist<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        payload<span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"page_content\"</span><span class=\"token punctuation\">:</span> doc<span class=\"token punctuation\">[</span><span class=\"token string\">\"text\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token comment\"># æ–°å¢è³‡æ–™é»åˆ° Qdrant</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>client<span class=\"token punctuation\">.</span>upsert<span class=\"token punctuation\">(</span>collection_name<span class=\"token operator\">=</span>collection_name<span class=\"token punctuation\">,</span> points<span class=\"token operator\">=</span>points<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token comment\"># èªç¾©æœå°‹æ¸¬è©¦</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>query_text <span class=\"token operator\">=</span> <span class=\"token string\">\"åª½åª½æˆ‘å¥½æƒ³è¦ä¸€å° Steam Deck\"</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>query_vector <span class=\"token operator\">=</span> model<span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span>query_text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>tolist<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>search_result <span class=\"token operator\">=</span> client<span class=\"token punctuation\">.</span>query_points<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    collection_name<span class=\"token operator\">=</span>collection_name<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    query<span class=\"token operator\">=</span>query_vector<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    <span class=\"token comment\"># æœå°‹ç›¸ä¼¼åº¦æœ€é«˜çš„ 5 ç­†</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>    limit<span class=\"token operator\">=</span><span class=\"token number\">5</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>points</pre></td></tr><tr><td data-num=\"57\"></td><td><pre></pre></td></tr><tr><td data-num=\"58\"></td><td><pre><span class=\"token comment\"># é¡¯ç¤ºæœå°‹çµæœ</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"--- é‡å°ã€Œ</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>query_text<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">ã€æœå°‹åˆ°å‰ </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>search_result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\"> ç­†ç›¸é—œè³‡æ–™ ---\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre><span class=\"token keyword\">for</span> i<span class=\"token punctuation\">,</span> res <span class=\"token keyword\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token punctuation\">(</span>search_result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>    content <span class=\"token operator\">=</span> res<span class=\"token punctuation\">.</span>payload<span class=\"token punctuation\">[</span><span class=\"token string\">'page_content'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>    score <span class=\"token operator\">=</span> res<span class=\"token punctuation\">.</span>score</pre></td></tr><tr><td data-num=\"63\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>i<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">. [åˆ†æ•¸: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>score<span class=\"token punctuation\">:</span><span class=\"token format-spec\">.4f</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">] </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>content<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre></pre></td></tr><tr><td data-num=\"65\"></td><td><pre><span class=\"token comment\"># åŸ·è¡Œçµæœ</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre><span class=\"token comment\"># --- é‡å°ã€Œåª½åª½æˆ‘å¥½æƒ³è¦ä¸€å° Steam Deckã€æœå°‹åˆ°å‰ 5 ç­†ç›¸é—œè³‡æ–™ ---</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre><span class=\"token comment\"># 1. [åˆ†æ•¸: 0.2213] ç­‰æ˜¥ç¯€ç‰¹è³£å«éš”å£ç‹å”å”è²·çµ¦ä½ </span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre><span class=\"token comment\"># 2. [åˆ†æ•¸: 0.1929] ç‰›ä»”è¤²ç‰¹è³£æœƒåœ¨ä¸‹é€±æœ«èˆ‰è¡Œï¼Œåˆ¥å¿˜äº†å»çœ‹çœ‹ï¼</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre><span class=\"token comment\"># 3. [åˆ†æ•¸: -0.0284] Python çš„è™›æ“¬ç’°å¢ƒå¯ä»¥é€é venv æ¨¡çµ„å»ºç«‹ã€‚</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre><span class=\"token comment\"># 4. [åˆ†æ•¸: -0.0446] Vector Database è² è²¬å„²å­˜é«˜ç¶­åº¦çš„å‘é‡æ•¸æ“šã€‚</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre><span class=\"token comment\"># 5. [åˆ†æ•¸: -0.0561] EndeavourOS ä½¿ç”¨ pacman ä½œç‚ºå¥—ä»¶ç®¡ç†å™¨ã€‚</span></pre></td></tr></table></figure><div class=\"note info\">\n<ul>\n<li>é¤˜å¼¦ç›¸ä¼¼åº¦ï¼šæ•¸å€¼åœ¨ <em><strong>-1 ~ 1</strong></em> ä¹‹é–“ åˆ†æ•¸è¶Šé«˜è¶Šå¥½ï¼Œä»£è¡¨èªç¾©è¶Šæ¥è¿‘ã€‚å¯ä»¥èª¿æ•´ distance=Distance.COSINE ä¿®æ”¹æˆå…¶ä»–æ¼”ç®—æ³•ã€‚</li>\n<li>Vector db é¸å‹é ˆæ ¹æ“šä½¿ç”¨çš„ embed modelï¼Œéœ€è¦å¯ä»¥å„²å­˜è©² model ä½¿ç”¨çš„ç¶­åº¦</li>\n<li>å¯ä»¥å»ºç«‹ä¸åŒç¶­åº¦çš„ collection</li>\n</ul>\n</div>\n<details class=\"success\"><summary>Qdrant æœ‰ web ç•Œé¢</summary><div>\n<p><img loading=\"lazy\" src=\"qdrant.png\" alt=\"Qdrant\" /></p>\n</div></details>\n<h1 id=\"rag\"><a class=\"anchor\" href=\"#rag\">#</a> RAG</h1>\n<p>è¦é€²è¡Œ RAG é‚„å·® LLM (Large Language Model), LLM å±¬æ–¼ RAG çš„ G (Generate), é€™é‚Šä½¿ç”¨ Ollama è¼‰å…¥ llama3</p>\n<details class=\"info\"><summary>å®‰è£ä¾è³´å¥—ä»¶</summary><div>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>pip <span class=\"token function\">install</span> langchain-huggingface langchain-qdrant langchain-ollama langchain-core</pre></td></tr></table></figure></div></details>\n<details class=\"info\"><summary>åœ¨ Arch Linux å®‰è£ Ollama</summary><div>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>å®‰è£ Ollama</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yay <span class=\"token parameter variable\">-S</span> ollama-cuda</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">sudo</span> systemctl start ollama</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># æª¢æŸ¥æ˜¯å¦å•Ÿç”¨æˆåŠŸ</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>systemctl is-active ollama</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># è¼‰å…¥ llama3 æ¨¡å‹</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>ollama run llama3</pre></td></tr></table></figure></div></details>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>RAG demo</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> os</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># é¡åƒåŠ é€Ÿï¼ˆå¦‚æœæ¨¡å‹å·²ä¸‹è¼‰å‰‡æœƒè‡ªå‹•è·³éï¼‰</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>os<span class=\"token punctuation\">.</span>environ<span class=\"token punctuation\">[</span><span class=\"token string\">\"HF_ENDPOINT\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"https://hf-mirror.com\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">from</span> langchain_huggingface <span class=\"token keyword\">import</span> HuggingFaceEmbeddings</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">from</span> langchain_qdrant <span class=\"token keyword\">import</span> QdrantVectorStore</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">from</span> langchain_ollama <span class=\"token keyword\">import</span> ChatOllama</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">from</span> langchain_core<span class=\"token punctuation\">.</span>prompts <span class=\"token keyword\">import</span> ChatPromptTemplate</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">from</span> langchain_core<span class=\"token punctuation\">.</span>runnables <span class=\"token keyword\">import</span> RunnablePassthrough</pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">from</span> langchain_core<span class=\"token punctuation\">.</span>output_parsers <span class=\"token keyword\">import</span> StrOutputParser</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\"># çµ±ä¸€æ¨¡å‹åç¨±ï¼Œè¦è·Ÿå¯«å…¥ vector db æ™‚ä½¿ç”¨çš„æ¨¡å‹ä¸€è‡´</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>EMBEDDING_MODEL_NAME <span class=\"token operator\">=</span> <span class=\"token string\">\"paraphrase-multilingual-MiniLM-L12-v2\"</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>embeddings <span class=\"token operator\">=</span> HuggingFaceEmbeddings<span class=\"token punctuation\">(</span>model_name<span class=\"token operator\">=</span>EMBEDDING_MODEL_NAME<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\"># Retrieval - ç”¨æ–¼æª¢ç´¢çš„å‘é‡è³‡æ–™åº«</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>vector_store <span class=\"token operator\">=</span> QdrantVectorStore<span class=\"token punctuation\">.</span>from_existing_collection<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    embedding<span class=\"token operator\">=</span>embeddings<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    collection_name<span class=\"token operator\">=</span><span class=\"token string\">\"multilingual_notes\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    url<span class=\"token operator\">=</span><span class=\"token string\">\"http://127.0.0.1:6333\"</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token comment\"># Augmentation - å®šç¾©è©¢å• LLM çš„ prompt æ¨¡æ¿</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>template <span class=\"token operator\">=</span> <span class=\"token triple-quoted-string string\">\"\"\"ä½ æ˜¯ä¸€å€‹åŸºæ–¼æœ¬åœ°çŸ¥è­˜åº«çš„ AI åŠ©æ‰‹ã€‚</pre></td></tr><tr><td data-num=\"26\"></td><td><pre>è«‹æ ¹æ“šä»¥ä¸‹æä¾›çš„ã€Œåƒè€ƒè³‡æ–™ã€å›ç­”ã€Œå•é¡Œã€ã€‚</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>å¦‚æœåƒè€ƒè³‡æ–™ä¸­æ²’æœ‰ç›¸é—œç­”æ¡ˆï¼Œè«‹èª å¯¦å‘ŠçŸ¥ä½ ä¸çŸ¥é“ã€‚</pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>[åƒè€ƒè³‡æ–™]:</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>&#123;context&#125;</pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>[å•é¡Œ]:</pre></td></tr><tr><td data-num=\"33\"></td><td><pre>ç”¨ä¸­æ–‡å›ç­” `&#123;question&#125;`</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>\"\"\"</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>prompt <span class=\"token operator\">=</span> ChatPromptTemplate<span class=\"token punctuation\">.</span>from_template<span class=\"token punctuation\">(</span>template<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token comment\"># æª¢ç´¢è¨­å®šï¼Œæª¢ç´¢ç›¸ä¼¼åº¦æœ€é«˜çš„ 2 ç­†è³‡æ–™</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>retriever <span class=\"token operator\">=</span> vector_store<span class=\"token punctuation\">.</span>as_retriever<span class=\"token punctuation\">(</span>search_kwargs<span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"k\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token comment\"># æ–‡æª”æ ¼å¼åŒ–å‡½æ•¸</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">format_docs</span><span class=\"token punctuation\">(</span>docs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>doc<span class=\"token punctuation\">.</span>page_content <span class=\"token keyword\">for</span> doc <span class=\"token keyword\">in</span> docs<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token comment\"># Generation - ä½¿ç”¨çš„ç”Ÿæˆæ¨¡å‹</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>llm <span class=\"token operator\">=</span> ChatOllama<span class=\"token punctuation\">(</span>model<span class=\"token operator\">=</span><span class=\"token string\">\"llama3\"</span><span class=\"token punctuation\">,</span> base_url<span class=\"token operator\">=</span><span class=\"token string\">\"http://localhost:11434\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token comment\"># æ§‹å»º RAG éˆï¼ŒåŸ·è¡Œï¼šæœå°‹ Qdrant -> å¡«å…¥æ¨¡æ¿ -> ä¸Ÿçµ¦ Llama3 -> è¼¸å‡ºæ–‡å­—</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>rag_chain <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>        <span class=\"token string\">\"context\"</span><span class=\"token punctuation\">:</span> retriever <span class=\"token operator\">|</span> format_docs<span class=\"token punctuation\">,</span>      <span class=\"token comment\"># å¾å‘é‡åº«æª¢ç´¢ä¸¦æ ¼å¼åŒ–æ–‡æª”</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>        <span class=\"token string\">\"question\"</span><span class=\"token punctuation\">:</span> RunnablePassthrough<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>        <span class=\"token comment\"># åŸæ¨£å‚³éç”¨æˆ¶å•é¡Œ</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    <span class=\"token operator\">|</span> RunnablePassthrough<span class=\"token punctuation\">.</span>assign<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>        <span class=\"token comment\"># prompt - æ¥æ”¶ &#123;context, question&#125;ï¼Œç”Ÿæˆæ ¼å¼åŒ–çš„æç¤ºè©</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>        <span class=\"token comment\"># llm - å°‡æç¤ºè©ç™¼é€çµ¦ Llama3 æ¨¡å‹ï¼Œå¾—åˆ° AI å›ç­”</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>        <span class=\"token comment\"># StrOutputParser () - å°‡ LLM çš„è¼¸å‡ºï¼ˆé€šå¸¸æ˜¯å€‹ AIMessage å°è±¡ï¼‰è½‰æ›æˆç´”æ–‡å­—å­—ç¬¦ä¸²</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>        <span class=\"token comment\"># | æ˜¯ LangChain çš„ LCEL èªæ³•</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>        answer<span class=\"token operator\">=</span>prompt <span class=\"token operator\">|</span> llm <span class=\"token operator\">|</span> StrOutputParser<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>    <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre></pre></td></tr><tr><td data-num=\"62\"></td><td><pre></pre></td></tr><tr><td data-num=\"63\"></td><td><pre><span class=\"token comment\"># åŸ·è¡Œå°è©±æ¸¬è©¦</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre><span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>    query <span class=\"token operator\">=</span> <span class=\"token string\">\"EndeavourOS é©åˆä»€éº¼æ¨£çš„é–‹ç™¼è€…ï¼Ÿ\"</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"\\næå•ï¼š</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>query<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"68\"></td><td><pre>    <span class=\"token comment\"># R - Retrievalï¼šå¾å‘é‡åº«æª¢ç´¢ç›¸é—œæ–‡æª”</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\n----------R Retrieval æª¢ç´¢éšæ®µ----------\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>    docs <span class=\"token operator\">=</span> retriever<span class=\"token punctuation\">.</span>invoke<span class=\"token punctuation\">(</span>query<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>    formatted_context <span class=\"token operator\">=</span> format_docs<span class=\"token punctuation\">(</span>docs<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"æª¢ç´¢åˆ°çš„åƒè€ƒè³‡æ–™ï¼ˆ</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>docs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\"> ç­†ï¼‰ï¼š\\n</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>formatted_context<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"74\"></td><td><pre>    <span class=\"token comment\"># A - Augmentationï¼šå°‡æª¢ç´¢çµæœå¡«å…¥æç¤ºè©</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\n----------A Augmentation å¢å¼·éšæ®µ----------\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>    augmented_prompt <span class=\"token operator\">=</span> prompt<span class=\"token punctuation\">.</span>invoke<span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"context\"</span><span class=\"token punctuation\">:</span> formatted_context<span class=\"token punctuation\">,</span> <span class=\"token string\">\"question\"</span><span class=\"token punctuation\">:</span> query<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"ç”Ÿæˆçš„æç¤ºè©ï¼š\\n</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>augmented_prompt<span class=\"token punctuation\">.</span>to_string<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"79\"></td><td><pre>    <span class=\"token comment\"># G - Generationï¼šLLM ç”Ÿæˆå›ç­”</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\n----------G Generation ç”Ÿæˆéšæ®µ----------\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>    result <span class=\"token operator\">=</span> rag_chain<span class=\"token punctuation\">.</span>invoke<span class=\"token punctuation\">(</span>query<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"AI å›ç­”ï¼š\\n</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>result<span class=\"token punctuation\">[</span><span class=\"token string\">'answer'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre></pre></td></tr><tr><td data-num=\"84\"></td><td><pre><span class=\"token comment\"># åŸ·è¡Œçµæœ</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre><span class=\"token comment\"># æå•ï¼šEndeavourOS é©åˆä»€éº¼æ¨£çš„é–‹ç™¼è€…ï¼Ÿ</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre></pre></td></tr><tr><td data-num=\"87\"></td><td><pre><span class=\"token comment\"># ----------R Retrieval æª¢ç´¢éšæ®µ ----------</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre><span class=\"token comment\"># æª¢ç´¢åˆ°çš„åƒè€ƒè³‡æ–™ï¼ˆ2 ç­†ï¼‰ï¼š</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre><span class=\"token comment\"># EndeavourOS ä½¿ç”¨ pacman ä½œç‚ºå¥—ä»¶ç®¡ç†å™¨ã€‚</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre><span class=\"token comment\"># Python çš„è™›æ“¬ç’°å¢ƒå¯ä»¥é€é venv æ¨¡çµ„å»ºç«‹ã€‚</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre></pre></td></tr><tr><td data-num=\"92\"></td><td><pre><span class=\"token comment\"># ----------A Augmentation å¢å¼·éšæ®µ ----------</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre><span class=\"token comment\"># ç”Ÿæˆçš„æç¤ºè©ï¼š</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre><span class=\"token comment\"># Human: ä½ æ˜¯ä¸€å€‹åŸºæ–¼æœ¬åœ°çŸ¥è­˜åº«çš„ AI åŠ©æ‰‹ã€‚</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre><span class=\"token comment\"># è«‹æ ¹æ“šä»¥ä¸‹æä¾›çš„ã€Œåƒè€ƒè³‡æ–™ã€å›ç­”ã€Œå•é¡Œã€ã€‚</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre><span class=\"token comment\"># å¦‚æœåƒè€ƒè³‡æ–™ä¸­æ²’æœ‰ç›¸é—œç­”æ¡ˆï¼Œè«‹èª å¯¦å‘ŠçŸ¥ä½ ä¸çŸ¥é“ã€‚</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre></pre></td></tr><tr><td data-num=\"98\"></td><td><pre><span class=\"token comment\"># [åƒè€ƒè³‡æ–™]:</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre><span class=\"token comment\"># EndeavourOS ä½¿ç”¨ pacman ä½œç‚ºå¥—ä»¶ç®¡ç†å™¨ã€‚</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre><span class=\"token comment\"># Python çš„è™›æ“¬ç’°å¢ƒå¯ä»¥é€é venv æ¨¡çµ„å»ºç«‹ã€‚</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre></pre></td></tr><tr><td data-num=\"102\"></td><td><pre><span class=\"token comment\"># [å•é¡Œ]:</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre><span class=\"token comment\"># ç”¨ä¸­æ–‡å›ç­” `EndeavourOS é©åˆä»€éº¼æ¨£çš„é–‹ç™¼è€…ï¼Ÿ`</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre></pre></td></tr><tr><td data-num=\"105\"></td><td><pre><span class=\"token comment\"># ----------G Generation ç”Ÿæˆéšæ®µ ----------</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre><span class=\"token comment\"># AI å›ç­”ï¼š</span></pre></td></tr><tr><td data-num=\"107\"></td><td><pre><span class=\"token comment\"># æ ¹æ“šæä¾›çš„åƒè€ƒè³‡æ–™ï¼ŒEndeavourOS ä½¿ç”¨ pacman ä½œç‚ºå¥—ä»¶ç®¡ç†å™¨ã€‚å› æ­¤ï¼Œæˆ‘å€‘å¯ä»¥çŸ¥é“ EndeavourOS æ˜¯ä¸€ç¨® Linux ç™¼è¡Œç‰ˆã€‚</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre><span class=\"token comment\"># çµè«–ï¼šEndeavourOS é€‚åˆ Linux é–‹ç™¼è€…çš„éœ€æ±‚ã€‚</span></pre></td></tr></table></figure><div class=\"note info\">\n<ul>\n<li>å¦‚æœåŸæœ¬ç”¨ A æ¨¡å‹å»ºç«‹çš„ db å¾Œä¾†æƒ³æ”¹ B æ¨¡å‹æ€éº¼è¾¦ï¼Ÿè¦é€²è¡Œ Re-indexing</li>\n<li>å¾ŒçºŒå¯ä»¥å¢åŠ é¿å…å¹»è¦ºæ©Ÿåˆ¶ï¼Œç›¸ä¼¼åº¦é–¥å€¼åˆ¤å®šï¼Œåƒè€ƒè³‡æ–™ä¸è¶³è™•ç†æ©Ÿåˆ¶ç­‰ç­‰...</li>\n</ul>\n</div>\n",
            "tags": [
                "RAG",
                "AI",
                "æª¢ç´¢å¢å¼·ç”Ÿæˆ"
            ]
        },
        {
            "id": "https://8loser.github.io/2025/12/21/deploy-docker-nginx/",
            "url": "https://8loser.github.io/2025/12/21/deploy-docker-nginx/",
            "title": "å¤šæœå‹™ Docker éƒ¨ç½²èˆ‡ Nginx è¨­å®šç­†è¨˜",
            "date_published": "2025-12-21T00:58:03.000Z",
            "content_html": "<h1 id=\"æ–‡ç« èªªæ˜\"><a class=\"anchor\" href=\"#æ–‡ç« èªªæ˜\">#</a> æ–‡ç« èªªæ˜</h1>\n<p>é€™æ˜¯å°‡æœå‹™éƒ¨ç½²åˆ°é›²ç«¯çš„å°ˆæ¡ˆã€‚<br />\nVM å»ºç«‹å¥½å¾Œï¼Œå°‡å°ˆæ¡ˆ pull åˆ°  <code>/opt</code>  ä¸‹å³å¯å¿«é€Ÿéƒ¨ç½²ã€‚</p>\n<h1 id=\"ç’°å¢ƒ\"><a class=\"anchor\" href=\"#ç’°å¢ƒ\">#</a> ç’°å¢ƒ</h1>\n<p>æ¯å€‹æœå‹™ç¨‹å¼ç¢¼ç”± GitHub è¨—ç®¡ï¼Œä¸¦è¨­ç½®è‡ªå‹•æ‰“åŒ…æˆ Docker imageã€‚<br />\næ©Ÿå™¨å®‰è£ Dockerï¼Œéƒ¨ç½²æ™‚ pull Docker image å•Ÿå‹•å¤šå€‹æœå‹™ containerã€‚<br />\nç”± Nginx æ§åˆ¶è«‹æ±‚é€²å…¥æœå‹™ã€‚</p>\n<h1 id=\"å°ˆæ¡ˆè³‡æ–™å¤¾çµæ§‹\"><a class=\"anchor\" href=\"#å°ˆæ¡ˆè³‡æ–™å¤¾çµæ§‹\">#</a> å°ˆæ¡ˆè³‡æ–™å¤¾çµæ§‹</h1>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"><span>è³‡æ–™å¤¾çµæ§‹</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>.</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>â”œâ”€â”€ init.sh                # æ©Ÿå™¨åˆå§‹åŒ–</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>â”œâ”€â”€ prod</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>â”‚   â”œâ”€â”€ docker-compose.yml # æ­£å¼ç«™ Docker Swarm Stack è¨­å®š</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>â”‚   â””â”€â”€ nginx.conf         # æ­£å¼ç«™ Nginx è¨­å®š</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>â”œâ”€â”€ start-prod.sh          # å•Ÿå‹•</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>â””â”€â”€ stop-prod.sh           # åœæ­¢</pre></td></tr></table></figure><p>é¦–å…ˆåŸ·è¡Œ  <code>init.sh</code>  æ›´æ–°ç³»çµ±ã€å®‰è£å¸¸ç”¨ç¨‹å¼ï¼Œåƒè€ƒ <a href=\"/2023/01/04/gcp-init/\">GCP VM å»ºç½®ç­†è¨˜</a>ã€‚</p>\n<h1 id=\"start-prodsh\"><a class=\"anchor\" href=\"#start-prodsh\">#</a> <a href=\"http://start-prod.sh\">start-prod.sh</a></h1>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"><span>start-prod.sh</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token shebang important\">#!/bin/sh</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># å•Ÿå‹•æ­£å¼ç«™ container</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">docker</span> stack deploy --compose-file prod/docker-compose.yml --with-registry-auth company</pre></td></tr></table></figure><p>é€™é‚Šæ²’ä»€éº¼å¥½ä»‹ç´¹çš„ï¼Œå°±æ˜¯ç”¨  <code>docker stack deploy</code>  å•Ÿå‹• Docker Swarm Stackã€‚</p>\n<p><code>--with-registry-auth</code>  æœƒæŠŠæœ¬æ©Ÿ  <code>docker login</code>  çš„ registry èªè­‰ä¸€ä½µå‚³çµ¦ Swarm ç¯€é»ï¼Œ<br />\nè®“ç¯€é»åœ¨æ‹‰ç§æœ‰ image æ™‚èƒ½é †åˆ©é€šéæˆæ¬Šï¼›ä¸åŠ çš„è©±ï¼Œç§æœ‰å€‰åº«å¸¸æœƒå‡ºç¾æ‹‰ä¸åˆ° image çš„éŒ¯èª¤ã€‚</p>\n<h1 id=\"docker-composeyml\"><a class=\"anchor\" href=\"#docker-composeyml\">#</a> docker-compose.yml</h1>\n<figure class=\"highlight yaml\"><figcaption data-lang=\"YAML\"><span>prod/docker-compose.yml</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># æ­£å¼ç«™ container</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'3.8'</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token key atrule\">nginx</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> nginx</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token key atrule\">restart</span><span class=\"token punctuation\">:</span> unless<span class=\"token punctuation\">-</span>stopped</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token comment\"># Nginx è¨­å®šæª”</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token punctuation\">-</span> ./nginx.conf<span class=\"token punctuation\">:</span>/etc/nginx/conf.d/default.conf</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token key atrule\">TZ</span><span class=\"token punctuation\">:</span> Asia/Taipei</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">target</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token key atrule\">published</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> tcp</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token key atrule\">mode</span><span class=\"token punctuation\">:</span> host</pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  <span class=\"token comment\"># å¾Œç«¯ API</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>  <span class=\"token key atrule\">backend</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> ghcr.io/8loser/backend<span class=\"token punctuation\">:</span>main</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token key atrule\">restart</span><span class=\"token punctuation\">:</span> unless<span class=\"token punctuation\">-</span>stopped</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>      <span class=\"token key atrule\">TZ</span><span class=\"token punctuation\">:</span> Asia/Taipei</pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>  <span class=\"token comment\"># å‰ç«¯</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>  <span class=\"token key atrule\">frontend</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> ghcr.io/8loser/frontend<span class=\"token punctuation\">:</span>main</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token key atrule\">restart</span><span class=\"token punctuation\">:</span> unless<span class=\"token punctuation\">-</span>stopped</pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>      <span class=\"token key atrule\">TZ</span><span class=\"token punctuation\">:</span> Asia/Taipei</pre></td></tr></table></figure><p>èªªæ˜ï¼š</p>\n<ul>\n<li>æœ‰ 3 å€‹æœå‹™ï¼›Nginxã€frontendã€backendã€‚</li>\n<li>Nginx ä¸ç”¨  <code>depends_on backend, frontend</code>  é¿å…æŸå€‹æœå‹™ç•°å¸¸å°è‡´ Nginx è¢«ç‰½é€£åœæ­¢ã€‚</li>\n<li>Nginx  <code>mode: host</code>  ç›´æ¥ç”¨ä¸»æ©Ÿ 80 å°å¤–æä¾›æœå‹™ï¼ŒLoad Balancer æµé‡å°å…¥ Nginx 80 portï¼Œåƒ…æœ‰è·‘è©²æœå‹™çš„ç¯€é»æœƒé–‹ 80ã€‚</li>\n<li>Nginx è¨­å®šæª”ç›´æ¥æ›è¼‰  <code>prod/nginx.conf</code>  æª”æ¡ˆã€‚</li>\n<li>Stack æœƒä½¿ç”¨ Swarm overlay networkï¼Œ <code>proxy_pass http://frontend/</code>  èˆ‡  <code>proxy_pass http://backend/</code>  æœƒè§£æåˆ°åŒä¸€å€‹ Stack çš„ serviceã€‚</li>\n<li><code>ghcr.io</code>  æ˜¯ GitHub Container Registryï¼Œç”¨æ–¼å­˜æ”¾ Docker imageã€‚</li>\n</ul>\n<h1 id=\"nginxconf\"><a class=\"anchor\" href=\"#nginxconf\">#</a> nginx.conf</h1>\n<figure class=\"highlight nginx\"><figcaption data-lang=\"nginx\"><span>prod/nginx.conf</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># æ­£å¼ç«™ Nginx</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># é è¨­ server; ä½¿ç”¨ IP æˆ–æœªåŒ¹é…çš„åŸŸåéƒ½æœƒé€²å…¥</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token directive\"><span class=\"token keyword\">server</span></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token directive\"><span class=\"token keyword\">listen</span> <span class=\"token number\">80</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token directive\"><span class=\"token keyword\">server_name</span> _</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token comment\"># ä¸åˆæ³• Host è¨ªå• /ï¼Œä¸è¿”å›å…§å®¹</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token directive\"><span class=\"token keyword\">location</span> /</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token directive\"><span class=\"token keyword\">return</span> <span class=\"token number\">204</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token directive\"><span class=\"token keyword\">server</span></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  <span class=\"token directive\"><span class=\"token keyword\">listen</span> <span class=\"token number\">80</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  <span class=\"token comment\"># å…è¨±çš„åŸŸå</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  <span class=\"token directive\"><span class=\"token keyword\">server_name</span> www.*******.com *******.com</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  <span class=\"token comment\"># Load Balancer Public IP address</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>  <span class=\"token directive\"><span class=\"token keyword\">set_real_ip_from</span> &lt;LB_IP>/32</span><span class=\"token punctuation\">;</span> <span class=\"token comment\"># å¡«å…¥ä½ çš„ LB IP</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>  <span class=\"token comment\"># Google CIDR ç¶²æ®µ</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>  <span class=\"token directive\"><span class=\"token keyword\">set_real_ip_from</span> 130.211.0.0/22</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>  <span class=\"token directive\"><span class=\"token keyword\">set_real_ip_from</span> 35.191.0.0/16</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>  <span class=\"token directive\"><span class=\"token keyword\">real_ip_header</span> X-Forwarded-For</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>  <span class=\"token directive\"><span class=\"token keyword\">real_ip_recursive</span> <span class=\"token boolean\">on</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>  <span class=\"token comment\"># é˜»æ“‹çš„ User Agent</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>  <span class=\"token directive\"><span class=\"token keyword\">if</span> (<span class=\"token variable\">$http_user_agent</span> ~* <span class=\"token string\">\"ApacheBench|pingback|YisouSpider|MJ12bot|AhrefsBot|360JK|Jorgee|FeedDemon|BOT/0.1 (BOT for JCE)|CrawlDaddy|Java|Jullo|Feedly|UniversalFeedParser|Swiftbot|YandexBot|jikeSpider|ZmEu phpmyadmin|WinHttp|EasouSpider|HttpClient|Microsoft URL Control|YYSpider|jaunty|oBot|Python-urllib|Indy Library|FlightDeckReports Bot|Linguee Bot\"</span> )</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>  <span class=\"token punctuation\">&#123;</span>return <span class=\"token directive\"><span class=\"token keyword\">101</span></span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>  <span class=\"token comment\"># æ­£å¼ç«™è¨­å®š robots.txt å…è¨±çˆ¬èŸ²</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>  <span class=\"token directive\"><span class=\"token keyword\">location</span> = /robots.txt</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token directive\"><span class=\"token keyword\">add_header</span> Content-Type text/plain</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token directive\"><span class=\"token keyword\">return</span> <span class=\"token number\">200</span> <span class=\"token string\">\"User-agent: *<span class=\"token escape entity\">\\n</span>Allow: /<span class=\"token escape entity\">\\n</span>\"</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>  <span class=\"token comment\"># å‰ç«¯</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>  <span class=\"token directive\"><span class=\"token keyword\">location</span> /</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token directive\"><span class=\"token keyword\">proxy_pass</span> http://frontend/</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token directive\"><span class=\"token keyword\">proxy_set_header</span> Host <span class=\"token variable\">$host</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token directive\"><span class=\"token keyword\">proxy_set_header</span> X-Real-IP <span class=\"token variable\">$remote_addr</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token directive\"><span class=\"token keyword\">proxy_set_header</span> X-Forwarded-For <span class=\"token variable\">$proxy_add_x_forwarded_for</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token directive\"><span class=\"token keyword\">proxy_set_header</span> X-Custom-Referrer smc_identity_layer</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"47\"></td><td><pre>  <span class=\"token comment\"># å¾Œç«¯</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>  <span class=\"token directive\"><span class=\"token keyword\">location</span> /api/</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token directive\"><span class=\"token keyword\">proxy_pass</span> http://backend/</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    <span class=\"token directive\"><span class=\"token keyword\">proxy_set_header</span> Host <span class=\"token variable\">$host</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>    <span class=\"token directive\"><span class=\"token keyword\">proxy_set_header</span> X-Real-IP <span class=\"token variable\">$remote_addr</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    <span class=\"token directive\"><span class=\"token keyword\">proxy_set_header</span> X-Forwarded-For <span class=\"token variable\">$proxy_add_x_forwarded_for</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    <span class=\"token directive\"><span class=\"token keyword\">proxy_set_header</span> X-Custom-Referrer smc_identity_layer</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>èªªæ˜ï¼š</p>\n<ul>\n<li>é è¨­ server ç”¨æ–¼æ””æˆªæœªåŒ¹é…çš„ Hostï¼Œç›´æ¥å› 204ã€‚</li>\n<li><code>/</code>  èµ° frontendã€ <code>/api/</code>  èµ° backendï¼Œä½¿ç”¨  <code>proxy_pass</code>  è½‰ç™¼è«‹æ±‚ã€‚</li>\n<li><code>set_real_ip_from</code>  ç”¨ä¾†é™å®šå¯ä¿¡ä»»çš„è½‰ç™¼ä¾†æºï¼ˆLB èˆ‡ Google CIDRï¼‰ï¼Œæ‰èƒ½æ­£ç¢ºé‚„åŸ client IPï¼Œé¿å…è¢«å½é€ çš„  <code>X-Forwarded-For</code>  å½±éŸ¿ã€‚</li>\n<li><code>proxy_pass http://backend/</code>  çš„  <code>backend</code>  å°æ‡‰  <code>docker-compose.yml</code>  çš„ service åç¨±ã€‚</li>\n</ul>\n",
            "tags": [
                "Deploy",
                "GCP",
                "Nginx",
                "log",
                "Docker",
                "Deploy"
            ]
        },
        {
            "id": "https://8loser.github.io/2025/06/23/node-usb-relay/",
            "url": "https://8loser.github.io/2025/06/23/node-usb-relay/",
            "title": "Node.JS æ§åˆ¶ USB ç¹¼é›»å™¨",
            "date_published": "2025-06-23T06:36:42.000Z",
            "content_html": "<h1 id=\"usb-relay\"><a class=\"anchor\" href=\"#usb-relay\">#</a> USB Relay</h1>\n<p>USB relay æ¨¡çµ„å°±æ˜¯é€™å€‹ï¼Œé è¨ˆç”¨ Node.js ç¨‹å¼è¼¸å‡ºé›»æ°£è¨Šè™Ÿæ§åˆ¶æ©Ÿæ¢°æ‰‹è‡‚ï¼Œé€™å€‹æ˜¯å…©è·¯çš„ï¼ˆå…©å€‹ relayï¼‰ï¼Œé‚„æœ‰ä¸€è·¯æˆ–è€…æ›´å¤šè·¯çš„ã€‚</p>\n<p><img loading=\"lazy\" src=\"USB-relay.png\" alt=\"USB Relay\" /></p>\n<p>è¼¸å‡ºæ¥é»è·Ÿä¸€èˆ¬ç¹¼é›»å™¨çš„æ¥é»ä¸€æ¨£</p>\n<table>\n<thead>\n<tr>\n<th>ç«¯é»</th>\n<th>å…¨å</th>\n<th>åŠŸèƒ½æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>COM</td>\n<td>Commonï¼ˆå…±ç”¨ç«¯ï¼‰</td>\n<td>ä¸­å¿ƒç«¯é»ï¼Œæ ¹æ“šæ§åˆ¶æƒ…æ³èˆ‡ NC æˆ– NO æ¥é€š</td>\n</tr>\n<tr>\n<td>NC</td>\n<td>Normally Closedï¼ˆå¸¸é–‰ï¼‰</td>\n<td>åœ¨  <code>æœªé€šé›»</code>  ç‹€æ…‹ä¸‹ï¼Œ <code>èˆ‡ COM æ¥é€š</code></td>\n</tr>\n<tr>\n<td>NO</td>\n<td>Normally Openï¼ˆå¸¸é–‹ï¼‰</td>\n<td>åœ¨  <code>æœªé€šé›»</code>  ç‹€æ…‹ä¸‹ï¼Œ <code>èˆ‡ COM æ–·é–‹</code> ï¼Œé€šé›»å¾Œæ‰æ¥é€š</td>\n</tr>\n</tbody>\n</table>\n<p>æ¥ç·šæ–¹å¼ä½¿ç”¨ USB-A è½‰ USB-Bï¼ŒUSB-A æ¥é›»è…¦ï¼ŒUSB-B æ¥æ¨¡çµ„</p>\n<p><img loading=\"lazy\" src=\"USB-A-to-USB-B.png\" alt=\"USB-A to USB-B\" /></p>\n<h1 id=\"ç¨‹å¼æ¸¬è©¦\"><a class=\"anchor\" href=\"#ç¨‹å¼æ¸¬è©¦\">#</a> ç¨‹å¼æ¸¬è©¦</h1>\n<p>ä½¿ç”¨ <a href=\"https://www.npmjs.com/package/node-hid\">node-hid</a> å¥—ä»¶ï¼Œè«‹å…ˆç¢ºå®šä½¿ç”¨çš„æ¨¡çµ„æ”¯æ´ HID</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"><span>ç¹¼é›»å™¨æ§åˆ¶</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">const</span> <span class=\"token constant\">HID</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'node-hid'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// å°‹æ‰¾é€£æ¥è£ç½®ä¸­ USBRelay åç¨±çš„è£ç½®</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">const</span> deviceList <span class=\"token operator\">=</span> <span class=\"token constant\">HID</span><span class=\"token punctuation\">.</span><span class=\"token function\">devices</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">const</span> connectedRelays <span class=\"token operator\">=</span> deviceList<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">device</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> device<span class=\"token punctuation\">.</span>product <span class=\"token operator\">&amp;&amp;</span> device<span class=\"token punctuation\">.</span>product<span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span><span class=\"token string\">'USBRelay'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">const</span> device <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HID<span class=\"token punctuation\">.</span>HID</span><span class=\"token punctuation\">(</span>connectedRelays<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">// å•Ÿå‹•ç¬¬ä¸€å€‹ relay</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>device<span class=\"token punctuation\">.</span><span class=\"token function\">sendFeatureReport</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x01</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">// å•Ÿå‹•ç¬¬äºŒå€‹ relay</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>device<span class=\"token punctuation\">.</span><span class=\"token function\">sendFeatureReport</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x02</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">// é—œé–‰ç¬¬ä¸€å€‹ relay</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>device<span class=\"token punctuation\">.</span><span class=\"token function\">sendFeatureReport</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFD</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x01</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\">// é—œé–‰ç¬¬äºŒå€‹ relay</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>device<span class=\"token punctuation\">.</span><span class=\"token function\">sendFeatureReport</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFD</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x02</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>å¦‚æœæ­£å¸¸å•Ÿå‹•ç¹¼é›»å™¨æ™‚ï¼Œæ¨¡çµ„ä¸Šå°æ‡‰çš„ç¹¼é›»å™¨æ— LED æœƒäº®</p>\n<h1 id=\"è¨­å®š-bytes-èªªæ˜\"><a class=\"anchor\" href=\"#è¨­å®š-bytes-èªªæ˜\">#</a> è¨­å®š Bytes èªªæ˜</h1>\n<table>\n<thead>\n<tr>\n<th>Byte ä½ç½®</th>\n<th>èªªæ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>0</td>\n<td>å‘½ä»¤æ¨™é ­ï¼ˆé€šå¸¸æ˜¯å›ºå®šå€¼ï¼‰</td>\n</tr>\n<tr>\n<td>1</td>\n<td>æ§åˆ¶å‘½ä»¤</td>\n</tr>\n<tr>\n<td>2</td>\n<td>è¦æ§åˆ¶çš„ç¹¼é›»å™¨ä½å…ƒçµ„ï¼ˆbitmaskï¼‰</td>\n</tr>\n<tr>\n<td>3~8</td>\n<td>å……å¡«ä½å…ƒ</td>\n</tr>\n</tbody>\n</table>\n<h1 id=\"ç¨‹å¼è¨­è¨ˆæ€è·¯\"><a class=\"anchor\" href=\"#ç¨‹å¼è¨­è¨ˆæ€è·¯\">#</a> ç¨‹å¼è¨­è¨ˆæ€è·¯</h1>\n<ul>\n<li>ä½¿ç”¨ class</li>\n<li>constructor é€²è¡Œ init, å¯æŒ‡å®š device path æˆ–è‡ªå‹•æœå°‹</li>\n<li>æ¯å€‹ relay on/off ä½¿ç”¨çš„ bytes ç”¨ list å„²å­˜</li>\n<li>setOff(channelNumber), setOn(channelNumber)</li>\n<li>æ ¹æ“šæ©Ÿæ¢°æ‰‹è‡‚å‹•ä½œå®šç¾©ï¼ŒActionOK (), ActionNG ()</li>\n<li>åˆ‡ç‚º on ä¹‹å¾Œå¤šä¹…å¾©æ­¸åŸç‹€æ…‹å¯èª¿æ•´</li>\n</ul>\n<h1 id=\"éƒ¨ä»½ç¨‹å¼ç¢¼\"><a class=\"anchor\" href=\"#éƒ¨ä»½ç¨‹å¼ç¢¼\">#</a> éƒ¨ä»½ç¨‹å¼ç¢¼</h1>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"><span>setOn()</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// å•Ÿå‹•ç¬¬å¹¾å€‹ relay</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">setOn</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">number</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">const</span> commandList <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token comment\">// all</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token punctuation\">[</span><span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFE</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token comment\">// ç¬¬ä¸€å€‹ relay</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token punctuation\">[</span><span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x01</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token comment\">// ç¬¬äºŒå€‹ relay</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token punctuation\">[</span><span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x02</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token comment\">// ç¬¬ä¸‰å€‹ relay</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token punctuation\">[</span><span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token comment\">// ç¬¬å››å€‹ relay</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token punctuation\">[</span><span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x04</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token comment\">// ç¬¬äº”å€‹ relay</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token punctuation\">[</span><span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x05</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token comment\">// ç¬¬å…­å€‹ relay</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token punctuation\">[</span><span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x06</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token comment\">// ç¬¬ä¸ƒå€‹ relay</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token punctuation\">[</span><span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x07</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token comment\">// ç¬¬å…«å€‹ relay</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token punctuation\">[</span><span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x08</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>device<span class=\"token punctuation\">.</span><span class=\"token function\">sendFeatureReport</span><span class=\"token punctuation\">(</span>commandList<span class=\"token punctuation\">[</span>number<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"><span>setOff()</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// é—œé–‰ç¬¬å¹¾å€‹ relay</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">setOff</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">number</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">const</span> commandList <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token comment\">// all</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token punctuation\">[</span><span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFC</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token comment\">// ç¬¬ä¸€å€‹ relay</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token punctuation\">[</span><span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFD</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x01</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token comment\">// ç¬¬äºŒå€‹ relay</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token punctuation\">[</span><span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFD</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x02</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token comment\">// ç¬¬ä¸‰å€‹ relay</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token punctuation\">[</span><span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFD</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token comment\">// ç¬¬å››å€‹ relay</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token punctuation\">[</span><span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFD</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x04</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token comment\">// ç¬¬äº”å€‹ relay</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token punctuation\">[</span><span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFD</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x05</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token comment\">// ç¬¬å…­å€‹ relay</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token punctuation\">[</span><span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFD</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x06</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token comment\">// ç¬¬ä¸ƒå€‹ relay</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token punctuation\">[</span><span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFD</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x07</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token comment\">// ç¬¬å…«å€‹ relay</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token punctuation\">[</span><span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFD</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x08</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>device<span class=\"token punctuation\">.</span><span class=\"token function\">sendFeatureReport</span><span class=\"token punctuation\">(</span>commandList<span class=\"token punctuation\">[</span>number<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"><span>ActionOK()</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">ActionOK</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token comment\">//relay 1 ä½œç‚º OK è¨Šè™Ÿ</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setOn</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"><span>ActionNG()</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">ActionNG</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token comment\">//relay 2 ä½œç‚º NG è¨Šè™Ÿ</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setOn</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h1 id=\"å‚™è¨»\"><a class=\"anchor\" href=\"#å‚™è¨»\">#</a> å‚™è¨»</h1>\n<ul>\n<li>æ³¨æ„è¼¸å‡ºæ§åˆ¶å¯æ‰¿å—è² è¼‰ç¯„åœï¼Œé€šå¸¸åœ¨ç¹¼é›»å™¨ä¸Šæœƒæ¨™ç¤º</li>\n<li>éœ€è¦ HID æ”¯æ´çš„æ¨¡çµ„</li>\n<li>åƒè€ƒ <a href=\"https://github.com/josephdadams/USBRelay\">https://github.com/josephdadams/USBRelay</a></li>\n<li>æ¨¡çµ„ç”± USB ä¾›é›»ï¼Œæ‹”æ‰å¾Œ relay ç‹€æ…‹æœƒé‡ç½®</li>\n</ul>\n",
            "tags": [
                "Node.js",
                "USB Relay"
            ]
        },
        {
            "id": "https://8loser.github.io/2024/11/08/gcp-mutual-tls/",
            "url": "https://8loser.github.io/2024/11/08/gcp-mutual-tls/",
            "title": "GCP mTLS(mutual TLS) æ†‘è­‰è¨­å®š",
            "date_published": "2024-11-08T15:38:07.000Z",
            "content_html": "<h1 id=\"ç·£ç”±\"><a class=\"anchor\" href=\"#ç·£ç”±\">#</a> ç·£ç”±</h1>\n<p>æœ‰ä¸€ç¶²ç«™éœ€è¦é™åˆ¶åªæœ‰ç‰¹å®šäººå“¡æ‰å¯ç€è¦½ï¼Œé€šå¸¸æœƒä½¿ç”¨ä¾†æº IP é€²è¡Œé™åˆ¶ï¼Œè‹¥æ˜¯ç„¡å›ºå®šè¾¦å…¬å®¤äººå“¡ï¼ˆæ¥­å‹™ï¼‰å‰‡ä½¿ç”¨ VPN é€£å…¥å…¬å¸ç¶²è·¯ç²å¾—å…è¨± IPã€‚</p>\n<p>ä½†å› ç‚ºå…¬å¸æ²’æœ‰è‡ªå·±çš„ç¶²è·¯ï¼Œæ‰€ä»¥æ²’è¾¦æ³•ä½¿ç”¨é€™å€‹æ–¹æ³•ï¼Œå› æ­¤æ¡ç”¨ mTLSã€‚</p>\n<p>ä¸€èˆ¬ç¶²ç«™æ†‘è­‰åªæ˜¯å–®å‘ç”¨æ–¼é©—è­‰ç¶²ç«™æ˜¯å¦åˆæ³•ï¼ŒmTLS å‰‡æ˜¯é›™å‘é©—è­‰ <span class=\"spoiler\" title=\"ä½ çŸ¥é“å¾—å¤ªå¤šäº†\">é›™å‘å¥”èµ´çš„æ†‘è­‰</span>ï¼Œé™¤äº†é©—è­‰ç¶²ç«™æ˜¯å¦åˆæ³•å¤–ï¼Œä¹Ÿé©—è­‰é€£æ¥ç«¯ (client, browser) æ˜¯å¦åˆæ³•ã€‚</p>\n<p>å®˜æ–¹æ–‡ä»¶å…¶å¯¦æœ‰æ•™å­¸ (<a href=\"https://cloud.google.com/load-balancing/docs/https/setting-up-mtls-ccm\">Set up mutual TLS with user-provided certificates</a>)ï¼Œä½†æ˜¯å®˜æ–¹æ–‡ä»¶éƒ½æ˜¯é€é gcloud è¨­å®šï¼Œæ‰€ä»¥é€™ç¯‡ç´€éŒ„ä¸€ä¸‹æ€éº¼ä½¿ç”¨ GUI æ–¹å¼è¨­å®šã€‚</p>\n<p>æ€è·¯ï¼šå¾ load balance ä¸‹æ‰‹ï¼Œåœ¨ load balance é€²è¡Œé©—è­‰ï¼Œclient åˆæ³•æ‰å°å…¥å¾Œç«¯ã€‚</p>\n<h1 id=\"éœ€æ±‚\"><a class=\"anchor\" href=\"#éœ€æ±‚\">#</a> éœ€æ±‚</h1>\n<p>å…ˆå®‰è£ openssl ç”¨æ–¼ç”¢ç”Ÿæ†‘è­‰</p>\n<h1 id=\"ç”¢ç”Ÿæ ¹æ†‘è­‰\"><a class=\"anchor\" href=\"#ç”¢ç”Ÿæ ¹æ†‘è­‰\">#</a> ç”¢ç”Ÿæ ¹æ†‘è­‰</h1>\n<h2 id=\"æ†‘è­‰è¨­å®šæª”\"><a class=\"anchor\" href=\"#æ†‘è­‰è¨­å®šæª”\">#</a> æ†‘è­‰è¨­å®šæª”</h2>\n<p>å»ºç«‹æ†‘è­‰è¨­å®šæª”  <code>example.cnf</code></p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>[req]</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>distinguished_name = empty_distinguished_name</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>[empty_distinguished_name]</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># Kept empty to allow setting via -subj command line arg.</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>[ca_exts]</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>basicConstraints=critical,CA:TRUE</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>keyUsage=keyCertSign</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>extendedKeyUsage=clientAuth</pre></td></tr></table></figure><h2 id=\"æ ¹æ†‘è­‰èˆ‡å¯†é‘°\"><a class=\"anchor\" href=\"#æ ¹æ†‘è­‰èˆ‡å¯†é‘°\">#</a> æ ¹æ†‘è­‰èˆ‡å¯†é‘°</h2>\n<p>ä½¿ç”¨ openssl ç”¢ç”Ÿæ ¹æ†‘è­‰å¯†é‘°  <code>root.key</code>  èˆ‡æ ¹æ†‘è­‰  <code>root.cert</code></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>openssl req <span class=\"token parameter variable\">-x509</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token parameter variable\">-new</span> <span class=\"token parameter variable\">-sha256</span> <span class=\"token parameter variable\">-newkey</span> rsa:2048 <span class=\"token parameter variable\">-nodes</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token parameter variable\">-days</span> <span class=\"token number\">3650</span> <span class=\"token parameter variable\">-subj</span> <span class=\"token string\">'/CN=root'</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token parameter variable\">-config</span> example.cnf <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token parameter variable\">-extensions</span> ca_exts <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token parameter variable\">-keyout</span> root.key <span class=\"token parameter variable\">-out</span> root.cert</pre></td></tr></table></figure><h1 id=\"ç”¢ç”Ÿä¸­ç¹¼æ†‘è­‰\"><a class=\"anchor\" href=\"#ç”¢ç”Ÿä¸­ç¹¼æ†‘è­‰\">#</a> ç”¢ç”Ÿä¸­ç¹¼æ†‘è­‰</h1>\n<h2 id=\"ä¸­ç¹¼æ†‘è­‰ç°½åè«‹æ±‚\"><a class=\"anchor\" href=\"#ä¸­ç¹¼æ†‘è­‰ç°½åè«‹æ±‚\">#</a> ä¸­ç¹¼æ†‘è­‰ç°½åè«‹æ±‚</h2>\n<p>ç”¢ç”Ÿä¸­ç¹¼æ†‘è­‰å¯†é‘°  <code>int.key</code>  è·Ÿä¸­ç¹¼æ†‘è­‰ç°½åè«‹æ±‚  <code>int.req</code></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>openssl req <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token parameter variable\">-new</span> <span class=\"token parameter variable\">-sha256</span> <span class=\"token parameter variable\">-newkey</span> rsa:2048 <span class=\"token parameter variable\">-nodes</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token parameter variable\">-subj</span> <span class=\"token string\">'/CN=int'</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token parameter variable\">-config</span> example.cnf <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token parameter variable\">-extensions</span> ca_exts <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token parameter variable\">-keyout</span> int.key <span class=\"token parameter variable\">-out</span> int.req</pre></td></tr></table></figure><h2 id=\"ä¸­ç¹¼æ†‘è­‰\"><a class=\"anchor\" href=\"#ä¸­ç¹¼æ†‘è­‰\">#</a> ä¸­ç¹¼æ†‘è­‰</h2>\n<p>ç”¢ç”Ÿä¸­ç¹¼æ†‘è­‰  <code>int.cert</code></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>openssl x509 <span class=\"token parameter variable\">-req</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token parameter variable\">-CAkey</span> root.key <span class=\"token parameter variable\">-CA</span> root.cert <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token parameter variable\">-set_serial</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token parameter variable\">-days</span> <span class=\"token number\">3650</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token parameter variable\">-extfile</span> example.cnf <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token parameter variable\">-extensions</span> ca_exts <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token parameter variable\">-in</span> int.req <span class=\"token parameter variable\">-out</span> int.cert</pre></td></tr></table></figure><h1 id=\"å»ºç«‹ä¿¡ä»»è¨­å®š\"><a class=\"anchor\" href=\"#å»ºç«‹ä¿¡ä»»è¨­å®š\">#</a> å»ºç«‹ä¿¡ä»»è¨­å®š</h1>\n<p>å¾ <a href=\"https://console.cloud.google.com/security/ccm/list/trustConfigs\">https://console.cloud.google.com/security/ccm/list/trustConfigs</a> å»ºç«‹ä¿¡ä»»è¨­å®š<br />\næŠŠå‰é¢æ­¥é©Ÿç”¢ç”Ÿçš„  <code>root.cert</code>  å…§å®¹å¢åŠ åˆ°ä¿¡ä»»éŒ¨é»ã€ <code>int.cert</code>  å…§å®¹å¢åŠ åˆ°ä¸­ç¹¼ CAã€‚</p>\n<p><img loading=\"lazy\" src=\"trust-config.jpg\" alt=\"ä¿¡ä»»è¨­å®š\" /></p>\n<h1 id=\"å»ºç«‹ç”¨æˆ¶ç«¯é©—è­‰\"><a class=\"anchor\" href=\"#å»ºç«‹ç”¨æˆ¶ç«¯é©—è­‰\">#</a> å»ºç«‹ç”¨æˆ¶ç«¯é©—è­‰</h1>\n<p>å¾ <a href=\"https://console.cloud.google.com/net-security/clientauth/serverTlsPolicies\">https://console.cloud.google.com/net-security/clientauth/serverTlsPolicies</a> å»ºç«‹ç”¨æˆ¶ç«¯é©—è­‰<br />\nç”¨æˆ¶ç«¯é©—è­‰æ¨¡å¼é¸æ“‡  <code>è² è¼‰å¹³è¡¡</code>  ä»¥åŠ  <code>æ‹’çµ•ç„¡æ•ˆçš„ç”¨æˆ¶æ†‘è­‰</code> ï¼Œä¿¡ä»»è¨­å®šé¸å–å‰ä¸€æ­¥é©Ÿå»ºç«‹çš„è¨­å®šæª”ã€‚<br />\n<img loading=\"lazy\" src=\"client-auth.jpg\" alt=\"ç”¨æˆ¶ç«¯é©—è­‰\" /></p>\n<h1 id=\"è² è¼‰å¹³è¡¡è¨­å®š\"><a class=\"anchor\" href=\"#è² è¼‰å¹³è¡¡è¨­å®š\">#</a> è² è¼‰å¹³è¡¡è¨­å®š</h1>\n<p><a href=\"https://console.cloud.google.com/net-services/loadbalancing/list/loadBalancers\">https://console.cloud.google.com/net-services/loadbalancing/list/loadBalancers</a><br />\n åœ¨è² è¼‰å¹³è¡¡çš„å‰ç«¯è¨­å®šè™•ï¼Œé¸å–å‰›å»ºç«‹çš„ç”¨æˆ¶ç«¯é©—è­‰ï¼Œå¯èƒ½ä¸æœƒé¦¬ä¸Šç”Ÿæ•ˆï¼Œå¦‚æœç”Ÿæ•ˆå¾Œé–‹å•Ÿç¶²å€æœƒæ˜¯  <code>ERR_CONNECTION_CLOSED</code>  çš„è¨Šæ¯ã€‚</p>\n<p><img loading=\"lazy\" src=\"load-balance.jpg\" alt=\"è² è¼‰å¹³è¡¡\" /></p>\n<h1 id=\"å»ºç«‹ç”¨æˆ¶ç«¯æ†‘è­‰\"><a class=\"anchor\" href=\"#å»ºç«‹ç”¨æˆ¶ç«¯æ†‘è­‰\">#</a> å»ºç«‹ç”¨æˆ¶ç«¯æ†‘è­‰</h1>\n<h2 id=\"ç”¨æˆ¶ç«¯è¨­å®šæª”\"><a class=\"anchor\" href=\"#ç”¨æˆ¶ç«¯è¨­å®šæª”\">#</a> ç”¨æˆ¶ç«¯è¨­å®šæª”</h2>\n<p>å»ºç«‹ç”¨æˆ¶ç«¯è¨­å®šæª”  <code>client.config</code></p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>[req]</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>default_bits              = 2048</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>req_extensions            = extension_requirements</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>distinguished_name        = dn_requirements</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>prompt                    = no</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>[extension_requirements]</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>basicConstraints          = critical, CA:FALSE</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>keyUsage                  = critical, nonRepudiation, digitalSignature, keyEncipherment</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>extendedKeyUsage          = clientAuth</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>[dn_requirements]</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>countryName               = US</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>stateOrProvinceName       = California</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>localityName              = San Francisco</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>0.organizationName        = example</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>organizationalUnitName    = test</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>commonName                = test.example.com</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>emailAddress              = test@example.com</pre></td></tr></table></figure><h2 id=\"ç”¢ç”Ÿç”¨æˆ¶å¯†é‘°èˆ‡ç°½åè«‹æ±‚\"><a class=\"anchor\" href=\"#ç”¢ç”Ÿç”¨æˆ¶å¯†é‘°èˆ‡ç°½åè«‹æ±‚\">#</a> ç”¢ç”Ÿç”¨æˆ¶å¯†é‘°èˆ‡ç°½åè«‹æ±‚</h2>\n<p>æœƒç”¢ç”Ÿ  <code>client.key</code> ,  <code>client.csr</code> ã€‚é€™é‚Šæœƒè©¢å•é‡‘é‘°å¯†ç¢¼ï¼Œå¾Œé¢åŒ¯å‡ºæ™‚æœƒç”¨åˆ°ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>openssl req <span class=\"token parameter variable\">-new</span> <span class=\"token parameter variable\">-keyout</span> client.key <span class=\"token parameter variable\">-out</span> client.csr <span class=\"token parameter variable\">-config</span> client.config</pre></td></tr></table></figure><h2 id=\"ç”¢ç”Ÿç”¨æˆ¶ç«¯æ†‘è­‰\"><a class=\"anchor\" href=\"#ç”¢ç”Ÿç”¨æˆ¶ç«¯æ†‘è­‰\">#</a> ç”¢ç”Ÿç”¨æˆ¶ç«¯æ†‘è­‰</h2>\n<p>ä½¿ç”¨  <code>int.cert</code> ã€ <code>int.key</code> ã€ <code>client.csr</code>  ç”¢ç”Ÿç”¨æˆ¶ç«¯æ†‘è­‰  <code>client.cert</code></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>openssl x509 <span class=\"token parameter variable\">-req</span> <span class=\"token parameter variable\">-in</span> client.csr <span class=\"token parameter variable\">-out</span> client.cert <span class=\"token parameter variable\">-extfile</span> client.config <span class=\"token parameter variable\">-extensions</span> extension_requirements <span class=\"token parameter variable\">-days</span> <span class=\"token number\">365</span> <span class=\"token parameter variable\">-CA</span> int.cert <span class=\"token parameter variable\">-CAkey</span> int.key</pre></td></tr></table></figure><p>æ¸¬è©¦</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-v</span> <span class=\"token parameter variable\">-k</span> <span class=\"token parameter variable\">--key</span> client.key <span class=\"token parameter variable\">--cert</span> client.cert https://ç¶²å€</pre></td></tr></table></figure><h1 id=\"ç€è¦½å™¨åŒ¯å…¥æ†‘è­‰\"><a class=\"anchor\" href=\"#ç€è¦½å™¨åŒ¯å…¥æ†‘è­‰\">#</a> ç€è¦½å™¨åŒ¯å…¥æ†‘è­‰</h1>\n<p>server ç«¯å¤§è‡´ä¸Šè¨­ç½®å®Œæˆï¼Œé‚„éœ€è¨­å®š client ç«¯ï¼Œclient åŒ¯å…¥æ†‘è­‰é€™é‚Šä½¿ç”¨  <code>PKCS #12</code>  æ ¼å¼ã€‚<br />\né¦–å…ˆå°‡  <code>client.key</code> ã€ <code>client.cert</code>  å°è£ã€‚æœƒç”¢ç”Ÿ  <code>client.p12</code> ã€‚<br />\né€™é‚Šæœƒè©¢å•å‰›å‰›ç”¢ç”Ÿ  <code>client.key</code>  æ™‚çš„é‡‘é‘°å¯†ç¢¼ï¼Œé©—è­‰å¾Œæœƒå†è©¢å•é‡‘é‘°åŒ¯å‡ºå¯†ç¢¼ï¼Œåœ¨åŒ¯å…¥æ™‚æœƒéœ€è¦ (å¯ä¸è¨­ç½®)ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>openssl pkcs12 <span class=\"token parameter variable\">-export</span> <span class=\"token parameter variable\">-inkey</span> client.key <span class=\"token parameter variable\">-in</span> client.cert <span class=\"token parameter variable\">-out</span> client.p12 <span class=\"token parameter variable\">-name</span> <span class=\"token string\">\"client-cert\"</span></pre></td></tr></table></figure><h2 id=\"æ†‘è­‰åŒ¯å…¥\"><a class=\"anchor\" href=\"#æ†‘è­‰åŒ¯å…¥\">#</a> æ†‘è­‰åŒ¯å…¥</h2>\n<p>åœ¨ Windowsã€Linux æ¡Œé¢ç’°å¢ƒå¤§è‡´ä¸Šéƒ½ç›´æ¥é»å…©ä¸‹  <code>client.p12</code>  å¾Œè¼¸å…¥åŒ¯å‡ºå¯†ç¢¼å³å¯ã€‚ä¹‹å¾Œå¯é–‹å•Ÿç€è¦½å™¨æŸ¥çœ‹ç¶²ç«™æ˜¯å¦å¯æ­£å¸¸ç€è¦½ã€‚</p>\n<p>macOS å¯èƒ½æœƒå‡ºç¾ä¸€ç›´è©¢å•å¯†ç¢¼ (åŒ¯å‡ºå¯†ç¢¼éŒ¯èª¤) çš„æƒ…æ³ï¼Œå¼·è€…æˆ‘åŒäº‹èªªæ˜¯å› ç‚º  <code>openssl</code>  ç‰ˆæœ¬å·®ç•°é—œä¿‚ï¼Œä½¿ç”¨èˆŠç‰ˆçš„  <code>openssl</code>  é‡æ–°åŒ¯å‡º p12 æ†‘è­‰å³å¯ã€‚</p>\n<p>macOS é‚„éœ€è¦å¾  <code>é‘°åŒ™åœˆ</code>  è¨­å®šæ†‘è­‰çš„å­˜å–æ¬Šé™ç‚ºä¸€å¾‹å…è¨±ï¼Œå¦å‰‡åœ¨ç€è¦½ç¶²ç«™çš„æ™‚å€™ï¼Œæœƒä¸€ç›´å‡ºç¾è©¢å•å¯†ç¢¼è«‹æ±‚å…è¨±çš„æƒ…æ³ã€‚</p>\n",
            "tags": [
                "Step By Step",
                "GCP",
                "mutual TLS",
                "æ†‘è­‰",
                "SSL"
            ]
        },
        {
            "id": "https://8loser.github.io/2024/06/17/dev-container-bind-source-error/",
            "url": "https://8loser.github.io/2024/06/17/dev-container-bind-source-error/",
            "title": "bind source path does not exist",
            "date_published": "2024-06-16T16:38:53.000Z",
            "content_html": "<h1 id=\"å•é¡Œæè¿°\"><a class=\"anchor\" href=\"#å•é¡Œæè¿°\">#</a> å•é¡Œæè¿°</h1>\n<p>DevContainer å•Ÿå‹• container éŒ¯èª¤ï¼ŒæŸ¥çœ‹éŒ¯èª¤è¨Šæ¯å¦‚ä¸‹<br />\n <code>Error response from daemon: invalid mount config for type &quot;bind&quot;: bind source path does not exist: /run/user/1000/wayland-0</code></p>\n<h1 id=\"ç’°å¢ƒ\"><a class=\"anchor\" href=\"#ç’°å¢ƒ\">#</a> ç’°å¢ƒ</h1>\n<ul>\n<li>OS: EndeavourOS</li>\n<li>åœ¨ VSCode ä½¿ç”¨ Dev Container å¥—ä»¶å•Ÿå‹• container</li>\n</ul>\n<h1 id=\"ä¿®æ­£æ–¹æ³•\"><a class=\"anchor\" href=\"#ä¿®æ­£æ–¹æ³•\">#</a> ä¿®æ­£æ–¹æ³•</h1>\n<p>åˆªé™¤ä¸‹é¢å…©å€‹æª”æ¡ˆ</p>\n<ul>\n<li>/run/user/1000/wayland-0</li>\n<li>/run/user/1000/wayland-0.lock</li>\n</ul>\n",
            "tags": [
                "Trouble",
                "VSCode",
                "Remote Container"
            ]
        },
        {
            "id": "https://8loser.github.io/2024/06/16/shokaX-waline-comment/",
            "url": "https://8loser.github.io/2024/06/16/shokaX-waline-comment/",
            "title": "Hexo ShokaX ä¸»é¡Œä½¿ç”¨ Waline ç•™è¨€ç‰ˆ",
            "date_published": "2024-06-15T17:17:17.000Z",
            "content_html": "<h1 id=\"ä½ˆç½²-waline-server-ç«¯\"><a class=\"anchor\" href=\"#ä½ˆç½²-waline-server-ç«¯\">#</a> ä½ˆç½² Waline server ç«¯</h1>\n<p>åƒè€ƒ Waline ä½ˆç½²æ•™å­¸ç¶²ç«™ <a href=\"https://waline.js.org/guide/deploy/vercel.html\">https://waline.js.org/guide/deploy/vercel.html</a> ï¼Œé»é¸ Deploy æŒ‰éˆ•ï¼Œæœƒè·³è½‰ Vercel é é¢å»ºç«‹ Waline serverã€‚</p>\n<p><img loading=\"lazy\" src=\"vercel-deploy.png\" alt=\"Vercel deploy\" /></p>\n<p>å¦‚æœä½¿ç”¨è©²æ–¹å¼ï¼Œåœ¨ Vercel å‡ºç¾ä¸‹é¢éŒ¯èª¤è¨Šæ¯ï¼Œæ”¹ç”¨é€™å€‹ <a href=\"https://vercel.com/new/austin-lees-projects/clone?repository-url=https%3A%2F%2Fgithub.com%2Fwalinejs%2Fwaline%2Ftree%2Fmain%2Fexample\">[Deploy]</a> è©¦è©¦</p>\n<div class=\"note danger\">\n<p>Error: No Output Directory named &quot;dist&quot; found after the Build completed. You can configure the Output Directory in your  Project Settings.</p>\n</div>\n<div class=\"note info\">\n<p>é™¤äº† Vercel ä½œç‚º Waline æœå‹™ä¹‹å¤–ï¼Œä¹Ÿæœ‰å…¶ä»–é¸æ“‡ <a href=\"https://waline.js.org/guide/get-started/server.html\">https://waline.js.org/guide/get-started/server.html</a></p>\n</div>\n<h1 id=\"å»ºç«‹-waline-ä½¿ç”¨çš„è³‡æ–™åº«\"><a class=\"anchor\" href=\"#å»ºç«‹-waline-ä½¿ç”¨çš„è³‡æ–™åº«\">#</a> å»ºç«‹ Waline ä½¿ç”¨çš„è³‡æ–™åº«</h1>\n<p>Waline éœ€è¦è³‡æ–™åº«å„²å­˜ç•™è¨€è³‡æ–™ï¼ŒWaline æ”¯æ´å¤šç¨®è³‡æ–™åº« <a href=\"https://waline.js.org/guide/database.html\">https://waline.js.org/guide/database.html</a> ã€‚<br />\nVercel ä¹Ÿæœ‰æä¾›è³‡æ–™åº«ï¼Œæ‰€ä»¥é€™é‚Šä½¿ç”¨ Vercel å…§å»ºçš„è³‡æ–™åº«æœå‹™ï¼Œå»ºç«‹ PostgreSQLã€‚</p>\n<p><img loading=\"lazy\" src=\"vercel-create-database.png\" alt=\"Create Database Step1\" /></p>\n<p><img loading=\"lazy\" src=\"vercel-create-postgres.png\" alt=\"Create Database Step2\" /></p>\n<div class=\"note info\">\n<p>éœ€è¦çš„è³‡æ–™è¡¨è«‹åƒè€ƒ<br />\n<a href=\"https://github.com/walinejs/waline/blob/main/assets/waline.pgsql\"> https://github.com/walinejs/waline/blob/main/assets/waline.pgsql</a></p>\n</div>\n<h1 id=\"å°‡-waline-æœå‹™èˆ‡è³‡æ–™åº«é€£æ¥\"><a class=\"anchor\" href=\"#å°‡-waline-æœå‹™èˆ‡è³‡æ–™åº«é€£æ¥\">#</a> å°‡ Waline æœå‹™èˆ‡è³‡æ–™åº«é€£æ¥</h1>\n<p>é€²å…¥ App<br />\n<img loading=\"lazy\" src=\"enter-waline-app.png\" alt=\"Enter Waline App\" /><br />\n é€£æ¥å‰›å‰›å»ºç«‹çš„ PostgreSQL<br />\n<img loading=\"lazy\" src=\"database-connect.png\" alt=\"Database connect\" /></p>\n<h1 id=\"è¨­å®š-waline-ç’°å¢ƒè®Šæ•¸\"><a class=\"anchor\" href=\"#è¨­å®š-waline-ç’°å¢ƒè®Šæ•¸\">#</a> è¨­å®š Waline ç’°å¢ƒè®Šæ•¸</h1>\n<p><img loading=\"lazy\" src=\"setting-environment-variable.png\" alt=\"Setting environment variable\" /></p>\n<p>å¦‚æœè³‡æ–™åº«é€£æ¥æˆåŠŸï¼Œæœƒçœ‹åˆ°ç´…æ¡†å…§çš„ç’°å¢ƒè®Šæ•¸ã€‚<br />\n<img loading=\"lazy\" src=\"waline-environment-variable.png\" alt=\"Connected Success Variable\" /></p>\n<p>ä½†é€™æ¨£é‚„ç„¡æ³•è®“ Waline server æˆåŠŸé€£æ¥è³‡æ–™åº«ï¼Œé‚„éœ€è¦è¨­å®šä¸‹é¢çš„ç’°å¢ƒè®Šæ•¸</p>\n<ul>\n<li>PG_SSL\n<ul>\n<li>è¨­ç‚º true</li>\n</ul>\n</li>\n<li>PG_PORT\n<ul>\n<li>è¨­ç‚º 5432</li>\n</ul>\n</li>\n</ul>\n<div class=\"note info\">\n<p>Waline å¯è¨­å®šçš„ PostgreSQL ç’°å¢ƒè®Šæ•¸<br />\n<a href=\"https://waline.js.org/guide/database.html#postgresql\"> https://waline.js.org/guide/database.html#postgresql</a></p>\n</div>\n<h1 id=\"æ¸¬è©¦-waline-åŠŸèƒ½\"><a class=\"anchor\" href=\"#æ¸¬è©¦-waline-åŠŸèƒ½\">#</a> æ¸¬è©¦ Waline åŠŸèƒ½</h1>\n<p>é€²å…¥ Waline project æŸ¥çœ‹ Waline ç•™è¨€é é¢ã€‚</p>\n<p><img loading=\"lazy\" src=\"app-visit-test.png\" alt=\"Visit Waline app\" /></p>\n<p>å¦‚æœæ­£å¸¸çš„è©±æœƒçœ‹åˆ°å¦‚ä¸‹ç•«é¢ï¼Œå¯ä»¥ç•™è¨€æ¸¬è©¦çœ‹çœ‹æ˜¯å¦æˆåŠŸã€‚</p>\n<p><img loading=\"lazy\" src=\"waline-comment-page.png\" alt=\"Waline comment page\" /></p>\n<h1 id=\"è¨­å®š-shokax\"><a class=\"anchor\" href=\"#è¨­å®š-shokax\">#</a> è¨­å®š ShokaX</h1>\n<p>ä¿®æ”¹ Hexo ShokaX è¨­å®šæª”ï¼›Hexo è³‡æ–™å¤¾  <code>/_config.shokax.yml</code>  æˆ–  <code>/_config.shokaX.yml</code></p>\n<p>å¢åŠ ä¸‹é¢è¨­å®š</p>\n<figure class=\"highlight yml\"><figcaption data-lang=\"YAML\"><span>_config.shokax.yml</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">waline</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token key atrule\">enable</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span> <span class=\"token comment\"># å•Ÿç”¨ç‹€æ…‹</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token key atrule\">serverURL</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"https://waline-three-wine.vercel.app\"</span> <span class=\"token comment\"># Waline server ç¶²å€ï¼Œå¾ Vercel Project æŸ¥çœ‹ domain</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token key atrule\">lang</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"zh-TW\"</span> <span class=\"token comment\"># comment ç•Œé¢èªè¨€</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token key atrule\">meta</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># comment å¯å¡«å¯«é …ç›®</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">-</span> nick</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">-</span> mail</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token key atrule\">requiredMeta</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># comment å¿…å¡«é …ç›®</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">-</span> nick</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">-</span> mail</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  <span class=\"token key atrule\">wordLimit</span><span class=\"token punctuation\">:</span> <span class=\"token number\">400</span> <span class=\"token comment\"># comment å­—æ•¸ä¸Šé™</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>  <span class=\"token key atrule\">pageSize</span><span class=\"token punctuation\">:</span> <span class=\"token number\">10</span> <span class=\"token comment\"># æ¯é é¡¯ç¤ºç­†æ•¸</span></pre></td></tr></table></figure><div class=\"note info\">\n<p>Hexo ShokaX çš„ Waline å…¶ä»–è¨­å®šé …ç›®<br />\n<a href=\"https://docs.kaitaku.xyz/guide/comment.html#valine-%E7%B3%BB%E8%AF%84%E8%AE%BA%E7%B3%BB%E7%BB%9F\"> https://docs.kaitaku.xyz/guide/comment.html#valine - ç³»è¯„è®ºç³»ç»Ÿ</a></p>\n</div>\n<h1 id=\"ä½¿ç”¨ç´€éŒ„\"><a class=\"anchor\" href=\"#ä½¿ç”¨ç´€éŒ„\">#</a> ä½¿ç”¨ç´€éŒ„</h1>\n<h2 id=\"202406\"><a class=\"anchor\" href=\"#202406\">#</a> 2024/06</h2>\n<ul>\n<li>meta è¨­å®šç„¡æ•ˆï¼Œåªè¨­å®š nick, mail ä½†æ˜¯ç•Œé¢ä¸Šé‚„æ˜¯æœƒé¡¯ç¤ºç¶²å€æ¬„ä½</li>\n<li><code>æœ€æ–°è©•è«–</code>  é¡¯ç¤º emoji ç„¡æ•ˆï¼Œæœƒè®Šæˆ HTML</li>\n</ul>\n",
            "tags": [
                "Step By Step",
                "Hexo theme",
                "Waline"
            ]
        },
        {
            "id": "https://8loser.github.io/2023/10/30/spawn-node-gyp-ENOENT/",
            "url": "https://8loser.github.io/2023/10/30/spawn-node-gyp-ENOENT/",
            "title": "spawn node-gyp ENOENT",
            "date_published": "2023-10-29T17:04:26.000Z",
            "content_html": "<h1 id=\"å•é¡Œæè¿°\"><a class=\"anchor\" href=\"#å•é¡Œæè¿°\">#</a> å•é¡Œæè¿°</h1>\n<p>è¦æŠŠ theme è½‰ç‚º <a href=\"https://docs.kaitaku.xyz/\">shokaX</a> æ™‚ï¼ŒåŸ·è¡Œ  <code>SXC install shokaX</code>  å‡ºç¾éŒ¯èª¤è¨Šæ¯</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>error /workspaces/page/node_modules/deasync: Command failed.</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Exit code: <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Command: <span class=\"token function\">node</span> ./build.js</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>Arguments: </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>Directory: /workspaces/page/node_modules/deasync</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>Output:</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>node:events:495</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      throw er<span class=\"token punctuation\">;</span> // Unhandled <span class=\"token string\">'error'</span> event</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      ^</pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>Error: spawn node-gyp ENOENT</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    at ChildProcess._handle.onexit <span class=\"token punctuation\">(</span>node:internal/child_process:284:19<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    at onErrorNT <span class=\"token punctuation\">(</span>node:internal/child_process:477:16<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    at process.processTicksAndRejections <span class=\"token punctuation\">(</span>node:internal/process/task_queues:82:21<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>Emitted <span class=\"token string\">'error'</span> event on ChildProcess instance at:</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    at ChildProcess._handle.onexit <span class=\"token punctuation\">(</span>node:internal/child_process:290:12<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    at onErrorNT <span class=\"token punctuation\">(</span>node:internal/child_process:477:16<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    at process.processTicksAndRejections <span class=\"token punctuation\">(</span>node:internal/process/task_queues:82:21<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  errno: -2,</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>  code: <span class=\"token string\">'ENOENT'</span>,</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>  syscall: <span class=\"token string\">'spawn node-gyp'</span>,</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>  path: <span class=\"token string\">'node-gyp'</span>,</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>  spawnargs: <span class=\"token punctuation\">[</span> <span class=\"token string\">'rebuild'</span> <span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>Node.js v18.18.2</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>info Visit https://yarnpkg.com/en/docs/cli/add <span class=\"token keyword\">for</span> documentation about this command.</pre></td></tr></table></figure><h1 id=\"ç’°å¢ƒ\"><a class=\"anchor\" href=\"#ç’°å¢ƒ\">#</a> ç’°å¢ƒ</h1>\n<ul>\n<li>Docker image: node:18-slim</li>\n</ul>\n<h1 id=\"ä¿®æ­£æ–¹æ³•\"><a class=\"anchor\" href=\"#ä¿®æ­£æ–¹æ³•\">#</a> ä¿®æ­£æ–¹æ³•</h1>\n<p>å®‰è£ä¸‹é¢å¥—ä»¶ï¼Œä¸ç¢ºå®š  <code>make</code> ,  <code>g++</code>  éœ€ä¸éœ€è¦ï¼Œå› ç‚ºä¹‹å‰é‡éé¡ä¼¼çš„å•é¡Œéƒ½è£é€™ä¸‰å€‹ï¼Œæ‰€ä»¥ç›´æ¥è¤‡è£½éä¾†ç”¨ã€‚å¦‚æœæ²’æœ‰å®‰è£çš„è©±ï¼Œåœ¨å®‰è£  <code>node-gyp</code>  æœƒå‡ºç¾å…¶ä»–éŒ¯èª¤ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> <span class=\"token parameter variable\">-y</span> python3 <span class=\"token function\">make</span> g++</pre></td></tr></table></figure><p>å®‰è£  <code>node-gyp</code></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">pnpm</span> <span class=\"token function\">add</span> <span class=\"token parameter variable\">-g</span> node-gyp</pre></td></tr></table></figure>",
            "tags": [
                "Trouble",
                "Docker",
                "Hexo",
                "Shoka",
                "Node.js"
            ]
        },
        {
            "id": "https://8loser.github.io/2023/08/27/static-web-page-refresh-404/",
            "url": "https://8loser.github.io/2023/08/27/static-web-page-refresh-404/",
            "title": "éœæ…‹ç¶²é  refresh å‡ºç¾ 404",
            "date_published": "2023-08-26T16:40:55.000Z",
            "content_html": "<h1 id=\"trouble\"><a class=\"anchor\" href=\"#trouble\">#</a> Trouble</h1>\n<p>Vue é–‹ç™¼ç¶²é æ‰“åŒ…æˆéœæ…‹ç¶²é æª”æ¡ˆï¼Œä½¿ç”¨ docker compose çµåˆ nginx ä½ˆç½²ï¼Œç¶²é åˆ‡æ›åˆ°æœ‰è·¯å¾‘çš„é é¢å¾ŒæŒ‰ F5 é‡æ–°æ•´ç†é é¢æœƒå‡ºç¾ 404 éŒ¯èª¤ ã€‚</p>\n<p>éœæ…‹é é¢æ‰“åŒ…å¾Œæœ‰å†ç”¨ <a href=\"https://acme.com/software/thttpd/\">thttpd</a> ä½œç‚º web æœå‹™ä¸¦æ‰“åŒ…æˆ container æ–¹ä¾¿ä½ˆç½²ï¼Œå¯¦éš›éŒ¯èª¤æƒ…æ³å¦‚ä¸‹åœ–ï¼Œå¦‚æœä¸åŒçš„ web æœå‹™æœƒæœ‰ä¸åŒç•«é¢ã€‚</p>\n<p><img loading=\"lazy\" src=\"404-not-found.png\" alt=\"404 Not Found\" /></p>\n<h1 id=\"docker-composeyml\"><a class=\"anchor\" href=\"#docker-composeyml\">#</a> Docker-compose.yml</h1>\n<p>æœ‰ä¿®æ”¹éçš„å…§å®¹ï¼Œå¯¦éš›ä¸åªæœ‰å…©å€‹ container</p>\n<figure class=\"highlight dockerfile\"><figcaption data-lang=\"Docker\"><span>docker-compose.yml</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>services:</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  nginx:</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    image: nginx</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    restart: unless-stopped</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    volumes:</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      <span class=\"token comment\"># nginx è¨­å®šæª”</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      - ./nginx.conf:/etc/nginx/conf.d/default.conf</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      - ./robots.txt.test:/usr/share/nginx/html/robots.txt</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    environment:</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      TZ: Asia/Taipei</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    ports:</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      - target: 80</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        published: 80</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        protocol: tcp</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        mode: host</pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  <span class=\"token comment\"># å‰ç«¯ web service</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  branded:</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    image: ***é¦¬è³½å…‹***</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    restart: unless-stopped</pre></td></tr></table></figure><h1 id=\"nginxconf\"><a class=\"anchor\" href=\"#nginxconf\">#</a> Nginx.conf</h1>\n<figure class=\"highlight nginx\"><figcaption data-lang=\"nginx\"><span>nginx.conf</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token directive\"><span class=\"token keyword\">server</span></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token directive\"><span class=\"token keyword\">listen</span> <span class=\"token number\">80</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token directive\"><span class=\"token keyword\">server_name</span> <span class=\"token string\">\"\"</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token comment\"># LB Public IP address</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token directive\"><span class=\"token keyword\">set_real_ip_from</span> ***é¦¬è³½å…‹***</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token directive\"><span class=\"token keyword\">set_real_ip_from</span> 130.211.0.0/22</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token directive\"><span class=\"token keyword\">set_real_ip_from</span> 35.191.0.0/16</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token directive\"><span class=\"token keyword\">real_ip_header</span> X-Forwarded-For</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  <span class=\"token directive\"><span class=\"token keyword\">real_ip_recursive</span> <span class=\"token boolean\">on</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>  <span class=\"token comment\"># é˜»æ“‹çš„ User Agent</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  <span class=\"token directive\"><span class=\"token keyword\">if</span> (<span class=\"token variable\">$http_user_agent</span> ~* ***ä¸è¦å‘Šè¨´æ³¥*** )</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  <span class=\"token punctuation\">&#123;</span>return <span class=\"token directive\"><span class=\"token keyword\">101</span></span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  <span class=\"token directive\"><span class=\"token keyword\">location</span> /robots.txt</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token directive\"><span class=\"token keyword\">alias</span> /usr/share/nginx/html/robots.txt</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>  <span class=\"token directive\"><span class=\"token keyword\">location</span> /healthcheck</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token directive\"><span class=\"token keyword\">access_log</span> <span class=\"token boolean\">off</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token directive\"><span class=\"token keyword\">return</span> <span class=\"token number\">200</span> <span class=\"token string\">'ok'</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>  <span class=\"token comment\"># å‰ç«¯</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>  <span class=\"token directive\"><span class=\"token keyword\">location</span> /</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token directive\"><span class=\"token keyword\">proxy_pass</span> http://branded/</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token directive\"><span class=\"token keyword\">proxy_set_header</span> Host <span class=\"token variable\">$host</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token directive\"><span class=\"token keyword\">proxy_set_header</span> X-Real-IP <span class=\"token variable\">$remote_addr</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token directive\"><span class=\"token keyword\">proxy_set_header</span> X-Forwarded-For <span class=\"token variable\">$proxy_add_x_forwarded_for</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token directive\"><span class=\"token keyword\">proxy_set_header</span> X-Custom-Referrer smc_identity_layer</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h1 id=\"solution\"><a class=\"anchor\" href=\"#solution\">#</a> Solution</h1>\n<p>åœ¨ nginx.conf åŠ ä¸Š</p>\n<pre><code>proxy_intercept_errors on;\nerror_page 404 /index.html;\n</code></pre>\n<figure class=\"highlight nginx\"><figcaption data-lang=\"nginx\"><span>nginx.conf</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># å‰ç«¯</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token directive\"><span class=\"token keyword\">location</span> /</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token directive\"><span class=\"token keyword\">proxy_pass</span> http://branded/</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token directive\"><span class=\"token keyword\">proxy_set_header</span> Host <span class=\"token variable\">$host</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token directive\"><span class=\"token keyword\">proxy_set_header</span> X-Real-IP <span class=\"token variable\">$remote_addr</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token directive\"><span class=\"token keyword\">proxy_set_header</span> X-Forwarded-For <span class=\"token variable\">$proxy_add_x_forwarded_for</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token directive\"><span class=\"token keyword\">proxy_set_header</span> X-Custom-Referrer smc_identity_layer</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token comment\"># é«˜æƒ…å•† (?) åŠ ä¸‹é¢é€™å…©è¡Œ</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token directive\"><span class=\"token keyword\">proxy_intercept_errors</span> <span class=\"token boolean\">on</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token directive\"><span class=\"token keyword\">error_page</span> <span class=\"token number\">404</span> /index.html</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure>",
            "tags": [
                "Trouble",
                "Deploy",
                "Nginx",
                "static web page",
                "Docker Compose"
            ]
        },
        {
            "id": "https://8loser.github.io/2023/07/14/fixing-mixed-content/",
            "url": "https://8loser.github.io/2023/07/14/fixing-mixed-content/",
            "title": "ç€è¦½å™¨å‡ºç¾ Mixed Content è¨Šæ¯",
            "date_published": "2023-07-14T11:25:05.000Z",
            "content_html": "<p>Chrome Console å‡ºç¾  <code>Mixed Content</code>  è¨Šæ¯</p>\n<pre><code>Mixed Content: The page at 'https://www.***.com/' was loaded over HTTPS, but requested an insecure XMLHttpRequest endpoint 'http://192.168.10.200:3000/'. \nThis request has been blocked; the content must be served over HTTPS.\n</code></pre>\n<p>å‡ºç¾è©²è¨Šæ¯æ˜¯å› ç‚ºåœ¨ https é é¢å…§ï¼Œå‘¼å« http å”å®šçš„ APIï¼ŒåŸºæ–¼å®‰å…¨å•é¡Œï¼Œç€è¦½å™¨æœƒå°é–è©²è«‹æ±‚ã€‚è§£æ±ºæ–¹å¼æ˜¯æŠŠ API æ›æˆ https å³å¯ï¼Œä½†é€™å€‹ API æ˜¯æˆ‘å€‘æ”¾åœ¨å®¢æˆ¶ç«¯å­˜å–å®¢æˆ¶å…§éƒ¨ç¶²è·¯çš„ serviceï¼Œè®“å®¢æˆ¶åœ¨æˆ‘å€‘ç¶²ç«™é€éå‘¼å«è©² service å­˜å–ä»–å€‘å…§ç¶²è³‡æ–™ã€‚</p>\n<p>å¦‚æœè¦ç‚ºäº†é€™å€‹ service å»ºç«‹åŸŸåã€ç”³è«‹ SSL æ†‘è­‰æœ‰é»éº»ç…©ï¼ˆæˆ‘å°±æ‡¶ï¼‰ï¼Œæ‰€ä»¥è«‹å®¢æˆ¶èª¿æ•´ç€è¦½å™¨è¨­å®šï¼Œå…è¨±ä¸å®‰å…¨å…§å®¹ã€‚</p>\n<p><img loading=\"lazy\" src=\"allow-insecure-content.png\" alt=\"Allow insecure conten\" /></p>\n<h1 id=\"ç›¸é—œåƒè€ƒ\"><a class=\"anchor\" href=\"#ç›¸é—œåƒè€ƒ\">#</a> ç›¸é—œåƒè€ƒ</h1>\n<ul>\n<li>\n<p><a href=\"https://support.google.com/chrome/answer/114662?hl=zh-Hant&amp;co=GENIE.Platform%3DDesktop#zippy=%2C%E7%9E%AD%E8%A7%A3%E5%8F%AF%E8%AE%8A%E6%9B%B4%E7%9A%84%E6%AC%8A%E9%99%90\">è®Šæ›´ç¶²ç«™è¨­å®šæ¬Šé™</a></p>\n</li>\n<li>\n<p><a href=\"https://developer.mozilla.org/zh-TW/docs/Web/Security/Mixed_content\">æ··åˆå…§å®¹</a></p>\n</li>\n</ul>\n",
            "tags": [
                "Trouble",
                "Mixed Content",
                "Browser"
            ]
        },
        {
            "id": "https://8loser.github.io/2023/05/28/yay-is-corrupted/",
            "url": "https://8loser.github.io/2023/05/28/yay-is-corrupted/",
            "title": "yay æ›´æ–°é¡¯ç¤ºæª”æ¡ˆæ¯€æ",
            "date_published": "2023-05-28T10:03:54.000Z",
            "content_html": "<h1 id=\"å•é¡Œæè¿°\"><a class=\"anchor\" href=\"#å•é¡Œæè¿°\">#</a> å•é¡Œæè¿°</h1>\n<p>EndeavourOS æ›´æ–°æ™‚å‡ºç¾éŒ¯èª¤è¨Šæ¯ï¼Œä¸”æ¯æ¬¡æ›´æ–°æ™‚éƒ½å‡ºç¾ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>:: é€²è¡Œå®‰è£å—ï¼Ÿ <span class=\"token punctuation\">[</span>Y/n<span class=\"token punctuation\">]</span> </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>:: æ­£åœ¨æ¥æ”¶è»Ÿé«”åŒ…â€¦</pre></td></tr><tr><td data-num=\"3\"></td><td><pre> libusbmuxd-2.0.2-3-x86_64            <span class=\"token number\">31.8</span> KiB   <span class=\"token number\">529</span> KiB/s 00:00 <span class=\"token punctuation\">[</span>------------------------------------<span class=\"token punctuation\">]</span> <span class=\"token number\">100</span>%</pre></td></tr><tr><td data-num=\"4\"></td><td><pre> libplist-2.3.0-2-x86_64             <span class=\"token number\">140.7</span> KiB  <span class=\"token number\">1315</span> KiB/s 00:00 <span class=\"token punctuation\">[</span>------------------------------------<span class=\"token punctuation\">]</span> <span class=\"token number\">100</span>%</pre></td></tr><tr><td data-num=\"5\"></td><td><pre> libimobiledevice-1.3.0-9-x86_64     <span class=\"token number\">481.5</span> KiB  <span class=\"token number\">2.35</span> MiB/s 00:00 <span class=\"token punctuation\">[</span>------------------------------------<span class=\"token punctuation\">]</span> <span class=\"token number\">100</span>%</pre></td></tr><tr><td data-num=\"6\"></td><td><pre> yay-12.0.5-1-x86_64                   <span class=\"token number\">3.0</span> MiB  <span class=\"token number\">2.69</span> MiB/s 00:01 <span class=\"token punctuation\">[</span>------------------------------------<span class=\"token punctuation\">]</span> <span class=\"token number\">100</span>%</pre></td></tr><tr><td data-num=\"7\"></td><td><pre> ç¸½å…± <span class=\"token punctuation\">(</span><span class=\"token number\">4</span>/4<span class=\"token punctuation\">)</span>                            <span class=\"token number\">3.7</span> MiB  <span class=\"token number\">3.23</span> MiB/s 00:01 <span class=\"token punctuation\">[</span>------------------------------------<span class=\"token punctuation\">]</span> <span class=\"token number\">100</span>%</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token number\">78</span>/78<span class=\"token punctuation\">)</span> æ­£åœ¨æª¢æŸ¥é‘°åŒ™åœˆä¸­çš„é‘°åŒ™                                   <span class=\"token punctuation\">[</span>------------------------------------<span class=\"token punctuation\">]</span> <span class=\"token number\">100</span>%</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token number\">78</span>/78<span class=\"token punctuation\">)</span> æ­£åœ¨æª¢æŸ¥è»Ÿé«”åŒ…å®Œæ•´æ€§                                     <span class=\"token punctuation\">[</span>------------------------------------<span class=\"token punctuation\">]</span> <span class=\"token number\">100</span>%</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>éŒ¯èª¤ï¼šyayï¼šä¾†è‡ª manuel <span class=\"token operator\">&lt;</span>manuel@endeavouros.com<span class=\"token operator\">></span> çš„ç°½ç« ä¿¡ä»»ç­‰ç´šä¸æ˜::  /var/cache/pacman/pkg/yay-12.0.5-1-x86_64.pkg.tar.zst æª”æ¡ˆæ¯€æ<span class=\"token punctuation\">(</span>å¥—ä»¶ä¸æ­£ç¢ºæˆ–ææ¯€ï¼ˆPGP ç°½ç« ï¼‰<span class=\"token punctuation\">)</span>ã€‚ä½ è¦åˆªé™¤å®ƒå—? <span class=\"token punctuation\">[</span>Y/n<span class=\"token punctuation\">]</span> </pre></td></tr><tr><td data-num=\"11\"></td><td><pre>éŒ¯èª¤ï¼šç„¡æ³•æäº¤è™•ç† <span class=\"token punctuation\">(</span>å¥—ä»¶ä¸æ­£ç¢ºæˆ–ææ¯€ï¼ˆPGP ç°½ç« ï¼‰<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>ç™¼ç”ŸéŒ¯èª¤ï¼Œæ²’æœ‰è»Ÿé«”åŒ…è¢«æ›´æ–°ã€‚</pre></td></tr></table></figure><h1 id=\"ä¿®æ­£\"><a class=\"anchor\" href=\"#ä¿®æ­£\">#</a> ä¿®æ­£</h1>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> pacman <span class=\"token parameter variable\">-Sy</span> archlinux-keyring endeavouros-keyring</pre></td></tr></table></figure><p>ä¿®æ­£å¾ŒåŸ·è¡Œ  <code>yay -Syu</code>  å¯æ­£å¸¸æ›´æ–°äº†ã€‚</p>\n",
            "tags": [
                "Trouble",
                "EndeavourOS",
                "Linux"
            ]
        },
        {
            "id": "https://8loser.github.io/2023/05/06/dbeaver-backup-start-unavailable/",
            "url": "https://8loser.github.io/2023/05/06/dbeaver-backup-start-unavailable/",
            "title": "DBeaver backup start æŒ‰éˆ•æ²’æœ‰ä½œç”¨",
            "date_published": "2023-05-06T14:57:59.000Z",
            "content_html": "<h1 id=\"å•é¡Œæè¿°\"><a class=\"anchor\" href=\"#å•é¡Œæè¿°\">#</a> å•é¡Œæè¿°</h1>\n<p>åœ¨ Linux å…§ DBeaver backup  <code>Start</code>  æŒ‰éˆ•ç„¡æ³•é»é¸ï¼Œä¹Ÿç„¡æ³•  <code>Next</code></p>\n<p><img loading=\"lazy\" src=\"start-unavailable.png\" alt=\"start unavailable\" /></p>\n<h1 id=\"ç’°å¢ƒ\"><a class=\"anchor\" href=\"#ç’°å¢ƒ\">#</a> ç’°å¢ƒ</h1>\n<ul>\n<li>OS: EndeavourOS, BUILD_ID=2023.03.06</li>\n<li>DBeaver\tCommunity 23.0.3</li>\n<li>Database: é›²ç«¯ PostgreSQL</li>\n</ul>\n<h1 id=\"ä¿®æ­£æ–¹æ³•\"><a class=\"anchor\" href=\"#ä¿®æ­£æ–¹æ³•\">#</a> ä¿®æ­£æ–¹æ³•</h1>\n<h2 id=\"å®‰è£-postgresql\"><a class=\"anchor\" href=\"#å®‰è£-postgresql\">#</a> å®‰è£ PostgreSQL</h2>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> pacman <span class=\"token parameter variable\">-S</span> postgresql</pre></td></tr></table></figure><h2 id=\"æŸ¥çœ‹-pg_dump-ä½ç½®\"><a class=\"anchor\" href=\"#æŸ¥çœ‹-pg_dump-ä½ç½®\">#</a> æŸ¥çœ‹ pg_dump ä½ç½®</h2>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ <span class=\"token function\">whereis</span> pg_dump</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>pg_dump: /usr/bin/pg_dump /usr/share/man/man1/pg_dump.1.gz</pre></td></tr></table></figure><p>çŸ¥é“  <code>pg_dump</code>  ç¨‹å¼ä½ç½®åœ¨  <code>/usr/bin/</code></p>\n<h2 id=\"dbeaver-è¨­å®š-driver\"><a class=\"anchor\" href=\"#dbeaver-è¨­å®š-driver\">#</a> DBeaver è¨­å®š Driver</h2>\n<p>å¾ DBeaver é¸å–®é–‹å•Ÿ Database/Driver Managerï¼Œé»é¸ PostgreSQL æŒ‰  <code>Edit</code> <br />\n<img loading=\"lazy\" src=\"driver-manager.png\" alt=\"Driver Manager\" /></p>\n<p>é¸å–  <code>Native Client</code> / <code>Add Home</code></p>\n<p><img loading=\"lazy\" src=\"native-client.png\" alt=\"Native Client\" /></p>\n<p>è¨­å®š Home ç‚º  <code>/usr/bin/</code></p>\n<p><img loading=\"lazy\" src=\"add-home.png\" alt=\"Add Home\" /></p>\n<h1 id=\"æ¸¬è©¦\"><a class=\"anchor\" href=\"#æ¸¬è©¦\">#</a> æ¸¬è©¦</h1>\n<p><code>Next</code>  å¯ä»¥é»é¸äº†<br />\n<img loading=\"lazy\" src=\"backup-next.png\" alt=\"Backup Next\" /></p>\n<p>é»é¸  <code>Next</code>  å¾Œï¼Œé¸å–å‚™ä»½è·¯å¾‘æŒ‰  <code>Start</code>  å°±å¯ä»¥å‚™ä»½äº†<br />\n<img loading=\"lazy\" src=\"backup-start.png\" alt=\"Backup Start\" /></p>\n",
            "tags": [
                "Trouble",
                "Linux",
                "DBeaver"
            ]
        },
        {
            "id": "https://8loser.github.io/2023/03/12/reduce-frontend-docker-image/",
            "url": "https://8loser.github.io/2023/03/12/reduce-frontend-docker-image/",
            "title": "ç¸®æ¸›éœæ…‹ç¶²é  Docker image å¤§å°",
            "date_published": "2023-03-12T13:59:19.000Z",
            "content_html": "<h1 id=\"å‰è¨€\"><a class=\"anchor\" href=\"#å‰è¨€\">#</a> å‰è¨€</h1>\n<p>é€šå¸¸ Vue éƒ¨å±¬éƒ½æ˜¯å…ˆæ‰“åŒ…æˆéœæ…‹ç¶²é å†éƒ¨å±¬åˆ° web æœå‹™å™¨ä¸Šï¼Œä½†å¦‚æ­¤ç„¡æ³•åšåˆ°ç¨‹å¼ç¢¼ä¸Šå‚³ç‰ˆæ§å¾Œè‡ªå‹•éƒ¨ç½²ï¼Œå› ç‚ºä¸Šå‚³çš„æ˜¯åŸå§‹ç¢¼ï¼Œä¸æ˜¯æ‰“åŒ…å¾Œçš„éœæ…‹ç¶²é ã€‚</p>\n<p>æ‰€ä»¥ Vue æ­é… Docker æ™‚ï¼Œæœ‰ç¨®ä½œæ³•æ˜¯æŠŠåŸå§‹ç¢¼ç›´æ¥ç›´æ¥ build æˆåŸ·è¡Œ  <code>npm run dev</code>  çš„ docker image å¾Œæ”¾åœ¨ server åŸ·è¡Œã€‚</p>\n<p><img loading=\"lazy\" src=\"jsut-do-it.jpg\" alt=\"\" /></p>\n<div class=\"note danger\">\n<p>é€™ç¨®ä½œæ³•ç”¢ç”Ÿçš„ docker image å¾ˆå¤§ï¼Œæ‰è²»é‚„ç”¨ Vue</p>\n</div>\n<h1 id=\"ç¸®æ¸›æ–¹å¼\"><a class=\"anchor\" href=\"#ç¸®æ¸›æ–¹å¼\">#</a> ç¸®æ¸›æ–¹å¼</h1>\n<p>ä½¿ç”¨ <a href=\"https://docs.docker.com/build/building/multi-stage/\">Multi-stage builds</a>ï¼Œåœ¨ç¬¬ä¸€å€‹ stage build å‡ºéœæ…‹ç¶²é ï¼Œè¤‡è£½åˆ°ç¬¬äºŒå€‹ stage è·Ÿ web service æ‰“åŒ…æˆ imageã€‚</p>\n<p>å‡è¨­åŸæœ¬ Dockerfiler å¦‚ä¸‹</p>\n<figure class=\"highlight dockerfile\"><figcaption data-lang=\"Docker\"><span>fat Dockerfile</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token instruction\"><span class=\"token keyword\">FROM</span> node:18-slim</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token instruction\"><span class=\"token keyword\">COPY</span> . .</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token instruction\"><span class=\"token keyword\">RUN</span> npm install --production=false</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token instruction\"><span class=\"token keyword\">EXPOSE</span> 5173</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token instruction\"><span class=\"token keyword\">CMD</span> [<span class=\"token string\">\"npm\"</span>,<span class=\"token string\">\"run\"</span>,<span class=\"token string\">\"dev\"</span>]</span></pre></td></tr></table></figure><p>åŠ ä¸Šç¬¬äºŒå€‹ stageï¼Œä¸¦ä¸”ä½¿ç”¨ <a href=\"https://acme.com/software/thttpd/\">thttpd</a> ä½œç‚ºéœæ…‹ç¶²é çš„ web service</p>\n<figure class=\"highlight dockerfile\"><figcaption data-lang=\"Docker\"><span>slim Dockerfile</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># ç¬¬ä¸€å€‹ stage</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token instruction\"><span class=\"token keyword\">FROM</span> node:18-slim <span class=\"token keyword\">AS</span> builder</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token instruction\"><span class=\"token keyword\">COPY</span> . .</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token instruction\"><span class=\"token keyword\">RUN</span> npm install --production=false</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># build static html æª”æ¡ˆï¼Œæª”æ¡ˆæœƒç”¢ç”Ÿåœ¨ /dist å…§</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token instruction\"><span class=\"token keyword\">RUN</span> npm run build</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\"># ç¬¬äºŒå€‹ stage</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token instruction\"><span class=\"token keyword\">FROM</span> alpine</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\"># å®‰è£ thttpd</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token instruction\"><span class=\"token keyword\">RUN</span> apk update &amp;&amp; apk upgrade &amp;&amp; apk add --no-cache thttpd</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\"># è¤‡è£½ç¬¬ä¸€å€‹ stage ç”¢ç”Ÿçš„ static html åˆ° /front</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token instruction\"><span class=\"token keyword\">COPY</span> <span class=\"token options\"><span class=\"token property\">--from</span><span class=\"token punctuation\">=</span><span class=\"token string\">builder</span></span> /dist /front</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token instruction\"><span class=\"token keyword\">EXPOSE</span> 5173</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\"># container å•Ÿå‹•æ™‚åŸ·è¡Œ thttpd</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token instruction\"><span class=\"token keyword\">CMD</span> [<span class=\"token string\">\"thttpd\"</span>, <span class=\"token string\">\"-D\"</span>, <span class=\"token string\">\"-h\"</span>, <span class=\"token string\">\"0.0.0.0\"</span>, <span class=\"token string\">\"-p\"</span>, <span class=\"token string\">\"5173\"</span>, <span class=\"token string\">\"-d\"</span>, <span class=\"token string\">\"/front\"</span>, <span class=\"token string\">\"-l\"</span>, <span class=\"token string\">\"-\"</span>, <span class=\"token string\">\"-M\"</span>, <span class=\"token string\">\"60\"</span>]</span></pre></td></tr></table></figure><p><img loading=\"lazy\" src=\"finish.gif\" alt=\"\" /></p>\n<h1 id=\"æ¯”è¼ƒ\"><a class=\"anchor\" href=\"#æ¯”è¼ƒ\">#</a> æ¯”è¼ƒ</h1>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\"></th>\n<th style=\"text-align:center\">Docker image å¤§å°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">ä¿®æ”¹å‰</td>\n<td style=\"text-align:center\">504MB</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">ä¿®æ”¹å¾Œ</td>\n<td style=\"text-align:center\">11.1MB</td>\n</tr>\n</tbody>\n</table>\n<p><img loading=\"lazy\" src=\"whoa.gif\" alt=\"\" /></p>\n",
            "tags": [
                "Docker"
            ]
        },
        {
            "id": "https://8loser.github.io/2023/03/11/EndeavourOS-init/",
            "url": "https://8loser.github.io/2023/03/11/EndeavourOS-init/",
            "title": "EndeavourOS å¸¸ç”¨ç¨‹å¼å®‰è£",
            "date_published": "2023-03-11T13:23:40.000Z",
            "content_html": "<h1 id=\"åƒæ•¸èªªæ˜\"><a class=\"anchor\" href=\"#åƒæ•¸èªªæ˜\">#</a> åƒæ•¸èªªæ˜</h1>\n<ul>\n<li><code>--noconfirm</code>  è‡ªå‹•ç¢ºèª</li>\n<li><code>--needed</code>  å·²å®‰è£çš„å¥—ä»¶ä¸é‡è¤‡å®‰è£</li>\n</ul>\n<h1 id=\"æ³¨éŸ³è¼¸å…¥æ³•-æ–°é…·éŸ³\"><a class=\"anchor\" href=\"#æ³¨éŸ³è¼¸å…¥æ³•-æ–°é…·éŸ³\">#</a> æ³¨éŸ³è¼¸å…¥æ³• (æ–°é…·éŸ³)</h1>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>pacman <span class=\"token parameter variable\">-S</span> <span class=\"token parameter variable\">--noconfirm</span> <span class=\"token parameter variable\">--needed</span> fcitx5 fcitx5-im fcitx5-chinese-addons fcitx5-configtool fcitx5-chewing</pre></td></tr></table></figure><p>ä¿®æ”¹  <code>/etc/environment</code>  æª”æ¡ˆï¼Œå¢åŠ ä¸‹é¢è¨­å®š</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token assign-left variable\">GTK_IM_MODULE</span><span class=\"token operator\">=</span>fcitx</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token assign-left variable\">QT_IM_MODULE</span><span class=\"token operator\">=</span>fcitx</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token assign-left variable\"><span class=\"token environment constant\">XMODIFIERS</span></span><span class=\"token operator\">=</span>@im<span class=\"token operator\">=</span>fcitx</pre></td></tr></table></figure><h1 id=\"è—èŠ½\"><a class=\"anchor\" href=\"#è—èŠ½\">#</a> è—èŠ½</h1>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>pacman <span class=\"token parameter variable\">-S</span> <span class=\"token parameter variable\">--noconfirm</span> <span class=\"token parameter variable\">--needed</span> bluez bluez-utils blueberry</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># è¨­å®šé–‹æ©Ÿè‡ªå‹•å•Ÿç”¨</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>systemctl <span class=\"token builtin class-name\">enable</span> bluetooth</pre></td></tr></table></figure><h1 id=\"visual-studio-code\"><a class=\"anchor\" href=\"#visual-studio-code\">#</a> Visual Studio Code</h1>\n<p>å®‰è£ AUR çš„ bin ç‰ˆæœ¬æ‰æœ‰ Remote Development å¥—ä»¶</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yay <span class=\"token parameter variable\">-S</span> <span class=\"token parameter variable\">--noconfirm</span> <span class=\"token parameter variable\">--needed</span> visual-studio-code-bin</pre></td></tr></table></figure><h1 id=\"docker\"><a class=\"anchor\" href=\"#docker\">#</a> Docker</h1>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>pacman <span class=\"token parameter variable\">-S</span> <span class=\"token parameter variable\">--noconfirm</span> <span class=\"token parameter variable\">--needed</span> <span class=\"token function\">docker</span></pre></td></tr></table></figure><h1 id=\"docker-desktop\"><a class=\"anchor\" href=\"#docker-desktop\">#</a> Docker Desktop</h1>\n<p>è¦å…ˆä¸‹è¼‰å®‰è£æª”æ¡ˆ</p>\n<div class=\"note info\">\n<p>ä¸‹è¼‰ç‰ˆæœ¬ï¼Œå¯åƒè€ƒ <a href=\"https://docs.docker.com/desktop/release-notes/\">https://docs.docker.com/desktop/release-notes/</a></p>\n</div>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># ä¸‹è¼‰å¥—ä»¶æª”æ¡ˆ</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token assign-left variable\">dockerDesktopFile</span><span class=\"token operator\">=</span>docker-desktop-4.17.0-x86_64.pkg.tar.zst</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">wget</span> https://desktop.docker.com/linux/main/amd64/<span class=\"token variable\">$dockerDesktopFile</span> <span class=\"token parameter variable\">-P</span> /tmp</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># å®‰è£å¥—ä»¶</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>pacman <span class=\"token parameter variable\">-U</span> <span class=\"token parameter variable\">--noconfirm</span> /tmp/<span class=\"token variable\">$dockerDesktopFile</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># ç§»é™¤ä¸‹è¼‰çš„æª”æ¡ˆ</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">rm</span> /tmp/<span class=\"token variable\">$dockerDesktopFile</span></pre></td></tr></table></figure><div class=\"note info\">\n<p>æ‰‹å‹•å®‰è£å¯åƒè€ƒ <a href=\"https://docs.docker.com/desktop/install/archlinux/\">https://docs.docker.com/desktop/install/archlinux/</a></p>\n</div>\n<h1 id=\"google-chrome\"><a class=\"anchor\" href=\"#google-chrome\">#</a> Google Chrome</h1>\n<p>AUR æ‰æœ‰</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yay <span class=\"token parameter variable\">-S</span> <span class=\"token parameter variable\">--noconfirm</span> <span class=\"token parameter variable\">--needed</span> google-chrome</pre></td></tr></table></figure><h1 id=\"è¨­å®š-ram-disk\"><a class=\"anchor\" href=\"#è¨­å®š-ram-disk\">#</a> è¨­å®š RAM disk</h1>\n<p>å»ºç«‹æª”æ¡ˆ  <code>/etc/tmpfiles.d/shmFolder.conf</code> <br />\n ä½¿ç”¨è€…åç¨±çš„ä½ç½®è¨˜å¾—ä¿®æ”¹</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># ä¸‹è¼‰è³‡æ–™å¤¾</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>d /dev/shm/Downloads 0755 <span class=\"token operator\">&lt;</span>ä½¿ç”¨è€…åç¨±<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>ä½¿ç”¨è€…åç¨±<span class=\"token operator\">></span> - -</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>L+ /home/<span class=\"token operator\">&lt;</span>ä½¿ç”¨è€…åç¨±<span class=\"token operator\">></span>/Downloads - - - - /dev/shm/Downloads</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># Chrome æš«å­˜è³‡æ–™å¤¾</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>d /dev/shm/ChromeCache 0700 <span class=\"token operator\">&lt;</span>ä½¿ç”¨è€…åç¨±<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>ä½¿ç”¨è€…åç¨±<span class=\"token operator\">></span> - -</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>L+ /home/<span class=\"token operator\">&lt;</span>ä½¿ç”¨è€…åç¨±<span class=\"token operator\">></span>/.cache/google-chrome - - - - /dev/shm/ChromeCache</pre></td></tr></table></figure><p>åŸ·è¡Œä½¿è¨­å®šæª”ç”Ÿæ•ˆï¼Œæˆ–è€…é‡æ–°é–‹æ©Ÿ</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>systemd-tmpfiles <span class=\"token parameter variable\">--create</span></pre></td></tr></table></figure><h1 id=\"å®Œæ•´-shell-script\"><a class=\"anchor\" href=\"#å®Œæ•´-shell-script\">#</a> å®Œæ•´ Shell Script</h1>\n<p>åœ¨é€™è£¡ <a href=\"https://gist.github.com/8loser/a99f0e946861db9a368693ab747c5506\">EndeavourOS-init.sh</a></p>\n",
            "tags": [
                "EndeavourOS",
                "Linux",
                "Shell script"
            ]
        },
        {
            "id": "https://8loser.github.io/2023/02/23/linux-recovering-journal/",
            "url": "https://8loser.github.io/2023/02/23/linux-recovering-journal/",
            "title": "Linux é–‹æ©Ÿé¡¯ç¤º recovering journal",
            "date_published": "2023-02-23T08:51:28.000Z",
            "content_html": "<h1 id=\"æè¿°\"><a class=\"anchor\" href=\"#æè¿°\">#</a> æè¿°</h1>\n<p>Linux ä½œæ¥­ç³»çµ±é–‹æ©Ÿé¡¯ç¤º recovering journalï¼Œç„¡æ³•æ­£å¸¸é€²å…¥æ¡Œé¢ç’°å¢ƒã€‚<br />\nå®Œæ•´è¨Šæ¯å¦‚ä¸‹ï¼Œå‡ºç¾  <code>recovering journal</code>  å¾Œï¼Œè¦ç­‰å€‹å¹¾åˆ†é˜æ‰æœƒå†å‡ºç¾å¾ŒçºŒçš„è¨Šæ¯ã€‚</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>é–‹æ©Ÿè¨Šæ¯</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>/dev/nvme0n1p5: recovering journal</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>/dev/nvme0n1p5: clean, <span class=\"token number\">1217915</span>/16416000 files, <span class=\"token number\">17252131</span>/65536000 blocks</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span> TIME <span class=\"token punctuation\">]</span> Timed out waiting <span class=\"token keyword\">for</span> device /dev/sda2.</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">[</span>DEPEND<span class=\"token punctuation\">]</span> Dependency failed <span class=\"token keyword\">for</span> /home/user/test.</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">[</span>DEPEND<span class=\"token punctuation\">]</span> Dependency failed <span class=\"token keyword\">for</span> Local File System.</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>You are <span class=\"token keyword\">in</span> emergency mode. After logging in, <span class=\"token builtin class-name\">type</span> <span class=\"token string\">\"journalctl -xb\"</span> to view system logs, <span class=\"token string\">\"systemctl reboot\"</span> to reboot, <span class=\"token string\">\"systemctl default\"</span> or <span class=\"token string\">\"exit\"</span> to boot into default mode.</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>Give root password <span class=\"token keyword\">for</span> maintenance</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">(</span>or press Control-D to <span class=\"token builtin class-name\">continue</span><span class=\"token punctuation\">)</span>:</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">..</span>.</pre></td></tr></table></figure><h1 id=\"ç’°å¢ƒ\"><a class=\"anchor\" href=\"#ç’°å¢ƒ\">#</a> ç’°å¢ƒ</h1>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>ç³»çµ±ç’°å¢ƒ</span></figcaption><table><tr class=\"marked\"><td data-num=\"1\"></td><td><pre>$ lsb_release <span class=\"token parameter variable\">-a</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>LSB Version:\tn/a</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Distributor ID:\tManjaroLinux</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>Description:\tManjaro Linux</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>Release:\t<span class=\"token number\">22.0</span>.4</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>Codename:\tSikaris</pre></td></tr></table></figure><h1 id=\"ä¿®æ­£\"><a class=\"anchor\" href=\"#ä¿®æ­£\">#</a> ä¿®æ­£</h1>\n<p>ä½¿ç”¨ root æ¬Šé™ç·¨è¼¯  <code>/etc/fstab</code> ï¼ŒæŠŠ  <code>/dev/sda2</code>  (éŒ¯èª¤è¨Šæ¯ä¸­é¡¯ç¤ºçš„) é‚£è¡Œåˆªé™¤ï¼Œå„²å­˜ï¼Œrebootã€‚</p>\n<h1 id=\"åŸå› \"><a class=\"anchor\" href=\"#åŸå› \">#</a> åŸå› </h1>\n<p>æ‡‰è©²æ˜¯æˆ‘å‰ä¸€æ¬¡é—œæ©Ÿå‰ï¼Œæ’å¤–æ¥ç¡¬ç¢Ÿåˆç”¨ partition ç®¡ç†å·¥å…· mount å¤–æ¥ç¡¬ç¢Ÿ partition å°è‡´ã€‚</p>\n",
            "tags": [
                "Trouble",
                "Linux"
            ]
        },
        {
            "id": "https://8loser.github.io/2023/02/20/terminals-pty-host-is-unresponsive/",
            "url": "https://8loser.github.io/2023/02/20/terminals-pty-host-is-unresponsive/",
            "title": "Dev Containers å‡ºç¾ terminal's pty host process is unresponsive",
            "date_published": "2023-02-20T06:10:40.000Z",
            "content_html": "<h1 id=\"éŒ¯èª¤è¨Šæ¯\"><a class=\"anchor\" href=\"#éŒ¯èª¤è¨Šæ¯\">#</a> éŒ¯èª¤è¨Šæ¯</h1>\n<div class=\"note success\">\n<p>Visual Studio Code 1.76.1 ç‰ˆæœ¬å·²ä¸æœƒæœ‰æ­¤å•é¡Œ</p>\n</div>\n<p>æ›´æ–° Visual Studio Code å¾Œï¼Œé€²å…¥ Dev Containers å‡ºç¾éŒ¯èª¤  <code>The connection to the terminal's pty host process is unresponsive</code> ï¼Œä¸” terminal ç„¡æ³•ä½¿ç”¨ã€‚<br />\n<img loading=\"lazy\" src=\"error-message.png\" alt=\"Error message\" /></p>\n<p>é»é¸  <code>Restart pty host</code>  å¾Œ terminal ä»ç„¡æ³•æ­£å¸¸é¡¯ç¤º</p>\n<h1 id=\"ç’°å¢ƒ\"><a class=\"anchor\" href=\"#ç’°å¢ƒ\">#</a> ç’°å¢ƒ</h1>\n<ul>\n<li>ä½œæ¥­ç³»çµ±</li>\n</ul>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>ç³»çµ±è³‡è¨Š</span></figcaption><table><tr class=\"marked\"><td data-num=\"1\"></td><td><pre>$ lsb_release  <span class=\"token parameter variable\">-a</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>LSB Version:\tn/a</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Distributor ID:\tManjaroLinux</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>Description:\tManjaro Linux</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>Release:\t<span class=\"token number\">22.0</span>.4</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>Codename:\tSikaris</pre></td></tr></table></figure><ul>\n<li>Visual Studio Code 1.75.1 (æœƒå‡ºç¾éŒ¯èª¤çš„ç‰ˆæœ¬)</li>\n</ul>\n<h1 id=\"å˜—è©¦ä¿®æ­£\"><a class=\"anchor\" href=\"#å˜—è©¦ä¿®æ­£\">#</a> å˜—è©¦ä¿®æ­£</h1>\n<p>Visual Studio Code è¨­å®š terminal.integrated.windowsEnableConpty: falseï¼Œé‡å•Ÿå¾Œç•°å¸¸ç‹€æ³ä¸€æ¨£ã€‚</p>\n<h1 id=\"ä½¿ç”¨-downgrade-é™ç‰ˆ\"><a class=\"anchor\" href=\"#ä½¿ç”¨-downgrade-é™ç‰ˆ\">#</a> ä½¿ç”¨ downgrade é™ç‰ˆ</h1>\n<p>ç„¡æ³•é™ç‰ˆï¼Œå¯èƒ½å› ç‚ºæˆ‘å…ˆæŠŠ VSCode åˆªé™¤å†é‡æ–°å®‰è£ï¼Œè€Œé‡æ–°å®‰è£æ˜¯æœ€æ–°ç‰ˆçš„ï¼Œæ‰€ä»¥é›»è…¦å…§æ²’æœ‰ä¿ç•™èˆŠç‰ˆæœ¬ã€‚</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr class=\"marked\"><td data-num=\"1\"></td><td><pre>$ <span class=\"token function\">sudo</span> downgrade visual-studio-code-bin</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Downgrading from A.L.A. is disabled on the stable branch. To override this behavior, <span class=\"token builtin class-name\">set</span> DOWNGRADE_FROM_ALA to <span class=\"token number\">1</span>.</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>See https://wiki.manjaro.org/index.php/Downgrading_packages  <span class=\"token keyword\">for</span> <span class=\"token function\">more</span> details.</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>No results found</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>Unable to downgrade visual-studio-code-bin</pre></td></tr></table></figure><h1 id=\"ç›´æ¥å®‰è£èˆŠç‰ˆæœ¬\"><a class=\"anchor\" href=\"#ç›´æ¥å®‰è£èˆŠç‰ˆæœ¬\">#</a> ç›´æ¥å®‰è£èˆŠç‰ˆæœ¬</h1>\n<h2 id=\"å–å¾—èˆŠç‰ˆæœ¬\"><a class=\"anchor\" href=\"#å–å¾—èˆŠç‰ˆæœ¬\">#</a> å–å¾—èˆŠç‰ˆæœ¬</h2>\n<p>å¾ <a href=\"https://aur.archlinux.org/packages/\">AUR repository</a> æ‰¾åˆ°ä½¿ç”¨çš„å¥—ä»¶<a href=\"https://aur.archlinux.org/packages/visual-studio-code-bin\"> visual-studio-code-bin</a>ï¼Œé»é¸  <code>View Changes</code>  æŸ¥çœ‹èˆŠç‰ˆæœ¬ã€‚</p>\n<p><img loading=\"lazy\" src=\"aur-package.png\" alt=\"AUR package\" /></p>\n<p>é¸æ“‡å¯ä»¥æ­£å¸¸çš„ç‰ˆæœ¬ï¼›1.74.3ï¼Œä¸‹è¼‰å¥—ä»¶ã€‚</p>\n<p><img loading=\"lazy\" src=\"aur-package-changes.png\" alt=\"AUR package changes\" /><br />\n<img loading=\"lazy\" src=\"old-package-download.png\" alt=\"old package download\" /></p>\n<h2 id=\"å»ºç«‹-package\"><a class=\"anchor\" href=\"#å»ºç«‹-package\">#</a> å»ºç«‹ package</h2>\n<p>è§£å£“ç¸®å¾Œé€²å…¥</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>è§£å£“ç¸®å¾Œçš„æª”æ¡ˆæ¸…å–®</span></figcaption><table><tr class=\"marked\"><td data-num=\"1\"></td><td><pre>$ <span class=\"token function\">ls</span> <span class=\"token parameter variable\">-a1</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">.</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">..</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>code.desktop</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>code-url-handler.desktop</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>PKGBUILD</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>.SRCINFO</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>visual-studio-code-bin.install</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>visual-studio-code-bin.sh</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>visual-studio-code-workspace.xml</pre></td></tr></table></figure><p>å»ºç«‹ package</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>å»ºç«‹ package</span></figcaption><table><tr class=\"marked\"><td data-num=\"1\"></td><td><pre>$ makepkg <span class=\"token parameter variable\">-s</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">==</span><span class=\"token operator\">></span> Making package: visual-studio-code-bin <span class=\"token number\">1.74</span>.3-1 <span class=\"token punctuation\">(</span>å»¿å»¿ä¸‰å¹´äºŒæœˆå»¿æ—¥ <span class=\"token punctuation\">(</span>é€±ä¸€<span class=\"token punctuation\">)</span> å»¿æ™‚47åˆ†åä¸‰ç§’<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token operator\">==</span><span class=\"token operator\">></span> Checking runtime dependencies<span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token operator\">==</span><span class=\"token operator\">></span> Checking buildtime dependencies<span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token operator\">==</span><span class=\"token operator\">></span> Retrieving sources<span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  -<span class=\"token operator\">></span> Found code.desktop</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  -<span class=\"token operator\">></span> Found code-url-handler.desktop</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  -<span class=\"token operator\">></span> Found visual-studio-code-workspace.xml</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  -<span class=\"token operator\">></span> Found visual-studio-code-bin.sh</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  -<span class=\"token operator\">></span> Downloading code_x64_1.74.3.tar.gz<span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                                 Dload  Upload   Total   Spent    Left  Speed</pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token number\">100</span>   <span class=\"token number\">134</span>  <span class=\"token number\">100</span>   <span class=\"token number\">134</span>    <span class=\"token number\">0</span>     <span class=\"token number\">0</span>    <span class=\"token number\">159</span>      <span class=\"token number\">0</span> --:--:-- --:--:-- --:--:--   <span class=\"token number\">159</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token number\">100</span>  131M  <span class=\"token number\">100</span>  131M    <span class=\"token number\">0</span>     <span class=\"token number\">0</span>  3979k      <span class=\"token number\">0</span>  <span class=\"token number\">0</span>:00:33  <span class=\"token number\">0</span>:00:33 --:--:-- 4091k</pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token operator\">==</span><span class=\"token operator\">></span> Validating <span class=\"token builtin class-name\">source</span> files with sha256sums<span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    code.desktop <span class=\"token punctuation\">..</span>. Passed</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    code-url-handler.desktop <span class=\"token punctuation\">..</span>. Passed</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    visual-studio-code-workspace.xml <span class=\"token punctuation\">..</span>. Passed</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    visual-studio-code-bin.sh <span class=\"token punctuation\">..</span>. Passed</pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token operator\">==</span><span class=\"token operator\">></span> Validating source_x86_64 files with sha256sums<span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    code_x64_1.74.3.tar.gz <span class=\"token punctuation\">..</span>. Passed</pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token operator\">==</span><span class=\"token operator\">></span> Extracting sources<span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>  -<span class=\"token operator\">></span> Extracting code_x64_1.74.3.tar.gz with bsdtar</pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token operator\">==</span><span class=\"token operator\">></span> Entering fakeroot environment<span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token operator\">==</span><span class=\"token operator\">></span> Starting package<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token operator\">==</span><span class=\"token operator\">></span> Tidying install<span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>  -<span class=\"token operator\">></span> Removing libtool files<span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"28\"></td><td><pre>  -<span class=\"token operator\">></span> Purging unwanted files<span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"29\"></td><td><pre>  -<span class=\"token operator\">></span> Removing static library files<span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>  -<span class=\"token operator\">></span> Stripping unneeded symbols from binaries and libraries<span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"31\"></td><td><pre>  -<span class=\"token operator\">></span> Compressing <span class=\"token function\">man</span> and info pages<span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token operator\">==</span><span class=\"token operator\">></span> Checking <span class=\"token keyword\">for</span> packaging issues<span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token operator\">==</span><span class=\"token operator\">></span> Creating package <span class=\"token string\">\"visual-studio-code-bin\"</span><span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>  -<span class=\"token operator\">></span> Generating .PKGINFO file<span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"35\"></td><td><pre>  -<span class=\"token operator\">></span> Generating .BUILDINFO file<span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"36\"></td><td><pre>  -<span class=\"token operator\">></span> Adding <span class=\"token function\">install</span> file<span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"37\"></td><td><pre>  -<span class=\"token operator\">></span> Generating .MTREE file<span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"38\"></td><td><pre>  -<span class=\"token operator\">></span> Compressing package<span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token operator\">==</span><span class=\"token operator\">></span> Leaving fakeroot environment.</pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token operator\">==</span><span class=\"token operator\">></span> Finished making: visual-studio-code-bin <span class=\"token number\">1.74</span>.3-1 <span class=\"token punctuation\">(</span>å»¿å»¿ä¸‰å¹´äºŒæœˆå»¿æ—¥ <span class=\"token punctuation\">(</span>é€±ä¸€<span class=\"token punctuation\">)</span> å»¿æ™‚48åˆ†äºŒç§’<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>å»ºç«‹ package å¾Œæœƒç”¢ç”Ÿéœ€è¦çš„æª”æ¡ˆï¼Œæª¢æŸ¥æœ‰æ²’æœ‰ç”¢ç”Ÿ  <code>visual-studio-code-bin-1.74.3-1-x86_64.pkg.tar.zst</code> ã€‚</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>å»ºç«‹ package å¾Œç”¢ç”Ÿéœ€è¦çš„æª”æ¡ˆ</span></figcaption><table><tr class=\"marked\"><td data-num=\"1\"></td><td><pre>$ <span class=\"token function\">ls</span> <span class=\"token parameter variable\">-a1</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">.</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">..</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>code.desktop</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>code-url-handler.desktop</pre></td></tr><tr class=\"marked\"><td data-num=\"6\"></td><td><pre>code_x64_1.74.3.tar.gz</pre></td></tr><tr class=\"marked\"><td data-num=\"7\"></td><td><pre>pkg</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>PKGBUILD</pre></td></tr><tr class=\"marked\"><td data-num=\"9\"></td><td><pre>src</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>.SRCINFO</pre></td></tr><tr class=\"marked\"><td data-num=\"11\"></td><td><pre>visual-studio-code-bin-1.74.3-1-x86_64.pkg.tar.zst</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>visual-studio-code-bin.install</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>visual-studio-code-bin.sh</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>visual-studio-code-workspace.xml</pre></td></tr></table></figure><h2 id=\"å®‰è£\"><a class=\"anchor\" href=\"#å®‰è£\">#</a> å®‰è£</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>å®‰è£ package</span></figcaption><table><tr class=\"marked\"><td data-num=\"1\"></td><td><pre>$ <span class=\"token function\">sudo</span> pacman <span class=\"token parameter variable\">-U</span> visual-studio-code-bin-1.74.3-1-x86_64.pkg.tar.zst</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>loading packages<span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>resolving dependencies<span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>looking <span class=\"token keyword\">for</span> conflicting packages<span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>Packages <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> visual-studio-code-bin-1.74.3-1</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>Total Installed Size:  <span class=\"token number\">331.05</span> MiB</pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>:: Proceed with installation? <span class=\"token punctuation\">[</span>Y/n<span class=\"token punctuation\">]</span> y</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token number\">1</span>/1<span class=\"token punctuation\">)</span> checking keys <span class=\"token keyword\">in</span> keyring                                   <span class=\"token punctuation\">[</span><span class=\"token comment\">####################################] 100%</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token number\">1</span>/1<span class=\"token punctuation\">)</span> checking package integrity                                 <span class=\"token punctuation\">[</span><span class=\"token comment\">####################################] 100%</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token number\">1</span>/1<span class=\"token punctuation\">)</span> loading package files                                      <span class=\"token punctuation\">[</span><span class=\"token comment\">####################################] 100%</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token number\">1</span>/1<span class=\"token punctuation\">)</span> checking <span class=\"token keyword\">for</span> <span class=\"token function\">file</span> conflicts                                <span class=\"token punctuation\">[</span><span class=\"token comment\">####################################] 100%</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token number\">1</span>/1<span class=\"token punctuation\">)</span> checking available disk space                              <span class=\"token punctuation\">[</span><span class=\"token comment\">####################################] 100%</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>:: Processing package changes<span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token number\">1</span>/1<span class=\"token punctuation\">)</span> installing visual-studio-code-bin                          <span class=\"token punctuation\">[</span><span class=\"token comment\">####################################] 100%</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token operator\">==</span><span class=\"token operator\">></span> NOTE: Custom flags should be put directly in: ~/.config/code-flags.conf</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>Optional dependencies <span class=\"token keyword\">for</span> visual-studio-code-bin</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    glib2: Needed <span class=\"token keyword\">for</span> move to trash functionality <span class=\"token punctuation\">[</span>installed<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    libdbusmenu-glib: Needed <span class=\"token keyword\">for</span> KDE global menu <span class=\"token punctuation\">[</span>installed<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    org.freedesktop.secrets: Needed <span class=\"token keyword\">for</span> settings <span class=\"token function\">sync</span> <span class=\"token punctuation\">[</span>installed<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    icu69: Needed <span class=\"token keyword\">for</span> live share</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>:: Running post-transaction hooks<span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token number\">1</span>/4<span class=\"token punctuation\">)</span> Arming ConditionNeedsUpdate<span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token number\">2</span>/4<span class=\"token punctuation\">)</span> Updating the MIME <span class=\"token builtin class-name\">type</span> database<span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token number\">3</span>/4<span class=\"token punctuation\">)</span> Refreshing PackageKit<span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token number\">4</span>/4<span class=\"token punctuation\">)</span> Updating the desktop <span class=\"token function\">file</span> MIME <span class=\"token builtin class-name\">type</span> cache<span class=\"token punctuation\">..</span>.</pre></td></tr></table></figure><h1 id=\"æ³¨æ„äº‹é …\"><a class=\"anchor\" href=\"#æ³¨æ„äº‹é …\">#</a> æ³¨æ„äº‹é …</h1>\n<p>åœ¨ Linux ç’°å¢ƒè¦å®‰è£  <code>visual-studio-code-bin</code>  çš„ç‰ˆæœ¬ï¼Œæ‰æœ‰  <code>Remote Development</code>  å¥—ä»¶å¯ä»¥å®‰è£ã€‚</p>\n<p><img loading=\"lazy\" src=\"package-visual-studio-code-bin.png\" alt=\"Visual Studio Code bin\" /></p>\n<h1 id=\"åƒè€ƒè³‡æ–™\"><a class=\"anchor\" href=\"#åƒè€ƒè³‡æ–™\">#</a> åƒè€ƒè³‡æ–™</h1>\n<ul>\n<li><a href=\"https://github.com/microsoft/vscode-remote-release/issues/7999\">https://github.com/microsoft/vscode-remote-release/issues/7999</a></li>\n<li><a href=\"https://github.com/microsoft/vscode/issues/130320\">https://github.com/microsoft/vscode/issues/130320</a></li>\n</ul>\n",
            "tags": [
                "Trouble",
                "VSCode",
                "Remote Development"
            ]
        },
        {
            "id": "https://8loser.github.io/2023/02/19/newbie-guide/",
            "url": "https://8loser.github.io/2023/02/19/newbie-guide/",
            "title": "æ–°æ‰‹æŒ‡å—",
            "date_published": "2023-02-19T07:04:11.000Z",
            "content_html": "<h1 id=\"æ–°æ‰‹æŒ‡å—\"><a class=\"anchor\" href=\"#æ–°æ‰‹æŒ‡å—\">#</a> æ–°æ‰‹æŒ‡å—</h1>\n<p>é€™æ˜¯ä¸€ç¯‡æ–°æ‰‹é€²å…¬å¸å¾Œæ•´ç†å…§éƒ¨é–‹ç™¼æµç¨‹çš„ <s>äº‹æ•…</s> æ•…äº‹</p>\n<h1 id=\"è¦æœ‰å…‰\"><a class=\"anchor\" href=\"#è¦æœ‰å…‰\">#</a> è¦æœ‰å…‰</h1>\n<p>ä¸Šç­ç¬¬ä¸€å¤©ï¼Œè¦ç·Šé ­ä¸€ä»¶äº‹å°±æ˜¯ <span class=\"spoiler\" title=\"ä½ çŸ¥é“å¾—å¤ªå¤šäº†\">èªæ¸…è‡ªå·±åœ¨é£Ÿç‰©éˆä¸­çš„ä½ç½®</span> ç†Ÿæ‚‰é–‹ç™¼ç’°å¢ƒï¼Œç›®å‰å…¬å¸é–‹ç™¼åˆ°ä½ˆç½²çš„æµç¨‹æ˜¯åŸå§‹ç¢¼åœ¨æ¯å€‹äººçš„ç’°å¢ƒéƒ½æœ‰ä¸€ä»½ï¼Œå¦‚æœæœ‰ä¿®æ”¹å†å‚³ä¿®æ”¹çš„æª”æ¡ˆçµ¦çŸ¥é“æ€éº¼ä½ˆç½²çš„äººå»ä½ˆç½²ï¼Œé€™æ–¹å¼æœ‰æ™‚å¾Œæœƒæ¼æ‰æª”æ¡ˆï¼Œä¹Ÿå¾ˆé›£ææ¸…å“ªå€‹æ‰æ˜¯æœ€æ–°ç‰ˆæœ¬çš„ç¨‹å¼ã€‚è€Œä¸”æ¯å€‹äººé–‹ç™¼ç’°å¢ƒä¸åŒï¼Œå‰›æ‹¿åˆ°å°ˆæ¡ˆåŸå§‹ç¢¼æ™‚å•Ÿå‹•å¤±æ•—ï¼ŒåŒå­¸æœƒæ•™æˆ‘ä¸€äº›å¥‡è¨ˆæ·«å·§è‡³ä»Šä»¤æˆ‘åŒªå¤·æ‰€æ€çš„æ–¹æ³•ï¼ˆç‚ºä»€éº¼è¦ä¿®æ”¹ node_modules å…§çš„æª”æ¡ˆï¼Ÿï¼‰ã€‚</p>\n<ul>\n<li>æ”¹çš„æª”æ¡ˆæ˜¯æœ€æ–°ç‰ˆçš„å—ï¼Ÿ</li>\n<li>è¦†è“‹åˆ¥äººçµ¦çš„æª”æ¡ˆå¾Œï¼ŒåŸæœ¬æ”¹å¥½çš„ç¨‹å¼ä¸è¦‹äº†ã€‚</li>\n<li>ä½ çµ¦çš„æª”æ¡ˆç„¡æ³•åŸ·è¡Œï¼Œèªªæœ‰ç¼ºå°‘ functionã€‚</li>\n<li>ã€å¯ä»¥åªçµ¦æä¾›ä¿®æ”¹çš„ function å—ï¼Ÿã€ã€Œæˆ‘å…¶å¯¦ä¹Ÿä¸å¤ªç¢ºå®šè€¶ï¼Œé‚„æ˜¯ä½ æ•´å€‹è²¼ä¸Šå¾Œè©¦è©¦çœ‹æœ‰æ²’æœ‰éŒ¯èª¤ã€</li>\n</ul>\n<h1 id=\"æ–°æ‰‹æ‘\"><a class=\"anchor\" href=\"#æ–°æ‰‹æ‘\">#</a> æ–°æ‰‹æ‘</h1>\n<p>æ‘é•·è·Ÿæˆ‘ä»‹ç´¹æ‘å­å…§ NPC çš„åŠŸèƒ½ï¼Œé‚„æœ‰ server çš„ä½ˆç½²æ–¹å¼ï¼Œç¨‹å¼ç¢¼ä¸Šå‚³åˆ° GCP linux VM å¾Œä½¿ç”¨ docker build æˆ imageï¼Œå†ä½¿ç”¨ docker compose å•Ÿå‹•å¤šå€‹ container é‹è¡Œæœå‹™ã€‚æœ‰å…©å€‹ VM æ¯å€‹ VM éƒ½æœ‰ 5 å€‹ containerï¼Œé™¤äº†å‰ç«¯ã€å¾Œç«¯ç¨‹å¼å¤–é‚„æœ‰ä¸²æ¥å…¶ä»–æœå‹™ï¼Œä½¿ç”¨çš„ç¨‹å¼èªè¨€æœ‰ Vue.js, Node.js, .NET Core ã€‚</p>\n<h1 id=\"ç¨‹å¼ä¸€è‡´\"><a class=\"anchor\" href=\"#ç¨‹å¼ä¸€è‡´\">#</a> ç¨‹å¼ä¸€è‡´</h1>\n<p>ç‚ºäº†è§£æ±ºç¨‹å¼ç¢¼åŒæ­¥å•é¡Œï¼ŒæŒ‘äº†å¯ä»¥å…è²» private è¨—ç®¡çš„ç‰ˆæœ¬æ§åˆ¶æœå‹™ï¼ŒåŒå­¸å¯ä»¥é ç«¯ä¸Šå‚³ç¨‹å¼ç¢¼ï¼Œå…¶ä»–äººä¹Ÿå¯ä»¥åŒæ­¥ã€‚</p>\n<ol>\n<li class=\"quiz\">ä½¿ç”¨çš„æœå‹™ç‚º <span class=\"gap\"></span> ã€‚\n<ul class=\"options\">\n<li class=\"correct\">GitHub</li>\n<li>PornHub</li>\n</ul>\n</li>\n</ol>\n<p>ç‚ºä»€éº¼è¦é¸ GitHub è€Œä¸æ˜¯ <s>PornHub</s> GitLabï¼Ÿå¿˜è¨˜äº†ï¼Œå¥½åƒè·Ÿ CI/CD çš„å…è²»é …ç›®æœ‰é—œã€‚é›£çš„ä¸æ˜¯é¸æ“‡ä½¿ç”¨çš„ç‰ˆæ§æœå‹™ï¼Œè€Œæ˜¯è¦ä¸Šå‚³å“ªäº›ç¨‹å¼ç¢¼ï¼Ÿé€šå¸¸åœ¨ server ä¸Šé‹è¡Œçš„å°±æ˜¯æœ€æ–°çš„ç¨‹å¼ç¢¼ï¼Œä½¿ç”¨ <a href=\"https://winscp.net/\">WinSCP</a> æŠ“ä¸‹ä¾†å¾Œç•¶ä½œåŸºæº–ï¼Œå› ç‚ºå…¶ä»–åŒå­¸é‚„æœ‰æ”¹åˆ°ä¸€åŠæœªä¸Šå‚³çš„ç¨‹å¼ç¢¼ï¼Œæ‰€ä»¥ä¹Ÿæ”¶é›†å…¶ä»–åŒå­¸çš„ç¨‹å¼ç¢¼é€²è¡Œæ•´ç†åˆä½µã€‚æ•´ç†æ™‚ç™¼ç¾ä¸æ˜¯æ¯å€‹äººçš„é–‹ç™¼ç’°å¢ƒè¨­ç½®éƒ½ä¸€æ¨£ï¼Œæœ‰çš„äººç”¨ Windows æœ‰çš„äººç”¨ Macã€‚</p>\n<p><div class=\"links\"><div class=\"item\" title=\"WinSCP\" style=\"--block-color:#e9546b;\"><a href=\"https://winscp.net/\" class=\"image\" data-background-image=\"https://winscp-static-746341.c.cdn77.org/assets/images/logos/logo.png?v=7008\"></a>\n        <div class=\"info\">\n        <a href=\"https://winscp.net/\" class=\"title\">WinSCP</a>\n        <p class=\"desc\">https://winscp.net/</p>\n        </div></div></div></p>\n<h1 id=\"ç’°å¢ƒä¸€è‡´\"><a class=\"anchor\" href=\"#ç’°å¢ƒä¸€è‡´\">#</a> ç’°å¢ƒä¸€è‡´</h1>\n<p>é›–ç„¶ç¨‹å¼ç¢¼ä¸€è‡´äº†ï¼Œä½†ç›¸åŒçš„ç¨‹å¼ç¢¼åœ¨ä¸åŒé–‹ç™¼ç’°å¢ƒå»æœƒå‡ºç¾ç•°å¸¸ï¼Œ<span class=\"spoiler\" title=\"ä½ çŸ¥é“å¾—å¤ªå¤šäº†\">ä½ å°±ç”¨ node 14 å°±å¥½äº†é˜¿ï¼Œæ²’äº‹å¹¹éº»å‡ç´šè‡ªæ‰¾éº»ç…© ğŸ˜’</span> æ‰€ä»¥é–‹ç™¼ç’°å¢ƒä¹Ÿè¦ä¸€è‡´ã€‚æœ€ç°¡å–®çš„æ–¹æ³•æ˜¯å¤§å®¶éƒ½è£ç›¸åŒçš„ node ç‰ˆæœ¬ï¼Œå‡¡æ˜¯éƒ½æœ‰å€‹ BUTï¼Œå…¨éƒ¨çš„å°ˆæ¡ˆä½¿ç”¨çš„ node ä¸¦ä¸æ˜¯ç›¸åŒç‰ˆæœ¬ï¼Œè€Œä¸”ä¸æ˜¯æ¯å€‹äººéƒ½æœƒç”¨ <a href=\"https://github.com/nvm-sh/nvmNVM\">NVM</a>ã€‚<br />\né›–ç„¶æœ‰çš„äººç”¨ Mac æœ‰çš„äººç”¨ Windowsï¼Œä½†æ˜¯å¤§å®¶éƒ½æ˜¯ç”¨ Visual Studio Codeï¼Œæ‰€ä»¥æŠŠå…¨éƒ¨çš„å°ˆæ¡ˆéƒ½åŠ ä¸Š <a href=\"https://code.visualstudio.com/docs/devcontainers/tutorial\">Dev Containers</a>ï¼Œä¹‹å¾Œæ‰€æœ‰äººé–‹ç™¼çš„æ™‚å€™ï¼Œéƒ½ä½¿ç”¨ <a href=\"https://code.visualstudio.com/docs/devcontainers/tutorial\">Dev Containers</a> é€²å…¥ container é€²è¡Œé–‹ç™¼ã€‚</p>\n<p><div class=\"links\"><div class=\"item\" title=\"visual Studio Code\" style=\"--block-color:#e9546b;\"><a href=\"https://code.visualstudio.com/docs/devcontainers/containers\" class=\"image\" data-background-image=\"/assets/404.png\"></a>\n        <div class=\"info\">\n        <a href=\"https://code.visualstudio.com/docs/devcontainers/containers\" class=\"title\">Developing inside a Container</a>\n        <p class=\"desc\">https://code.visualstudio.com/docs/devcontainers/containers</p>\n        </div></div><div class=\"item\" title=\"å…«æ¨“çš„äºº\" style=\"--block-color:#e9546b;\"><a href=\"/2022/05/13/Remote-Containers/\" class=\"image\" data-background-image=\"/assets/avatar.jpg\"></a>\n        <div class=\"info\">\n        <a href=\"/2022/05/13/Remote-Containers/\" class=\"title\">ä½¿ç”¨ VSCode åœ¨ Docker container å…§é€²è¡Œé–‹ç™¼</a>\n        <p class=\"desc\">/2022/05/13/Remote-Containers/</p>\n        </div></div></div></p>\n<h1 id=\"docker-image-auto-build\"><a class=\"anchor\" href=\"#docker-image-auto-build\">#</a> Docker image auto build</h1>\n<p>ä¸Šé¢æåˆ°ç¨‹å¼æœ€å¾Œéƒ½åœ¨ server ä¸Š build image å¾Œï¼Œä½¿ç”¨ docker compose å»ºç«‹ container åŸ·è¡Œã€‚ <ins>ä½ çµ‚ç©¶è¦ image çš„é‚£ç‚ºä»€éº¼ä¸ä¸€é–‹å§‹å°± imageï¼Ÿ</ins> æ‰€ä»¥æŠŠæ¯å€‹å°ˆæ¡ˆéƒ½åŠ ä¸Š <a href=\"https://docs.github.com/en/actions/quickstart\">GitHub Action</a>ï¼Œå¼•ç”¨åŸæœ¬å°±æœ‰çš„ Dockerfile ä¿®æ”¹ï¼Œç¨‹å¼ä¸Šå‚³å¾Œæœƒè‡ªå‹•æ‰“åŒ…æˆ docker image ä¸” push åˆ° <a href=\"https://docs.github.com/en/packages/learn-github-packages/introduction-to-github-packages\">GitHub Package</a></p>\n<p>åœ¨ GitHub Action ä½¿ç”¨ä¸‹é¢çš„ ymlï¼Œç¨‹å¼ç¢¼ä¸Šå‚³åˆ° GitHub å¾Œæœƒè‡ªå‹•æ‰“åŒ…æˆ docker image</p>\n<p><a href=\"https://gist.github.com/8loser/4f78378d21358e8d4174bb9e8d872af3\">Gist Auto build docker image yml</a></p>\n<p>å¦‚æœè¨­å®šæˆåŠŸ push ç¨‹å¼ç¢¼å¾Œå¯ä»¥åœ¨ GitHub Action çœ‹åˆ°åŸ·è¡Œå‹•ä½œ<br />\n<img loading=\"lazy\" src=\"github-action.png\" alt=\"GitHub Action\" /></p>\n<p><div class=\"links\"><div class=\"item\" title=\"Quickstart for GitHub Actions\" style=\"--block-color:#e9546b;\"><a href=\"https://docs.github.com/en/actions/quickstart\" class=\"image\" data-background-image=\"/assets/404.png\"></a>\n        <div class=\"info\">\n        <a href=\"https://docs.github.com/en/actions/quickstart\" class=\"title\">Quickstart for GitHub Actions</a>\n        <p class=\"desc\">https://docs.github.com/en/actions/quickstart</p>\n        </div></div><div class=\"item\" title=\"docker/build-push-action\" style=\"--block-color:#e9546b;\"><a href=\"https://github.com/docker/build-push-action\" class=\"image\" data-background-image=\"/assets/404.png\"></a>\n        <div class=\"info\">\n        <a href=\"https://github.com/docker/build-push-action\" class=\"title\">docker/build-push-action</a>\n        <p class=\"desc\">https://github.com/docker/build-push-action</p>\n        </div></div></div></p>\n<h1 id=\"docker-ç®¡ç†\"><a class=\"anchor\" href=\"#docker-ç®¡ç†\">#</a> Docker ç®¡ç†</h1>\n<p>é‘‘æ–¼ä¸æ˜¯æ‰€æœ‰åŒå­¸éƒ½ç¿’æ…£ç”¨ linuxï¼Œæ‰€ä»¥åœ¨ server è£ä¸Š <a href=\"https://www.portainer.io\">portainer</a>ï¼Œå¯ä»¥ä½¿ç”¨ Web ç•Œé¢æ§åˆ¶ server ä¸Šçš„ dockerã€‚ä¸€å¤©åˆå¹³å®‰çš„éå»äº†ï¼Œæ„Ÿè¬é£›å¤©å°å¥³è­¦çš„åŠªåŠ›ã€‚</p>\n<p><div class=\"links\"><div class=\"item\" title=\"Install Portainer CE with Docker on Linux\" style=\"--block-color:#e9546b;\"><a href=\"https://docs.portainer.io/start/install-ce/server/docker/linux\" class=\"image\" data-background-image=\"/assets/404.png\"></a>\n        <div class=\"info\">\n        <a href=\"https://docs.portainer.io/start/install-ce/server/docker/linux\" class=\"title\">Install Portainer CE with Docker on Linux</a>\n        <p class=\"desc\">https://docs.portainer.io/start/install-ce/server/docker/linux</p>\n        </div></div></div></p>\n<h1 id=\"è‡ªå‹•ä½ˆç½²\"><a class=\"anchor\" href=\"#è‡ªå‹•ä½ˆç½²\">#</a> è‡ªå‹•ä½ˆç½²</h1>\n<p>å‡ºç¾ bug æ€¥è‘—ä¿®æ­£çš„æ™‚å€™ï¼Œå¯èƒ½ä¸€å¤©è¦ä¸Šå‚³ç¨‹å¼åˆ° server å…«ç™¾æ¬¡ï¼Œä½†ä¸æ˜¯æ‰€æœ‰äººéƒ½çŸ¥é“æ€éº¼æ›´æ–°åˆ° serverï¼Œ<span class=\"spoiler\" title=\"ä½ çŸ¥é“å¾—å¤ªå¤šäº†\">æ‰€ä»¥ç¶­é‹çš„åŒå­¸è¦å¤šé«”è«’å·¥ç¨‹å¸«</span> æ‰€ä»¥åœ¨ portainer é–‹å•Ÿ swarm åŠŸèƒ½å¾Œï¼Œservice å°±å¯ä»¥å•Ÿç”¨ webhook æ¥æ”¶æ›´æ–°é€šçŸ¥ï¼Œæ”¶åˆ°é€šçŸ¥å¾Œè‡ªå‹• pull æ–°çš„ docker image é€²è¡Œä½ˆç½²ï¼Œä¸çŸ¥é“æ€éº¼ä½ˆç½²çš„äººå¯ä»¥  <code>POST</code>  å‘¼å« webhook é€²è¡Œ service æ›´æ–°ã€‚</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>é–‹å•Ÿ docker swarm æ–¹æ³•</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> swarm init</pre></td></tr></table></figure><p>è¨­å®šå®Œæˆå¾Œå¯ä»¥åœ¨ portainer é¸å–®çœ‹åˆ° service é …ç›®<br />\n<img loading=\"lazy\" src=\"portainer-menu.png\" alt=\"portainer menu\" /></p>\n<p>é€²å…¥ service å¯ä»¥é–‹å•Ÿ  <code>Service webhook</code> ï¼Œç”¢ç”Ÿçš„ç¶²å€å°±æ˜¯ç”¨ä¾†æ¥æ”¶é€šçŸ¥æ‹‰å–æ–° image é‡æ–°ä½ˆç½²çš„<br />\n<img loading=\"lazy\" src=\"portainer-service.png\" alt=\"portainer service\" /></p>\n<p>æ›´æ–° service é‚„è¦å‘¼å« webhook æœ‰é»éº»ç…©ï¼Œå°±äº¤çµ¦ GitHub Action å§ï¼<br />\nåœ¨ GitHub Action åŠ å…¥ä¸‹é¢è¨­å®šå¾Œï¼Œæ¯æ¬¡ push/pull_request (æ ¹æ“š main.yml è¨­å®š) å°±æœƒè‡ªå‹•æ›´æ–°ã€‚</p>\n<figure class=\"highlight yml\"><figcaption data-lang=\"YAML\"><span>å‘¼å« webhook é€²è¡Œæ›´æ–°</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Call webhook update service</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> muinmomin/webhook<span class=\"token punctuation\">-</span>action@v1.0.0</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token key atrule\">url</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># è¦é€šçŸ¥çš„ webhook URL</span></pre></td></tr></table></figure><p><div class=\"links\"><div class=\"item\" title=\"portainer.io\" style=\"--block-color:#e9546b;\"><a href=\"https://docs.portainer.io/user/docker/services/webhooks#enabling-a-service-webhook\" class=\"image\" data-background-image=\"/assets/404.png\"></a>\n        <div class=\"info\">\n        <a href=\"https://docs.portainer.io/user/docker/services/webhooks#enabling-a-service-webhook\" class=\"title\">Enabling a service webhook</a>\n        <p class=\"desc\">https://docs.portainer.io/user/docker/services/webhooks#enabling-a-service-webhook</p>\n        </div></div><div class=\"item\" title=\"muinmomin/webhook-action\" style=\"--block-color:#e9546b;\"><a href=\"https://github.com/muinmomin/webhook-action\" class=\"image\" data-background-image=\"/assets/404.png\"></a>\n        <div class=\"info\">\n        <a href=\"https://github.com/muinmomin/webhook-action\" class=\"title\">muinmomin/webhook-action</a>\n        <p class=\"desc\">https://github.com/muinmomin/webhook-action</p>\n        </div></div></div></p>\n<h1 id=\"æ­£å¼ç«™æ¸¬è©¦ç«™\"><a class=\"anchor\" href=\"#æ­£å¼ç«™æ¸¬è©¦ç«™\">#</a> æ­£å¼ç«™ / æ¸¬è©¦ç«™</h1>\n<p>ç•¶æ¥­å‹™å¤–å‡ºè·Ÿå®¢æˆ¶å±•ç¤ºç³»çµ±åŠŸèƒ½æ™‚ï¼Œå¦‚æœç¶²ç«™ä¸€ç›´æ›´æ–°é‡å•Ÿæœå‹™ä¸­æ–·ï¼Œåœ¨å®¢æˆ¶ç«¯çš„åŒå­¸æœƒå¾ˆå°·å°¬ï¼Œ<span class=\"spoiler\" title=\"ä½ çŸ¥é“å¾—å¤ªå¤šäº†\">æ‰€ä»¥æœ‰æ¥­å‹™åœ¨å¤–å±•ç¤ºæ™‚å·¥ç¨‹å¸«å¯ä»¥æ”¾å‡</span> æ‰€ä»¥æŠŠç·šä¸Šç³»çµ±åˆ†ç‚ºæ­£å¼ç«™è·Ÿæ¸¬è©¦ç«™ã€‚</p>\n<ul class=\"task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"cbx_0\" checked=\"true\" disabled=\"true\" /><label for=\"cbx_0\"> GCP VM å…©å°è®Šå››å°</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"cbx_1\" checked=\"true\" disabled=\"true\" /><label for=\"cbx_1\"> è¨­å®šæ¸¬è©¦ç«™ subdomain</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"cbx_2\" checked=\"true\" disabled=\"true\" /><label for=\"cbx_2\"> GitHub è¨­å®š main/test å…©å€‹åˆ†æ”¯</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"cbx_3\" checked=\"true\" disabled=\"true\" /><label for=\"cbx_3\"> GitHub Action è¨­å®šåªæœ‰ test åˆ†æ”¯ push æ™‚æ‰è‡ªå‹•æ›´æ–°åˆ°æ¸¬è©¦ç«™</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"cbx_4\" disabled=\"true\" /><label for=\"cbx_4\"> ä½ å‡è·ï¼Œæˆ‘åŠ è–ªï¼Œå¤§å®¶é–‹é¦™æª³ï½ï¼¹ï¼¡</label></li>\n</ul>\n<p><img loading=\"lazy\" src=\"Love-on-Delivery.gif\" alt=\"ç ´å£ä¹‹ç‹\" /></p>\n",
            "tags": [
                "Need to Know",
                "Story"
            ]
        },
        {
            "id": "https://8loser.github.io/2023/02/11/redis-cluster/",
            "url": "https://8loser.github.io/2023/02/11/redis-cluster/",
            "title": "GKE ä½ˆç½² Redis å¢é›†",
            "date_published": "2023-02-11T10:07:24.000Z",
            "content_html": "<h1 id=\"ç’°å¢ƒ\"><a class=\"anchor\" href=\"#ç’°å¢ƒ\">#</a> ç’°å¢ƒ</h1>\n<p>åœ¨ <a href=\"https://cloud.google.com/kubernetes-engine?hl=zh-tw\">Google Kubernetes Engine (GKE)</a> å…§å»ºç½® Redis å¢é›†</p>\n<ul>\n<li>GKE node: g1-small * 2 (version 1.24.8-gke.2000)</li>\n<li>Redis 7</li>\n</ul>\n<h1 id=\"å»ºç«‹-configmap\"><a class=\"anchor\" href=\"#å»ºç«‹-configmap\">#</a> å»ºç«‹ ConfigMap</h1>\n<p>å»ºç«‹çµ¦ redis ç¯€é»ä½¿ç”¨çš„å…±ç”¨è¨­å®šæª”ï¼Œåç¨±ç‚º  <code>redis-cluster</code> ï¼Œä¹‹å¾Œå»ºç«‹ç‚º volume è®“æ¯å€‹å®¹å™¨ä½¿ç”¨</p>\n<figure class=\"highlight yaml\"><figcaption data-lang=\"YAML\"><span>ConfigMap</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> ConfigMap</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> redis<span class=\"token punctuation\">-</span>cluster</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token key atrule\">data</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token key atrule\">update-node.sh</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\"></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    #!/bin/sh</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    REDIS_NODES=\"/data/nodes.conf\"</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    sed -i -e \"/myself/ s/[0-9]\\&#123;1,3\\&#125;\\.[0-9]\\&#123;1,3\\&#125;\\.[0-9]\\&#123;1,3\\&#125;\\.[0-9]\\&#123;1,3\\&#125;/$&#123;POD_IP&#125;/\" $&#123;REDIS_NODES&#125;</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    exec \"$@\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  <span class=\"token key atrule\">redis.conf</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span>+</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    cluster<span class=\"token punctuation\">-</span>enabled yes</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    cluster<span class=\"token punctuation\">-</span>require<span class=\"token punctuation\">-</span>full<span class=\"token punctuation\">-</span>coverage no</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    cluster<span class=\"token punctuation\">-</span>node<span class=\"token punctuation\">-</span>timeout 15000</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    cluster<span class=\"token punctuation\">-</span>config<span class=\"token punctuation\">-</span>file /data/nodes.conf</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    cluster<span class=\"token punctuation\">-</span>migration<span class=\"token punctuation\">-</span>barrier 1</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    appendonly yes</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    protected<span class=\"token punctuation\">-</span>mode no</pre></td></tr></table></figure><p>å»ºç«‹æˆåŠŸå¾Œå¯ä»¥åœ¨ GKE ç•Œé¢çš„  <code>Secretèˆ‡ConfigMap</code>  å…§çœ‹åˆ°æ–°å¢çš„  <code>redis-cluster</code></p>\n<p><img loading=\"lazy\" src=\"gke-configmap.png\" alt=\"ConfigMap\" /></p>\n<h1 id=\"å»ºç«‹-statefulset\"><a class=\"anchor\" href=\"#å»ºç«‹-statefulset\">#</a> å»ºç«‹ StatefulSet</h1>\n<ul>\n<li>StatefulSet éœ€è¦ä½¿ç”¨ Kubernetes v1.9 æˆ–ä¹‹å¾Œçš„ç‰ˆæœ¬æ‰æ”¯æ´</li>\n<li>.spec.selector.matchLabels è¦è·Ÿ .spec.template.metadata.labels ç›¸åŒ</li>\n<li>.spec.replicas è‡³å°‘è¦ 6 å€‹ï¼Œredis cluster è‡³å°‘è¦ 6 å€‹ç¯€é»ï¼›3 å€‹ master, 3 å€‹ slave, ä¸éé‚„æ²’æŸ¥åˆ°ç‚ºä»€éº¼ã€‚</li>\n</ul>\n<p>åƒè€ƒæ–‡ç« åœ¨ .spec.selector.template.spec.containers.volumes.defaultMode æ˜¯å¯«  <code>0755</code>  (å…«é€²ä½)ï¼Œä½†æ˜¯æˆ‘åœ¨ Lens å…§åŸ·è¡Œæ™‚æœƒå‡ºç¾ä¸‹é¢éŒ¯èª¤ï¼Œæ‰€ä»¥æ”¹æˆåé€²ä½çš„  <code>493</code></p>\n<div class=\"note warning\">\n<p>create Pod redis-cluster-0 in StatefulSet redis-cluster failed error: Pod &quot;redis-cluster-0&quot; is invalid: [spec.volumes[1].configMap.defaultMode: Invalid value: 755: must be a number between 0 and 0777 (octal), both inclusive, spec.containers[0].volumeMounts[0].name: Not found: &quot;conf&quot;]</p>\n</div>\n<p>å®Œæ•´ yaml</p>\n<figure class=\"highlight yaml\"><figcaption data-lang=\"YAML\"><span>StatefulSet</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> apps/v1</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> StatefulSet</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> redis<span class=\"token punctuation\">-</span>cluster</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token key atrule\">serviceName</span><span class=\"token punctuation\">:</span> redis<span class=\"token punctuation\">-</span>cluster</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">6</span> <span class=\"token comment\"># by default is 1</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> redis<span class=\"token punctuation\">-</span>cluster <span class=\"token comment\"># has to match .spec.template.metadata.labels</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> redis<span class=\"token punctuation\">-</span>cluster <span class=\"token comment\"># has to match .spec.selector.matchLabels</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> redis</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> redis<span class=\"token punctuation\">:</span><span class=\"token number\">7</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">containerPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">6379</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>          <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> client</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">containerPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">16379</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>          <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> gossip</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token key atrule\">command</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"/conf/update-node.sh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"redis-server\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"/conf/redis.conf\"</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> POD_IP</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>          <span class=\"token key atrule\">valueFrom</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token key atrule\">fieldRef</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>              <span class=\"token key atrule\">fieldPath</span><span class=\"token punctuation\">:</span> status.podIP</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token key atrule\">volumeMounts</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> conf</pre></td></tr><tr><td data-num=\"32\"></td><td><pre>          <span class=\"token key atrule\">mountPath</span><span class=\"token punctuation\">:</span> /conf</pre></td></tr><tr><td data-num=\"33\"></td><td><pre>          <span class=\"token key atrule\">readOnly</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> data</pre></td></tr><tr><td data-num=\"35\"></td><td><pre>          <span class=\"token key atrule\">mountPath</span><span class=\"token punctuation\">:</span> /data</pre></td></tr><tr><td data-num=\"36\"></td><td><pre>          <span class=\"token key atrule\">readOnly</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>      <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> conf</pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token key atrule\">configMap</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>          <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> redis<span class=\"token punctuation\">-</span>cluster</pre></td></tr><tr><td data-num=\"41\"></td><td><pre>          <span class=\"token comment\"># defaultMode: 0755</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>          <span class=\"token key atrule\">defaultMode</span><span class=\"token punctuation\">:</span> <span class=\"token number\">493</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>  <span class=\"token key atrule\">volumeClaimTemplates</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>      <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> data</pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>      <span class=\"token key atrule\">accessModes</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"ReadWriteOnce\"</span> <span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>      <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        <span class=\"token key atrule\">requests</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>          <span class=\"token key atrule\">storage</span><span class=\"token punctuation\">:</span> 1Gi</pre></td></tr></table></figure><p>åŸ·è¡Œå®Œç­‰ä¸€ä¸‹<br />\n<img loading=\"lazy\" src=\"Let_the_Bullets_Fly.png\" alt=\"è®“å­å½ˆé£›ä¸€æœƒå…’\" /></p>\n<p>ä¹‹å¾Œå¯ä»¥åœ¨ GKE çš„  <code>å·¥ä½œè² è¼‰</code>  å…§çœ‹åˆ° 6 å€‹ Pod å»ºç«‹å®Œæˆ<br />\n<img loading=\"lazy\" src=\"gke-stateful.png\" alt=\"Pods\" /></p>\n<p><code>å„²å­˜ç©ºé–“</code>  ä¹Ÿæœƒç”¢ç”Ÿ 6 å€‹ PVC (PersistentVolumeClaim)<br />\n<img loading=\"lazy\" src=\"gke-pvc.png\" alt=\"PVC\" /></p>\n<p>æˆ–è€…ä½¿ç”¨æŒ‡ä»¤æŸ¥çœ‹</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>kubectl get pods</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ kubectl get pods</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>NAME              READY   STATUS    RESTARTS   AGE</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>redis-cluster-0   <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          8m31s</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>redis-cluster-1   <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          8m19s</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>redis-cluster-2   <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          8m7s</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>redis-cluster-3   <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          7m56s</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>redis-cluster-4   <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          7m39s</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>redis-cluster-5   <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          7m28s</pre></td></tr></table></figure><figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>kubectl get pv</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ kubectl get <span class=\"token function\">pv</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>NAME                                       CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM                          STORAGECLASS   REASON   AGE</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>pvc-01fc7eb6-e99a-4111-8923-53229eb112b4   1Gi        RWO            Delete           Bound    default/data-redis-cluster-1   standard-rwo            21m</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>pvc-4bc387e4-dd4c-4400-b99a-e75a720e509b   1Gi        RWO            Delete           Bound    default/data-redis-cluster-2   standard-rwo            21m</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>pvc-af768f00-7889-4fa5-9ef8-cb95337ef38a   1Gi        RWO            Delete           Bound    default/data-redis-cluster-5   standard-rwo            20m</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>pvc-b6dadea9-b10e-42cb-8ae4-729b186e8b7c   1Gi        RWO            Delete           Bound    default/data-redis-cluster-0   standard-rwo            21m</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>pvc-c42ebfa4-a726-42f5-b146-18c28de544a4   1Gi        RWO            Delete           Bound    default/data-redis-cluster-4   standard-rwo            20m</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>pvc-d1d4de96-2f91-4050-9707-8fd802bd7fb4   1Gi        RWO            Delete           Bound    default/data-redis-cluster-3   standard-rwo            21m</pre></td></tr></table></figure><h1 id=\"å»ºç«‹-service\"><a class=\"anchor\" href=\"#å»ºç«‹-service\">#</a> å»ºç«‹ Service</h1>\n<figure class=\"highlight yaml\"><figcaption data-lang=\"YAML\"><span>Service</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Service</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> redis<span class=\"token punctuation\">-</span>cluster</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token number\">6379</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token key atrule\">targetPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">6379</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> client</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token number\">16379</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token key atrule\">targetPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">16379</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> gossip</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> redis<span class=\"token punctuation\">-</span>cluster</pre></td></tr></table></figure><p>åŸ·è¡Œå®Œæª¢æŸ¥ Service  <code>redis-cluster</code>  æ˜¯å¦æˆåŠŸå»ºç«‹<br />\n<img loading=\"lazy\" src=\"gke-service.png\" alt=\"service\" /></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>kubectl get service redis-cluster</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ kubectl get <span class=\"token function\">service</span> redis-cluster</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>NAME            TYPE        CLUSTER-IP    EXTERNAL-IP   PORT<span class=\"token punctuation\">(</span>S<span class=\"token punctuation\">)</span>              AGE</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>redis-cluster   ClusterIP   <span class=\"token number\">10.80</span>.5.184   <span class=\"token operator\">&lt;</span>none<span class=\"token operator\">></span>        <span class=\"token number\">6379</span>/TCP,16379/TCP   2m50s</pre></td></tr></table></figure><h1 id=\"å»ºç«‹-redis-å¢é›†\"><a class=\"anchor\" href=\"#å»ºç«‹-redis-å¢é›†\">#</a> å»ºç«‹ Redis å¢é›†</h1>\n<p>åƒè€ƒçš„æ–‡ç« ä½¿ç”¨çš„æŒ‡ä»¤å¦‚ä¸‹</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>create redis-cluster</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>kubectl <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-it</span> redis-cluster-0 -- redis-cli <span class=\"token parameter variable\">--cluster</span> create --cluster-replicas <span class=\"token number\">1</span> <span class=\"token variable\"><span class=\"token variable\">$(</span>kubectl get pods <span class=\"token parameter variable\">-l</span> <span class=\"token assign-left variable\">app</span><span class=\"token operator\">=</span>redis-cluster <span class=\"token parameter variable\">-o</span> <span class=\"token assign-left variable\">jsonpath</span><span class=\"token operator\">=</span><span class=\"token string\">'&#123;range.items[*]&#125;&#123;.status.podIP&#125;:6379 '</span><span class=\"token variable\">)</span></span></pre></td></tr></table></figure><p>å¯¦éš›å¯¦è¡Œçµæœæœƒå‡ºç¾å¦‚ä¸‹éŒ¯èª¤</p>\n<div class=\"note danger\">\n<p>kubectl exec -it redis-cluster-0 -- redis-cli --cluster create --cluster-replicas 1 $(kubectl get pods -l app=redis-cluster -o jsonpath='{range.items[*]}{.status.podIP}:6379 ')</p>\n</div>\n<p>æŸ¥çœ‹åŸå› æ˜¯  <code>kubectl get pods -l app=redis-cluster -o jsonpath='&#123;range.items[*]&#125;&#123;.status.podIP&#125;</code>  æœƒå¤šä¸€çµ„ç©ºçš„ IP</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ kubectl get pods <span class=\"token parameter variable\">-l</span> <span class=\"token assign-left variable\">app</span><span class=\"token operator\">=</span>redis-cluster <span class=\"token parameter variable\">-o</span> <span class=\"token assign-left variable\">jsonpath</span><span class=\"token operator\">=</span><span class=\"token string\">'&#123;range.items[*]&#125;&#123;.status.podIP&#125;:6379 '</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">10.76</span>.2.30:6379 <span class=\"token number\">10.76</span>.1.32:6379 <span class=\"token number\">10.76</span>.2.31:6379 <span class=\"token number\">10.76</span>.1.33:6379 <span class=\"token number\">10.76</span>.2.32:6379 <span class=\"token number\">10.76</span>.1.34:6379 :6379</pre></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨ä¸‹é¢æŒ‡ä»¤æŸ¥çœ‹æ¯”è¼ƒæ˜é¡¯</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ kubectl get pods <span class=\"token parameter variable\">-l</span> <span class=\"token assign-left variable\">app</span><span class=\"token operator\">=</span>redis-cluster <span class=\"token parameter variable\">-o</span> <span class=\"token assign-left variable\">jsonpath</span><span class=\"token operator\">=</span><span class=\"token string\">'&#123;range.items[*]&#125;&#123;.status.podIP&#125;:6379&#123;\"\\n\"&#125;'</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">10.76</span>.2.30:6379</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">10.76</span>.1.32:6379</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">10.76</span>.2.31:6379</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">10.76</span>.1.33:6379</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token number\">10.76</span>.2.32:6379</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">10.76</span>.1.34:6379</pre></td></tr><tr class=\"marked\"><td data-num=\"8\"></td><td><pre>:6379</pre></td></tr></table></figure><p>ä¿®æ”¹å¾ŒæŒ‡ä»¤å¦‚ä¸‹</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>kubectl <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-it</span> redis-cluster-0 -- redis-cli <span class=\"token parameter variable\">--cluster</span> create --cluster-replicas <span class=\"token number\">1</span> <span class=\"token variable\"><span class=\"token variable\">$(</span>kubectl get pods <span class=\"token parameter variable\">-o</span><span class=\"token operator\">=</span>jsonpath<span class=\"token operator\">=</span><span class=\"token string\">'&#123;range .items[*]&#125;&#123;.status.podIP&#125;:6379 &#123;end&#125;'</span><span class=\"token variable\">)</span></span></pre></td></tr></table></figure><p><code>Can I set the above configuration?</code>  è¼¸å…¥  <code>yes</code> ï¼ŒåŸ·è¡Œçµæœå¯ä»¥çœ‹åˆ°å»ºç«‹äº† 3 å€‹ redis master ç¯€é»ï¼Œ3 å€‹ slave ç¯€é»ã€‚</p>\n<details class=\"info\"><summary>åŸ·è¡Œçµæœ</summary><div>\n<p>$ kubectl exec -it redis-cluster-0 -- redis-cli --cluster create --cluster-replicas 1 $(kubectl get pods -o=jsonpath='{range .items[*]}{.status.podIP}:6379 {end}')<br />\n&gt;&gt;&gt; Performing hash slots allocation on 6 nodes...<br />\nMaster[0] -&gt; Slots 0 - 5460<br />\nMaster[1] -&gt; Slots 5461 - 10922<br />\nMaster[2] -&gt; Slots 10923 - 16383<br />\nAdding replica 10.76.2.32:6379 to 10.76.2.30:6379<br />\nAdding replica 10.76.1.34:6379 to 10.76.1.32:6379<br />\nAdding replica 10.76.1.33:6379 to 10.76.2.31:6379<br />\nM: 05ecf3912ed0a5517ab74fd17f81d02a3314a833 10.76.2.30:6379<br />\nslots:[0-5460] (5461 slots) master<br />\nM: 9da23852cfd0a7489c2f53ec743363e48dea378b 10.76.1.32:6379<br />\nslots:[5461-10922] (5462 slots) master<br />\nM: 379127b6974b6acc59e5fb194361749e682bdc97 10.76.2.31:6379<br />\nslots:[10923-16383] (5461 slots) master<br />\nS: 5105cdd3a6637e3844316c557f81c68b231703e7 10.76.1.33:6379<br />\nreplicates 379127b6974b6acc59e5fb194361749e682bdc97<br />\nS: dde0a9ef27e044cd124814529305732c9ab0d9dd 10.76.2.32:6379<br />\nreplicates 05ecf3912ed0a5517ab74fd17f81d02a3314a833<br />\nS: 8a89a45f3161b606b13f1ede95fec240de2bcf9d 10.76.1.34:6379<br />\nreplicates 9da23852cfd0a7489c2f53ec743363e48dea378b<br />\nCan I set the above configuration? (type 'yes' to accept): yes<br />\n&gt;&gt;&gt; Nodes configuration updated<br />\n&gt;&gt;&gt; Assign a different config epoch to each node<br />\n&gt;&gt;&gt; Sending CLUSTER MEET messages to join the cluster<br />\nWaiting for the cluster to join</p>\n<p>&gt;&gt;&gt; Performing Cluster Check (using node 10.76.2.30:6379)<br />\nM: 05ecf3912ed0a5517ab74fd17f81d02a3314a833 10.76.2.30:6379<br />\nslots:[0-5460] (5461 slots) master<br />\n1 additional replica(s)<br />\nS: dde0a9ef27e044cd124814529305732c9ab0d9dd 10.76.2.32:6379<br />\nslots: (0 slots) slave<br />\nreplicates 05ecf3912ed0a5517ab74fd17f81d02a3314a833<br />\nS: 5105cdd3a6637e3844316c557f81c68b231703e7 10.76.1.33:6379<br />\nslots: (0 slots) slave<br />\nreplicates 379127b6974b6acc59e5fb194361749e682bdc97<br />\nM: 379127b6974b6acc59e5fb194361749e682bdc97 10.76.2.31:6379<br />\nslots:[10923-16383] (5461 slots) master<br />\n1 additional replica(s)<br />\nM: 9da23852cfd0a7489c2f53ec743363e48dea378b 10.76.1.32:6379<br />\nslots:[5461-10922] (5462 slots) master<br />\n1 additional replica(s)<br />\nS: 8a89a45f3161b606b13f1ede95fec240de2bcf9d 10.76.1.34:6379<br />\nslots: (0 slots) slave<br />\nreplicates 9da23852cfd0a7489c2f53ec743363e48dea378b<br />\n[OK] All nodes agree about slots configuration.<br />\n&gt;&gt;&gt; Check for open slots...<br />\n&gt;&gt;&gt; Check slots coverage...<br />\n[OK] All 16384 slots covered.</p>\n</div></details>\n<h1 id=\"é©—è­‰-redis-å¢é›†\"><a class=\"anchor\" href=\"#é©—è­‰-redis-å¢é›†\">#</a> é©—è­‰ Redis å¢é›†</h1>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>kubectl <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-it</span> redis-cluster-0 -- redis-cli cluster info</pre></td></tr></table></figure><details class=\"info\"><summary>åŸ·è¡Œçµæœ</summary><div>\n<p>$ kubectl exec -it redis-cluster-0 -- redis-cli cluster info<br />\ncluster_state:ok<br />\ncluster_slots_assigned:16384<br />\ncluster_slots_ok:16384<br />\ncluster_slots_pfail:0<br />\ncluster_slots_fail:0<br />\ncluster_known_nodes:6<br />\ncluster_size:3<br />\ncluster_current_epoch:6<br />\ncluster_my_epoch:1<br />\ncluster_stats_messages_ping_sent:273<br />\ncluster_stats_messages_pong_sent:278<br />\ncluster_stats_messages_sent:551<br />\ncluster_stats_messages_ping_received:273<br />\ncluster_stats_messages_pong_received:273<br />\ncluster_stats_messages_meet_received:5<br />\ncluster_stats_messages_received:551<br />\ntotal_cluster_links_buffer_limit_exceeded:0</p>\n</div></details>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token for-or-select variable\">x</span> <span class=\"token keyword\">in</span> <span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">seq</span> <span class=\"token number\">0</span> <span class=\"token number\">5</span><span class=\"token variable\">)</span></span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">do</span> <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"redis-cluster-<span class=\"token variable\">$x</span>\"</span><span class=\"token punctuation\">;</span> kubectl <span class=\"token builtin class-name\">exec</span> redis-cluster-<span class=\"token variable\">$x</span> -- redis-cli role<span class=\"token punctuation\">;</span> <span class=\"token builtin class-name\">echo</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">done</span></pre></td></tr></table></figure><details class=\"info\"><summary>åŸ·è¡Œçµæœ</summary><div>\n<p>$ for x in <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mi>e</mi><mi>q</mi><mn>05</mn><mo stretchy=\"false\">)</mo><mo separator=\"true\">;</mo><mi>d</mi><mi>o</mi><mi>e</mi><mi>c</mi><mi>h</mi><mi>o</mi><mi mathvariant=\"normal\">&quot;</mi><mi>r</mi><mi>e</mi><mi>d</mi><mi>i</mi><mi>s</mi><mo>âˆ’</mo><mi>c</mi><mi>l</mi><mi>u</mi><mi>s</mi><mi>t</mi><mi>e</mi><mi>r</mi><mo>âˆ’</mo></mrow><annotation encoding=\"application/x-tex\">(seq 0 5); do echo &quot;redis-cluster-</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">se</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mord\">05</span><span class=\"mclose\">)</span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">oec</span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\">o</span><span class=\"mord\">&quot;</span><span class=\"mord mathnormal\">re</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">er</span><span class=\"mord\">âˆ’</span></span></span></span>x&quot;; kubectl exec redis-cluster-$x -- redis-cli role; echo; done<br />\nredis-cluster-0<br />\nmaster<br />\n504<br />\n10.76.2.32<br />\n6379<br />\n504</p>\n<p>redis-cluster-1<br />\nmaster<br />\n504<br />\n10.76.1.34<br />\n6379<br />\n504</p>\n<p>redis-cluster-2<br />\nmaster<br />\n490<br />\n10.76.1.33<br />\n6379<br />\n490</p>\n<p>redis-cluster-3<br />\nslave<br />\n10.76.2.31<br />\n6379<br />\nconnected<br />\n490</p>\n<p>redis-cluster-4<br />\nslave<br />\n10.76.2.30<br />\n6379<br />\nconnected<br />\n504</p>\n<p>redis-cluster-5<br />\nslave<br />\n10.76.1.32<br />\n6379<br />\nconnected<br />\n504</p>\n</div></details>\n<h1 id=\"yaml-æª”æ¡ˆ\"><a class=\"anchor\" href=\"#yaml-æª”æ¡ˆ\">#</a> YAML æª”æ¡ˆ</h1>\n<p><a href=\"https://github.com/8loser/redis-sts\">GitHub: 8loser/redis-sts</a></p>\n<h1 id=\"åƒè€ƒ\"><a class=\"anchor\" href=\"#åƒè€ƒ\">#</a> åƒè€ƒ</h1>\n<p><a href=\"https://www.suse.com/c/rancher_blog/deploying-redis-cluster-on-top-of-kubernetes/\">Deploying Redis Cluster on Top of Kubernetes February 22, 2019 | By: Rancher Admin</a></p>\n",
            "tags": [
                "Redis",
                "GKE",
                "Kubernetes"
            ]
        },
        {
            "id": "https://8loser.github.io/2023/01/04/gcp-init/",
            "url": "https://8loser.github.io/2023/01/04/gcp-init/",
            "title": "GCP VM åˆå§‹åŒ–",
            "date_published": "2023-01-04T07:32:51.000Z",
            "content_html": "<h1 id=\"ä¸»æ—¨\"><a class=\"anchor\" href=\"#ä¸»æ—¨\">#</a> ä¸»æ—¨</h1>\n<p>æŠŠå°ˆæ¡ˆé‹è¡Œçš„ GCP VM ç’°å¢ƒä½ˆç½²å‹•ä½œæ•´ç†ï¼Œå»ºç«‹ shell script é€²è¡Œå¿«é€Ÿä½ˆç½²ã€‚ä½¿ç”¨ä½œæ¥­ç³»çµ±ç‚º Linux Ubuntu</p>\n<h1 id=\"åŸ·è¡Œä¹‹å‰\"><a class=\"anchor\" href=\"#åŸ·è¡Œä¹‹å‰\">#</a> åŸ·è¡Œä¹‹å‰</h1>\n<p>å…ˆåŸ·è¡Œä¸‹é¢æŒ‡ä»¤ï¼Œåˆ‡æ›ç‚º root è§’è‰²</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">su</span> -</pre></td></tr></table></figure><h1 id=\"è¦æ–°å¢çš„-linux-å¸³è™Ÿ\"><a class=\"anchor\" href=\"#è¦æ–°å¢çš„-linux-å¸³è™Ÿ\">#</a> è¦æ–°å¢çš„ Linux å¸³è™Ÿ</h1>\n<p>æŠŠè¦æ–°å¢çš„å¸³è™Ÿã€å¯†ç¢¼ä½œç‚ºè®Šæ•¸å¯«åœ¨ script æœ€ä¸Šé¢ï¼Œç‚ºäº†çµ¦å…±åŒç¶­è­·çš„äººç™»å…¥ç”¨çš„ã€‚</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token assign-left variable\">ACCOUNT</span><span class=\"token operator\">=</span><span class=\"token operator\">&lt;</span>å¸³è™Ÿ<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token assign-left variable\">PASSWORD</span><span class=\"token operator\">=</span><span class=\"token operator\">&lt;</span>å¯†ç¢¼<span class=\"token operator\">></span></pre></td></tr></table></figure><h1 id=\"github-å¸³è™Ÿ\"><a class=\"anchor\" href=\"#github-å¸³è™Ÿ\">#</a> GitHub å¸³è™Ÿ</h1>\n<p>åŸ·è¡Œç’°å¢ƒæœƒæŠŠ docker image å¾ GitHub registry æŠ“ä¸‹ä¾†åŸ·è¡Œï¼Œæ‰€ä»¥åœ¨ script æœ€ä¸Šé¢æŠŠ GitHub æ¬Šé™è¨­å®šç‚ºè®Šæ•¸ï¼Œä¹‹å¾ŒåŸ·è¡Œè®€å–è®Šæ•¸å³å¯ã€‚å¯†ç¢¼ç‚º PATï¼ˆpersonal access tokenï¼‰ï¼Œå»ºç«‹æ–¹æ³•è«‹åƒè€ƒ <a href=\"https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token\">å»ºç«‹ PAT</a>ã€‚</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token assign-left variable\">GITHUB_ACCOUNT</span><span class=\"token operator\">=</span><span class=\"token operator\">&lt;</span>githubå¸³è™Ÿ<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token assign-left variable\">GITHUB_PAT</span><span class=\"token operator\">=</span><span class=\"token operator\">&lt;</span>github PAT<span class=\"token operator\">></span></pre></td></tr></table></figure><h1 id=\"è¨­å®šæ™‚å€\"><a class=\"anchor\" href=\"#è¨­å®šæ™‚å€\">#</a> è¨­å®šæ™‚å€</h1>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>timedatectl set-timezone Asia/Taipei</pre></td></tr></table></figure><h1 id=\"ä½œæ¥­ç³»çµ±æ›´æ–°\"><a class=\"anchor\" href=\"#ä½œæ¥­ç³»çµ±æ›´æ–°\">#</a> ä½œæ¥­ç³»çµ±æ›´æ–°</h1>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">apt</span> update <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">apt</span> upgrade <span class=\"token parameter variable\">-y</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">apt-get</span> clean <span class=\"token parameter variable\">-y</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">apt-get</span> autoremove <span class=\"token parameter variable\">-y</span></pre></td></tr></table></figure><h1 id=\"å•Ÿç”¨-google-bbr\"><a class=\"anchor\" href=\"#å•Ÿç”¨-google-bbr\">#</a> å•Ÿç”¨ Google BBR</h1>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>modprobe tcp_bbr</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"tcp_bbr\"</span> <span class=\"token operator\">>></span> /etc/modules-load.d/modules.conf</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"net.core.default_qdisc=fq\"</span> <span class=\"token operator\">>></span> /etc/sysctl.conf</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"net.ipv4.tcp_congestion_control=bbr\"</span> <span class=\"token operator\">>></span> /etc/sysctl.conf</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">sysctl</span> <span class=\"token parameter variable\">-p</span></pre></td></tr></table></figure><h1 id=\"install-ops-agent\"><a class=\"anchor\" href=\"#install-ops-agent\">#</a> Install Ops Agent</h1>\n<p>å®‰è£ <a href=\"https://cloud.google.com/stackdriver/docs/solutions/agents/ops-agent\">GCP agent</a>ï¼Œå¦‚æœä¸æ˜¯ä½¿ç”¨ GCP å¯ä»¥ä¸ç”¨åŸ·è¡Œ</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-sSO</span> https://dl.google.com/cloudagents/add-google-cloud-ops-agent-repo.sh</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">bash</span> add-google-cloud-ops-agent-repo.sh --also-install</pre></td></tr></table></figure><h1 id=\"å®‰è£-docker\"><a class=\"anchor\" href=\"#å®‰è£-docker\">#</a> å®‰è£ Docker</h1>\n<p>æ‰€æœ‰å°ˆæ¡ˆéƒ½ä»¥ container å½¢å¼ä½¿ç”¨ docker compose é‹è¡Œã€‚å®‰è£ docker æ²’æ¯›ç—…ã€‚</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">apt-get</span> update</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> ca-certificates <span class=\"token function\">curl</span> gnupg lsb-release <span class=\"token parameter variable\">-y</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">mkdir</span> <span class=\"token parameter variable\">-p</span> /etc/apt/keyrings</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-fsSL</span> https://download.docker.com/linux/ubuntu/gpg <span class=\"token operator\">|</span> <span class=\"token function\">sudo</span> gpg <span class=\"token parameter variable\">--dearmor</span> <span class=\"token parameter variable\">-o</span> /etc/apt/keyrings/docker.gpg</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token builtin class-name\">echo</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token string\">\"deb [arch=<span class=\"token variable\"><span class=\"token variable\">$(</span>dpkg --print-architecture<span class=\"token variable\">)</span></span> signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu \\</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token variable\"><span class=\"token variable\">$(</span>lsb_release <span class=\"token parameter variable\">-cs</span><span class=\"token variable\">)</span></span> stable\"</span> <span class=\"token operator\">|</span> <span class=\"token function\">sudo</span> <span class=\"token function\">tee</span> /etc/apt/sources.list.d/docker.list <span class=\"token operator\">></span> /dev/null</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">apt-get</span> update</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> docker-ce docker-ce-cli containerd.io docker-compose-plugin <span class=\"token parameter variable\">-y</span> <span class=\"token parameter variable\">-q</span></pre></td></tr></table></figure><h1 id=\"å®‰è£-portainer-with-docker-swarm\"><a class=\"anchor\" href=\"#å®‰è£-portainer-with-docker-swarm\">#</a> å®‰è£ Portainer with Docker Swarm</h1>\n<p>ä½¿ç”¨ portainer ç®¡ç† containerï¼Œportainer å¾ˆæ£’ï¼Œæ˜¯ web ç•Œé¢ã€‚åŠ ä¸Š docker swarm æ˜¯ç‚ºäº†è®“ç¨‹å¼ä¸Šå‚³å¾Œå¯ä»¥é€šçŸ¥ server å» pull æ–°çš„ image è‡ªå‹•ä½ˆç½²ã€‚ <code>ä¸€è¨€ä¸åˆå°± CI/CD</code></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> volume create portainer_data</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">docker</span> run <span class=\"token parameter variable\">-d</span> <span class=\"token parameter variable\">-p</span> <span class=\"token number\">8000</span>:8000 <span class=\"token parameter variable\">-p</span> <span class=\"token number\">9443</span>:9443 <span class=\"token parameter variable\">-p</span> <span class=\"token number\">9000</span>:9000 <span class=\"token parameter variable\">--name</span> portainer <span class=\"token parameter variable\">--restart</span><span class=\"token operator\">=</span>always <span class=\"token parameter variable\">-v</span> /var/run/docker.sock:/var/run/docker.sock <span class=\"token parameter variable\">-v</span> portainer_data:/data portainer/portainer-ce:latest</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">docker</span> swarm init</pre></td></tr></table></figure><h1 id=\"å»ºç«‹-crond-docker-prune\"><a class=\"anchor\" href=\"#å»ºç«‹-crond-docker-prune\">#</a> å»ºç«‹ crond docker-prune</h1>\n<p>æ¯å¤©è‡ªå‹•æ¸…ç† docker åƒåœ¾ï¼Œæ¯æ¬¡æ›´æ–°ç”¢ç”Ÿæ²’ç”¨çš„ imageã€cointainer å¤ªå¤šæœƒé€ æˆä¸»æ©Ÿå®¹é‡ä¸è¶³æ›æ‰ã€‚<br />\n<s>ä¸ç„¶æ¯æ¬¡æ›æ‰è€é—†éƒ½ç½µæˆ‘ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“ç‚ºä»€éº¼æœ‰äººä¸€å¤©è¦ commit 600 æ¬¡</s></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">cat</span> <span class=\"token operator\">>></span> /etc/cron.daily/docker-prune <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">EOL</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>#!/bin/bash</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>docker system prune -af</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>EOL</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">chmod</span> ugo+x /etc/cron.daily/docker-prune</pre></td></tr></table></figure><h1 id=\"å»ºç«‹-linux-å¸³è™Ÿ\"><a class=\"anchor\" href=\"#å»ºç«‹-linux-å¸³è™Ÿ\">#</a> å»ºç«‹ Linux å¸³è™Ÿ</h1>\n<p>ä½¿ç”¨æœ€ä¸Šé¢è¨­å®šçš„è®Šæ•¸å»ºç«‹å¸³è™Ÿï¼Œè®“å…¶ä»–ç¶­è­·çš„åŒå­¸ç™»å…¥ã€‚</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">useradd</span> <span class=\"token parameter variable\">-c</span> <span class=\"token string\">\"update user\"</span> <span class=\"token parameter variable\">-s</span> /bin/bash <span class=\"token parameter variable\">-G</span> <span class=\"token function\">sudo</span> <span class=\"token parameter variable\">-m</span> <span class=\"token variable\">$ACCOUNT</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"<span class=\"token variable\">$ACCOUNT</span>:<span class=\"token variable\">$PASSWORD</span>\"</span> <span class=\"token operator\">|</span> chpasswd</pre></td></tr></table></figure><h1 id=\"ç™»å…¥-docker-registry\"><a class=\"anchor\" href=\"#ç™»å…¥-docker-registry\">#</a> ç™»å…¥ Docker registry</h1>\n<p>ç™»å…¥ GitHub registry ä¹‹å¾Œ docker pull å°±ä¸ç”¨è¼¸å…¥å¯†ç¢¼ï¼Œè®šï¼</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">echo</span> <span class=\"token variable\">$GITHUB_PAT</span> <span class=\"token operator\">|</span> <span class=\"token function\">docker</span> login ghcr.io <span class=\"token parameter variable\">--username</span> <span class=\"token variable\">$GITHUB_ACCOUNT</span> --password-stdin</pre></td></tr></table></figure><h1 id=\"å®Œæ•´-shell-script\"><a class=\"anchor\" href=\"#å®Œæ•´-shell-script\">#</a> å®Œæ•´ shell script</h1>\n<ul>\n<li><a href=\"https://gist.github.com/8loser/f54b673b93a2df296887c2bd6edf96e8\">https://gist.github.com/8loser/f54b673b93a2df296887c2bd6edf96e8</a></li>\n</ul>\n",
            "tags": [
                "Linux",
                "Shell script",
                "GCP"
            ]
        },
        {
            "id": "https://8loser.github.io/2022/10/21/nginx-websocket/",
            "url": "https://8loser.github.io/2022/10/21/nginx-websocket/",
            "title": "Nginx websocket ç„¡æ³•é€£æ¥",
            "date_published": "2022-10-21T09:10:38.000Z",
            "content_html": "<h1 id=\"ç’°å¢ƒ\"><a class=\"anchor\" href=\"#ç’°å¢ƒ\">#</a> ç’°å¢ƒ</h1>\n<p>åœ¨ docker compose ä¸­ï¼Œä½¿ç”¨ nginx å°å‘ websocket åˆ° container å…§</p>\n<h1 id=\"éŒ¯èª¤è¨Šæ¯\"><a class=\"anchor\" href=\"#éŒ¯èª¤è¨Šæ¯\">#</a> éŒ¯èª¤è¨Šæ¯</h1>\n<p>websocket é€£æ¥ä¸ä¸Šï¼ŒæŸ¥çœ‹ request headers é¡¯ç¤º  <code>Provisional headers are shown</code></p>\n<p><img loading=\"lazy\" src=\"provisional_headers_are_shown.png\" alt=\"provisional headers are shown\" /></p>\n<h1 id=\"solution\"><a class=\"anchor\" href=\"#solution\">#</a> Solution</h1>\n<p>æœå°‹è§£æ±ºæ–¹æ³•æ˜¯åœ¨ nginx.conf å…§åŠ ä¸Š</p>\n<figure class=\"highlight editorconfig\"><figcaption data-lang=\"editorconfig\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>proxy_set_header Upgrade $http_upgrade<span class=\"token comment\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>proxy_set_header Connection \"upgrade\"<span class=\"token comment\">;</span></pre></td></tr></table></figure><h2 id=\"ç¯„ä¾‹\"><a class=\"anchor\" href=\"#ç¯„ä¾‹\">#</a> ç¯„ä¾‹</h2>\n<figure class=\"highlight editorconfig\"><figcaption data-lang=\"editorconfig\"><span>ç¯„ä¾‹</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>location /backend/ &#123;</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    proxy_pass http://backend/<span class=\"token comment\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    proxy_set_header Host $host<span class=\"token comment\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    proxy_set_header X-Real-IP $remote_addr<span class=\"token comment\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for<span class=\"token comment\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    proxy_set_header X-Custom-Referrer smc_identity_layer<span class=\"token comment\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token comment\"># websocket è¦åŠ ä¸‹é¢å…©å€‹</span></pre></td></tr><tr class=\"marked\"><td data-num=\"8\"></td><td><pre>    proxy_set_header Upgrade $http_upgrade<span class=\"token comment\">;</span></pre></td></tr><tr class=\"marked\"><td data-num=\"9\"></td><td><pre>    proxy_set_header Connection \"upgrade\"<span class=\"token comment\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>&#125;</pre></td></tr></table></figure><h1 id=\"é©—è­‰\"><a class=\"anchor\" href=\"#é©—è­‰\">#</a> é©—è­‰</h1>\n<p>æ¯”è¼ƒæœ‰ä¿®æ­£å‰è·Ÿä¿®æ­£å¾Œï¼Œå¾Œç«¯å¯¦éš›æ”¶åˆ°çš„ request header</p>\n<h2 id=\"ä¿®æ­£å‰-request-headers\"><a class=\"anchor\" href=\"#ä¿®æ­£å‰-request-headers\">#</a> ä¿®æ­£å‰ request headers</h2>\n<figure class=\"highlight js\"><figcaption data-lang=\"JavaScript\"><span>ä¿®æ­£å‰</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">Headers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token string-property property\">'host'</span><span class=\"token operator\">:</span> <span class=\"token string\">'localhost'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre> <span class=\"token string-property property\">'x-real-ip'</span><span class=\"token operator\">:</span> <span class=\"token string\">'192.168.224.1'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> <span class=\"token string-property property\">'x-forwarded-for'</span><span class=\"token operator\">:</span> <span class=\"token string\">'192.168.224.1'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre> <span class=\"token string-property property\">'x-custom-referrer'</span><span class=\"token operator\">:</span> <span class=\"token string\">'smc_identity_layer'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr class=\"marked\"><td data-num=\"5\"></td><td><pre> <span class=\"token string-property property\">'connection'</span><span class=\"token operator\">:</span> <span class=\"token string\">'close'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre> <span class=\"token string-property property\">'pragma'</span><span class=\"token operator\">:</span> <span class=\"token string\">'no-cache'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre> <span class=\"token string-property property\">'cache-control'</span><span class=\"token operator\">:</span> <span class=\"token string\">'no-cache'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre> <span class=\"token string-property property\">'user-agent'</span><span class=\"token operator\">:</span> <span class=\"token string\">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/106.0.0.0 Safari/537.36'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre> <span class=\"token string-property property\">'origin'</span><span class=\"token operator\">:</span> <span class=\"token string\">'chrome-extension://cbcbkhdmedgianpaifchdaddpnmgnknn'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre> <span class=\"token string-property property\">'sec-websocket-version'</span><span class=\"token operator\">:</span> <span class=\"token string\">'13'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre> <span class=\"token string-property property\">'accept-encoding'</span><span class=\"token operator\">:</span> <span class=\"token string\">'gzip, deflate, br'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre> <span class=\"token string-property property\">'accept-language'</span><span class=\"token operator\">:</span> <span class=\"token string\">'zh-TW,zh;q=0.9,en-US;q=0.8,en;q=0.7'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre> <span class=\"token string-property property\">'sec-websocket-key'</span><span class=\"token operator\">:</span> <span class=\"token string\">'iBVj1v1X8xkD324lsXZSUA=='</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre> <span class=\"token string-property property\">'sec-websocket-extensions'</span><span class=\"token operator\">:</span> <span class=\"token string\">'permessage-deflate; client_max_window_bits'</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"ä¿®æ­£å¾Œ-request-headers\"><a class=\"anchor\" href=\"#ä¿®æ­£å¾Œ-request-headers\">#</a> ä¿®æ­£å¾Œ request headers</h2>\n<figure class=\"highlight js\"><figcaption data-lang=\"JavaScript\"><span>ä¿®æ­£å¾Œ</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">Headers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token string-property property\">'host'</span><span class=\"token operator\">:</span> <span class=\"token string\">'localhost'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token string-property property\">'x-real-ip'</span><span class=\"token operator\">:</span> <span class=\"token string\">'192.168.208.1'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token string-property property\">'x-forwarded-for'</span><span class=\"token operator\">:</span> <span class=\"token string\">'192.168.208.1'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token string-property property\">'x-custom-referrer'</span><span class=\"token operator\">:</span> <span class=\"token string\">'smc_identity_layer'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr class=\"marked\"><td data-num=\"5\"></td><td><pre><span class=\"token string-property property\">'upgrade'</span><span class=\"token operator\">:</span> <span class=\"token string\">'websocket'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr class=\"marked\"><td data-num=\"6\"></td><td><pre><span class=\"token string-property property\">'connection'</span><span class=\"token operator\">:</span> <span class=\"token string\">'upgrade'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token string-property property\">'pragma'</span><span class=\"token operator\">:</span> <span class=\"token string\">'no-cache'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token string-property property\">'cache-control'</span><span class=\"token operator\">:</span> <span class=\"token string\">'no-cache'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token string-property property\">'user-agent'</span><span class=\"token operator\">:</span> <span class=\"token string\">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/106.0.0.0 Safari/537.36'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token string-property property\">'origin'</span><span class=\"token operator\">:</span> <span class=\"token string\">'chrome-extension://cbcbkhdmedgianpaifchdaddpnmgnknn'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token string-property property\">'sec-websocket-version'</span><span class=\"token operator\">:</span> <span class=\"token string\">'13'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token string-property property\">'accept-encoding'</span><span class=\"token operator\">:</span> <span class=\"token string\">'gzip, deflate, br'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token string-property property\">'accept-language'</span><span class=\"token operator\">:</span> <span class=\"token string\">'zh-TW,zh;q=0.9,en-US;q=0.8,en;q=0.7'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token string-property property\">'sec-websocket-key'</span><span class=\"token operator\">:</span> <span class=\"token string\">'j2NwT86WmJt6rIyatTa5rw=='</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token string-property property\">'sec-websocket-extensions'</span><span class=\"token operator\">:</span> <span class=\"token string\">'permessage-deflate; client_max_window_bits'</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure>",
            "tags": [
                "Trouble",
                "Nginx",
                "WebSocket"
            ]
        }
    ]
}